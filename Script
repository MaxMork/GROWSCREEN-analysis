#
library(tidyverse)
library(ggplot2)
library(reshape2)
library(dplyr)
library(tidyr)
library(devtools)
library(naniar)
library(stats)
library(datasets)
library(data.table)
library(qpcR)
library(grDevices-package)
library(FactoMineR)
library(factoextra)
fastmerge <- function(d1, d2) {
  d1.names <- names(d1)
  d2.names <- names(d2)
  
  # columns in d1 but not in d2
  d2.add <- setdiff(d1.names, d2.names)
  
  # columns in d2 but not in d1
  d1.add <- setdiff(d2.names, d1.names)
  
  # add blank columns to d2
  if(length(d2.add) > 0) {
    for(i in 1:length(d2.add)) {
      d2[d2.add[i]] <- NA
    }
  }
  
  # add blank columns to d1
  if(length(d1.add) > 0) {
    for(i in 1:length(d1.add)) {
      d1[d1.add[i]] <- NA
    }
  }
  
  return(rbind(d1, d2))
}
cbind.fill<-function(...){
  nm <- list(...) 
  nm<-lapply(nm, as.matrix)
  n <- max(sapply(nm, nrow)) 
  do.call(cbind, lapply(nm, function (x) 
    rbind(x, matrix(, n-nrow(x), ncol(x))))) 
}

#get the data 
setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data")
#Load data manually (sheet is to big to open in excel) #1 has dublicates making the spread function not work.
dat <- Growscreen_seed_seedling_COMPLETE_2019_EPPN_PLC_Drought_790_812_experimentData_20200320_2

#############################################################################################################
#data prep
###########################################################################################################
#Label datasets
dat$gene <- ifelse(grepl("OE",dat$Genotype),'OE','Tissue')
dat$gene <- ifelse(grepl("WT",dat$Genotype),'WT',dat$gene)
dat$gene <- ifelse(grepl("Col-0",dat$Genotype),'Col-0',dat$gene)
dat$gene <- ifelse(grepl("KO",dat$Genotype),'KO',dat$gene)
dat$GT <- ifelse(grepl("PLC2",dat$Genotype),'PLC2','Tissue')
dat$GT <- ifelse(grepl("PLC3",dat$Genotype),'PLC3',dat$GT)
dat$GT <- ifelse(grepl("PLC4",dat$Genotype),'PLC4',dat$GT)
dat$GT <- ifelse(grepl("PLC5",dat$Genotype),'PLC5',dat$GT)
dat$GT <- ifelse(grepl("PLC7",dat$Genotype),'PLC7',dat$GT)
dat$GT <- ifelse(grepl("PLC9",dat$Genotype),'PLC9',dat$GT)
dat$GT <- ifelse(grepl("PLC5/7",dat$Genotype),'PLC5/7 KO',dat$GT)
dat$GT <- ifelse(grepl("PLC5-1",dat$Genotype),'PLC5-1 KO',dat$GT)
dat$GT <- ifelse(grepl("WT",dat$Genotype),'WT',dat$GT)
dat$GT <- ifelse(grepl("Col-0",dat$Genotype),'Col-0',dat$GT)
dat$GT <- ifelse(grepl("A14",dat$Genotype),'A14',dat$GT)
dat$GT <- ifelse(grepl("Cab3",dat$Genotype),'Cab3',dat$GT)
dat$GT <- ifelse(grepl("CER6",dat$Genotype),'CER6',dat$GT)
dat$GT <- ifelse(grepl("DR5",dat$Genotype),'DR5',dat$GT)
dat$GT <- ifelse(grepl("E28",dat$Genotype),'E28',dat$GT)
dat$GT <- ifelse(grepl("E30",dat$Genotype),'E30',dat$GT)
dat$GT <- ifelse(grepl("E49",dat$Genotype),'E49',dat$GT)
dat$GT <- ifelse(grepl("LRC1",dat$Genotype),'LRC1',dat$GT)
dat$GT <- ifelse(grepl("LRC3",dat$Genotype),'LRC3',dat$GT)
dat$GT <- ifelse(grepl("ML1",dat$Genotype),'ML1-1',dat$GT)
dat$GT <- ifelse(grepl("Q4",dat$Genotype),'Q4',dat$GT)
dat$GT <- ifelse(grepl("S1",dat$Genotype),'S1',dat$GT)
dat$GT <- ifelse(grepl("S2",dat$Genotype),'S2',dat$GT)
dat$gene2 <- ifelse(grepl("Tissue",dat$gene),'Tissue1',dat$gene)
dat$gene2 <- ifelse(grepl("E28",dat$Genotype),'Tissue2',dat$gene2)
dat$gene2 <- ifelse(grepl("ML1",dat$Genotype),'Tissue2',dat$gene2)
dat$gene2 <- ifelse(grepl("LRC1",dat$Genotype),'Tissue2',dat$gene2)
dat$gene2 <- ifelse(grepl("DR5",dat$Genotype),'Tissue2',dat$gene2)
dat$gene2 <- ifelse(grepl("E49",dat$Genotype),'Tissue2',dat$gene2)
dat$gene2 <- ifelse(grepl("LRC3",dat$Genotype),'Tissue2',dat$gene2)
dat$gene2 <- ifelse(grepl("S2",dat$Genotype),'Tissue2' ,dat$gene2)
#dat$gene2 <- ifelse(grepl("PLC5",dat$Genotype),'Tissue2' ,dat$gene2)
dat$stress <- ifelse(grepl("control", dat$Treatments), "control", "drought")
dat$GTDASSTRESS <- paste(dat$GT,dat$MeasurementDate_das, dat$stress)
dat$GTDAS <- paste(dat$GT,dat$MeasurementDate_das)
#dat$gene2 <- NULL
#create subselections of datasets
seeds <- dat %>% filter(Type == "seed")
Plant <- dat %>% filter(Type == "plant")
disconnectedplantpart <- dat %>% filter(Type == "disconnectedplantpart")

#PlantSize3$gene2 <- ifelse(grepl("Tissue",PlantSize3$gene),'Tissue1',PlantSize3$gene)
#PlantSize3$gene2 <- ifelse(grepl("E28",PlantSize3$Genotype),'Tissue2',PlantSize3$gene2)
#PlantSize3$gene2 <- ifelse(grepl("ML1",PlantSize3$Genotype),'Tissue2',PlantSize3$gene2)
#PlantSize3$gene2 <- ifelse(grepl("LRC1",PlantSize3$Genotype),'Tissue2',PlantSize3$gene2)
#PlantSize3$gene2 <- ifelse(grepl("DR5",PlantSize3$Genotype),'Tissue2',PlantSize3$gene2)
#PlantSize3$gene2 <- ifelse(grepl("E49",PlantSize3$Genotype),'Tissue2',PlantSize3$gene2)
#PlantSize3$gene2 <- ifelse(grepl("LRC3",PlantSize3$Genotype),'Tissue2',PlantSize3$gene2)
#PlantSize3$gene2 <- ifelse(grepl("S2",PlantSize3$Genotype),'Tissue2' ,PlantSize3$gene2)


###########################################################################################################
#take out non-usefull data.
###################################################################################################

#Plant remove unimportant data
Plant2 <- Plant
Plant2 <- tibble::rowid_to_column(Plant2, "ID.Measur")
Plant2 <- Plant2 %>% filter(Plant2$ID.Measur != "1781126")
Plant2 <- Plant2 %>% filter(Plant2$ID.Measur != "1781128")
Plant2 <- Plant2 %>% filter(Plant2$ID.Measur != "1306847")
Plant2 <- Plant2 %>% filter(Plant2$ID.Measur != "1331531")

Plant2$ID.Measur <- NULL
Plant2$RootIDs <- NULL
Plant2$Scientific.Name <- NULL
Plant2$ParentID <- NULL
Plant2$Transgenic <- NULL
Plant2$Disposal.Date <- NULL
Plant2$Diposal.Comment <- NULL
Plant2$Responsible.Party <- NULL
Plant2$Description <- NULL
Plant2$TrayID <- NULL
Plant2$Soil <- NULL
Plant2$Label.Info <- NULL
Plant2$Discarded <- NULL
Plant2$IDK <- NULL

#remove plants that are not well photographed
Plant2 <- Plant2 %>% filter(!Plant2$Trait == "imageEdgePercentage" | !Plant2$Value > 7)
Plant2 <- Plant2 %>% filter(!Plant2$Trait == "plantMinimumSizeThreshold" | !Plant2$Value != 1)


#remove traits that Nathalie said were not reliable.
#deze moeten alleen weg in growscreen 5D en 6D. Niet de fluor grorwscreen
Plant2_growscreen <- Plant2 %>% filter(Plant2$Device == "Growscreen 2D 5" | Plant2$Device == "Growscreen 2D 6")
Plant2_not_growscreen <- Plant2 %>% filter(Plant2$Device != "Growscreen 2D 5" , Plant2$Device != "Growscreen 2D 6")
Plant2_growscreen <- Plant2_growscreen %>% filter(
  Trait != "Average_Blue_Channel"
  ,Trait != "Average_Green_Channel"
  ,Trait != "Average_Red_Channel"
  ,Trait != "areaByCircumference"
  ,Trait != "averageLeafDiameter"
  ,Trait != "bMean"
  ,Trait != "bStdDev"
  ,Trait != "darkyield_stddev"
  ,Trait != "excentricity"
  ,Trait != "gMean"
  ,Trait != "gStdDev"
  ,Trait != "insideDiameter"
  ,Trait != "length"
  ,Trait != "lengthmm"
  ,Trait != "maxLeafDiameter"
  ,Trait != "midyieldFluorescenceMeasurement"
  ,Trait != "minLeafDiameter"
  ,Trait != "outsideDiameter"
  ,Trait != "plantsize"
  ,Trait != "rMean"
  ,Trait != "rStdDev"
  ,Trait != "size"
  ,Trait != "sizemm"
  ,Trait != "surfacecoverage"
  ,Trait != "width"
  ,Trait != "widthmm"
  ,Trait != "xpos"
  ,Trait != "ypos"
  ,Trait != "average_circle_size"
  ,Trait != "area_by_circumference"
  ,Trait != "plantsize_mm2"
  ,Trait != "surface_coverage"
  ,Trait != "rotational_symmetry"
  ,Trait != "number_of_leafs"
  ,Trait != "rotationalSymmetry"
)
Plant2 <- rbind(Plant2_growscreen,Plant2_not_growscreen)
Plant2 <- Plant2 %>% filter(Value != "Inf")
Plant2 <- Plant2 %>% filter(Value != "-Inf")



###################################################################################################
#normalization to device.
####################################################################################################
Plant2_Device_normalized <- Plant2 %>% filter(Plant2$Device == "flamingo")
uniqueTrait <- unique(Plant2$Trait)

##
for (x in uniqueTrait){
  Plant2_trait <- Plant2 %>% filter(Plant2$Trait == x)
  ratio_fluoro <- c()
  ratio_growscreen <- c()
  uniqueDay <- sort(unique(Plant2$MeasurementDate_das))
  for (y in uniqueDay){
    Plant2_trait_day <- Plant2_trait %>% filter(Plant2_trait$MeasurementDate_das == y)
    Plant2_trait_day_control <- Plant2_trait_day %>% filter(Plant2_trait_day$stress == "control")
    Plant2_trait_day_drought <- Plant2_trait_day %>% filter(Plant2_trait_day$stress == "drought")
    
    Plant2_trait_day_control3 <- Plant2_trait_day_control %>% filter(Plant2_trait_day_control$Device == "Growscreen Fluoro 3")
    Plant2_trait_day_control4 <- Plant2_trait_day_control %>% filter(Plant2_trait_day_control$Device == "Growscreen Fluoro 4")
    Plant2_trait_day_control5 <- Plant2_trait_day_control %>% filter(Plant2_trait_day_control$Device == "Growscreen 2D 5")
    Plant2_trait_day_control6 <- Plant2_trait_day_control %>% filter(Plant2_trait_day_control$Device == "Growscreen 2D 6")
    Plant2_trait_day_drought3 <- Plant2_trait_day_drought %>% filter(Plant2_trait_day_drought$Device == "Growscreen Fluoro 3")
    Plant2_trait_day_drought4 <- Plant2_trait_day_drought %>% filter(Plant2_trait_day_drought$Device == "Growscreen Fluoro 4")
    Plant2_trait_day_drought5 <- Plant2_trait_day_drought %>% filter(Plant2_trait_day_drought$Device == "Growscreen 2D 5")
    Plant2_trait_day_drought6 <- Plant2_trait_day_drought %>% filter(Plant2_trait_day_drought$Device == "Growscreen 2D 6")
    
    Plant2_trait_day_control3_mean <- mean(Plant2_trait_day_control3$Value)
    Plant2_trait_day_control4_mean <- mean(Plant2_trait_day_control4$Value)
    Plant2_trait_day_control5_mean <- mean(Plant2_trait_day_control5$Value)
    Plant2_trait_day_control6_mean <- mean(Plant2_trait_day_control6$Value)
    Plant2_trait_day_drought3_mean <- mean(Plant2_trait_day_drought3$Value)
    Plant2_trait_day_drought4_mean <- mean(Plant2_trait_day_drought4$Value)
    Plant2_trait_day_drought5_mean <- mean(Plant2_trait_day_drought5$Value)
    Plant2_trait_day_drought6_mean <- mean(Plant2_trait_day_drought6$Value)
    
    ratio_day_control_fluoro <-     Plant2_trait_day_control3_mean/Plant2_trait_day_control4_mean
    ratio_day_drought_fluoro <-     Plant2_trait_day_drought3_mean/Plant2_trait_day_drought4_mean
    ratio_day_control_growscreen <- Plant2_trait_day_control5_mean/Plant2_trait_day_control6_mean
    ratio_day_drought_growscreen <- Plant2_trait_day_drought5_mean/Plant2_trait_day_drought6_mean
    
    ratio_day_fluoro <- 0.5*(ratio_day_control_fluoro+ratio_day_drought_fluoro)
    ratio_day_growscreen <- 0.5*(ratio_day_control_growscreen+ratio_day_drought_growscreen)
    
    ratio_fluoro <- append(ratio_fluoro, ratio_day_fluoro)
    ratio_growscreen <- append(ratio_growscreen, ratio_day_growscreen)
  }
  ratio_fluoro_mean <- mean(ratio_fluoro, na.rm = TRUE)
  ratio_growscreen_mean <- mean(ratio_growscreen, na.rm = TRUE)
  
  Plant2_trait_fluoro3 <- Plant2_trait %>% filter(Plant2_trait$Device == "Growscreen Fluoro 3")
  Plant2_trait_fluoro4 <- Plant2_trait %>% filter(Plant2_trait$Device == "Growscreen Fluoro 4")
  Plant2_trait_growscreen5 <- Plant2_trait %>% filter(Plant2_trait$Device == "Growscreen 2D 5")
  Plant2_trait_growscreen6 <- Plant2_trait %>% filter(Plant2_trait$Device == "Growscreen 2D 6")  
  Plant2_trait_fluoro4$Value     <- Plant2_trait_fluoro4$Value * ratio_fluoro_mean
  Plant2_trait_growscreen6$Value <- Plant2_trait_growscreen6$Value * ratio_growscreen_mean
  Plant2_trait_Device_normalized <- rbind(Plant2_trait_fluoro3,Plant2_trait_fluoro4,Plant2_trait_growscreen5,Plant2_trait_growscreen6)  
  
  Plant2_Device_normalized <- rbind(Plant2_Device_normalized, Plant2_trait_Device_normalized)
}
Plant2 <- Plant2_Device_normalized

Plant2 <- Plant2 %>% filter(Value != "Inf")
Plant2 <- Plant2 %>% filter(Value != "-Inf")
Plant2 <- Plant2 %>% filter(Value != "NaN")
Plant2 <- Plant2 %>% filter(Value != 0)


##############################################################################################################
#take out outliers: only 1 or 2 measurements or plants with low mean, sum or latest values.
#######

#taking either the mean of the sum of all plantsizes of a plant over time. Plant ID's are identified that are to small to meaningfully contribute.
#Only work the data that has actual non zero values.
Plant3 <- Plant2 %>% spread(Trait, Value)
PlantSize2 <- Plant3 %>% filter(Plant3$projPlantSurfaceArea_mm2 > 0.00000001)
uniqueID <- unique(PlantSize2$ID)

######meansize to determine if plant is big enough
rm(meansize)
meansize<-data.frame(ID=character(0),projPlantSurfaceArea_mm2=numeric(0))
for (val in uniqueID) {
  ID <- c(val)
  meantemp <- PlantSize2 %>% filter(PlantSize2$ID == val)
  means <- mean(meantemp$projPlantSurfaceArea_mm2)
  
  meandf <- data.frame(ID)
  meandf$Genotype <- unique(meantemp$Genotype)
  meandf$stress <- unique(meantemp$stress)
  meandf$gene <- unique(meantemp$gene)
  meandf$GT <- unique(meantemp$GT)
  meandf$size <- means
  
  meansize <- rbind(meansize,meandf)
}
meanremove <- meansize %>% filter(meansize$size < 30)


######sumsize to see if a plant is big enough
#need to remove all plants that are not growing 
rm(sumsize)
sumsize<-data.frame(ID=character(0),projPlantSurfaceArea_mm2=numeric(0))
for (val in uniqueID) {
  ID <- c(val)
  sumtemp <- PlantSize2 %>% filter(PlantSize2$ID == val)
  sums <- sum(sumtemp$projPlantSurfaceArea_mm2)
  
  sumdf <- data.frame(ID)
  sumdf$Genotype <- unique(sumtemp$Genotype)
  sumdf$stress <- unique(sumtemp$stress)
  sumdf$gene <- unique(sumtemp$gene)
  sumdf$GT <- unique(sumtemp$GT)
  sumdf$size <- sums
  
  sumsize <- rbind(sumsize,sumdf)
}
sumremove <- sumsize %>% filter(sumsize$size < 300)


#### Identify all samples which only have 1 or 2 timepoints for an ID
rm(countsize)
countsize<-data.frame(ID=character(0),count=numeric(0))
for (val in uniqueID) {
  ID <- c(val)
  counttemp <- PlantSize2 %>% filter(PlantSize2$ID == val)
  counts <- nrow(counttemp)
  
  countsdf <- data.frame(ID)
  countsdf$Genotype <- unique(sumtemp$Genotype)
  countsdf$stress <- unique(sumtemp$stress)
  countsdf$gene <- unique(sumtemp$gene)
  countsdf$GT <- unique(sumtemp$GT)
  countsdf$count <- counts
  
  countsize <- rbind(countsize,countsdf)
}
countremove <- countsize %>% filter(countsize$count < 3)

####
#plants for which the last one is at least 200

rm(latestsize)
latestsize<-data.frame(ID=character(0),projPlantSurfaceArea_mm2=numeric(0))

uniquecontorlID <- unique(PlantSize2$ID)
for (val in uniquecontorlID) {
  ID <- c(val)
  latestsizetemp <- PlantSize2 %>% filter(PlantSize2$ID == val)
  latestday <- max(latestsizetemp$MeasurementDate_das)
  latestsizetemp <- latestsizetemp %>% filter(latestsizetemp$MeasurementDate_das == latestday)
  latestsizemax <- unique(latestsizetemp$projPlantSurfaceArea_mm2)
  
  latestsizedf <- data.frame(ID)
  latestsizedf$Genotype <- unique(latestsizetemp$Genotype)
  latestsizedf$stress <- unique(latestsizetemp$stress)
  latestsizedf$gene <- unique(latestsizetemp$gene)
  latestsizedf$GT <- unique(latestsizetemp$GT)
  latestsizedf$size <- latestsizemax
  
  latestsize <- rbind(latestsize,latestsizedf)
}
latestsizeC <- latestsize %>% filter(latestsize$stress == "control")
latestsizeremoveC <- latestsizeC %>% filter(latestsizeC$size < 250)
latestsizeD <- latestsize %>% filter(latestsize$stress == "drought")
latestsizeremoveD <- latestsizeD %>% filter(latestsizeD$size < 50)
latestsizeremove <- rbind(latestsizeremoveC, latestsizeremoveD)

############ now that we have 3 different remove files we want to add the list of things to remove to each other. Look for the unique ones and remove those from the dataset to analyse
removers <- countremove$ID
removers <- append(removers, sumremove$ID)
removers <- append(removers, meanremove$ID)
removers <- append(removers, latestsizeremove$ID)


UniqueRemove <- unique(removers)

############################################################################################################
#Take out more non usefull data and 
###########################################################################################################
##spread data
Plant2 <- Plant2 %>% group_by(ID) %>% nest()
for (val in UniqueRemove) {Plant2 <- Plant2 %>% filter(ID != val)}
Plant2 <- Plant2 %>% unnest(data)
Plant2 <- as.data.frame(Plant2)

Plant2$Unit <- NULL
Plant2 <- Plant2 %>% filter(Plant2$ExperimentID == "812")
Plant3 <- Plant2 %>% spread(Trait, Value)

Plant3.subset <- subset(Plant3, !is.na(plantAverageRed))
Plant3.subset2 <- subset(Plant3, is.na(plantAverageRed))
data.hsv <- with(Plant3.subset, rgb2hsv(plantAverageRed, plantAverageGreen, plantAverageBlue, maxColorValue = 255))
data.hsv.t <- as.data.frame(t(as.matrix(data.hsv)))
Plant3.hsv <- cbind(Plant3.subset, data.hsv.t)
Plant3 <- fastmerge (Plant3.hsv, Plant3.subset2) 
Plant3 <- Plant3 %>%  rename(hue = h,    saturation = s,    colorvalue = v  )
colnames <- c(colnames(Plant3))
idvar <- c(colnames[1:25])
measurevar = c(colnames[26:63])
Planttest <- melt(data = Plant3, id.vars = c(colnames[1:24]), measure.vars = c(colnames[25:63]))
Planttest <- Planttest %>%  rename(Trait = variable,    Value = value)
Plant2 <- Planttest
Plant2 <- Plant2 %>% filter(Plant2$ExperimentID == "812")

Plant3$MeasurementDate <- as.POSIXct(as.numeric(Plant3$MeasurementDate), origin = "1970-01-01", tz = "CET")
Plant3$time <- format(Plant3$MeasurementDate, '%H:%M:%S')

Plant3 <- tibble::rowid_to_column(Plant3, "ID.Measurement")
#vanaf hier outliers weg halen en dan data analyse
Plant4 <- Plant3 %>% filter(Plant3$Device == "Growscreen Fluoro 3"| Plant3$Device == "Growscreen Fluoro 4")
#Plant6 <- Plant2 %>% filter(Plant2$Device == "Growscreen 2D 5"| Plant2$Device == "Growscreen 2D 6")
#Plant5 <- Plant5 %>% spread(Trait, Value)
#Plant5$Device <- NULL
#Plant6 <- Plant6 %>% spread(Trait, Value)
#Plant6$Device <- NULL
#Plant7 <- merge(Plant6, Plant5,by = intersect("ID","GTDASSTRESS"), all.x = all)

Plant3$Average_Blue_Channel<- NULL
Plant3$Average_Green_Channel   <- NULL
Plant3$Average_Red_Channel   <- NULL
Plant3$areaByCircumference   <- NULL
Plant3$averageLeafDiameter  <- NULL
Plant3$bMean   <- NULL
Plant3$bStdDev   <- NULL
Plant3$compactness   <- NULL
Plant3$darkyield_stddev   <- NULL
Plant3$excentricity   <- NULL
Plant3$gMean   <- NULL
Plant3$gStdDev   <- NULL
Plant3$insideDiameter   <- NULL
Plant3$length   <- NULL
Plant3$lengthmm   <- NULL
Plant3$maxLeafDiameter   <- NULL
Plant3$midyieldFluorescenceMeasurement   <- NULL
Plant3$minLeafDiameter   <- NULL
Plant3$numberOfLeafs   <- NULL
Plant3$outsideDiameter   <- NULL
Plant3$plantsize   <- NULL
Plant3$rMean   <- NULL
Plant3$rStdDev   <- NULL
Plant3$rotationalSymmetry   <- NULL
Plant3$size    <- NULL
Plant3$sizemm    <- NULL
Plant3$stockiness    <- NULL
Plant3$surfacecoverage    <- NULL
Plant3$width    <- NULL  
Plant3$widthmm    <- NULL 
Plant3$xpos    <- NULL  
Plant3$ypos    <- NULL  
Plant3$average_circle_size    <- NULL  
Plant3$area_by_circumference    <- NULL  
Plant3$number_of_leafs    <- NULL  
Plant3$rotational_symmetry    <- NULL  
Plant3$surface_coverage    <- NULL  
Plant3$plantsize_mm2    <- NULL 

#for (val in UniqueRemove) {
#  PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ID != val)
#}

#for (val in UniqueRemove) {
#  Plant4 <- Plant4 %>% filter(Plant4$ID != val)
#}

Plant6 <- Plant2
Plant8 <- Plant2

Plant4$MeasurementDate <- as.POSIXct(as.numeric(Plant4$MeasurementDate), origin = "1970-01-01", tz = "CET")
Plant4$time <- format(Plant4$MeasurementDate, '%H:%M:%S')





PlantSize3 <- Plant3 %>% filter(Plant3$plantSurfaceCoverage > 0)
PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ExperimentID == 812)
PlantSize3 <- PlantSize3 %>% filter(PlantSize3$plantSurfaceCoverage < 50)
PlantSize3 <- Filter(function(x)!all(is.na(x)), PlantSize3)



PlantSize3_OE <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "OE")
PlantSize3_Tissue <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "Tissue")
PlantSize3_KO <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "KO")

#Plant4 <- Plant4 %>% filter(Plant4$Device == "Growscreen Fluoro 3")
Plant4 <- Plant4 %>% filter(Plant4$ExperimentID == 812)
Plant4 <- Filter(function(x)!all(is.na(x)), Plant4)
Plant4_OE <- Plant4 %>% filter(Plant4$gene == "WT" | Plant4$gene == "OE")
Plant4_Tissue <- Plant4 %>% filter(Plant4$gene == "WT" | Plant4$gene == "Tissue")
Plant4_KO <- Plant4 %>% filter(Plant4$gene == "WT" | Plant4$gene == "KO")





###########################################
Plant2.raw <- Plant2
Plant3.raw <- Plant3
PlantSize3.raw <- PlantSize3
Plant4.raw <- Plant4
Plant8.raw <- Plant8


ColorTissue <- c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#ffff99','#b15928','#e6ab02','#000000')
ColorOE <- c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000')
ColorKO <- c('#1b9e77','#e6ab02','#000000','#000000')

ColorTissue2 <- c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99',
                  '#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                  '#e7298a','#e7298a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000')
ColorOE2 <- c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a',
              '#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000')

ColorTissue3 <- c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#000000')
ColorTissue4 <- c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                  '#e7298a','#e7298a','#000000','#000000')

ColorTissue5 <- c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000')
ColorTissue6 <- c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                  '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000')

###########################################################################################################
#optional normalization
###########################################################################################################

#I need to filter out all the stuff before I normalize it, or otherwise I have to rethink the normalization.


#normalize to WT
#do seperate for control and drought loop over traits. 
Plant_fill <- Plant6 %>% dplyr::filter(Plant6$Device == "6")
Plant_fill$Value <- as.numeric(Plant_fill$Value)
uniquetraits <- unique(Plant6$Trait)
for (val in uniquetraits){
  Plant_trait <- Plant6 %>% filter(Trait == val)
  uniquedays <- unique(Plant_trait$MeasurementDate_das)
  Plant_trait_fill <- Plant_trait %>% filter(Device == "6")
  for (days in uniquedays){
    Plant_trait_day <- Plant_trait %>% filter(MeasurementDate_das == days)
    Plant_trait_day_control <- Plant_trait_day %>% filter(stress == "control")
    WT_mean_trait_day_control <- Plant_trait_day_control %>% filter(GT == "WT", Value != "NA")
    WT_mean_trait_day_control <- mean(WT_mean_trait_day_control$Value)
    Plant_trait_day_control$Value <- Plant_trait_day_control$Value/WT_mean_trait_day_control
    Plant_trait_day_drought <- Plant_trait_day %>% filter(stress == "drought")
    WT_mean_trait_day_drought <- Plant_trait_day_drought %>% filter(GT == "WT", Value != "NA")
    WT_mean_trait_day_drought <- mean(WT_mean_trait_day_drought$Value)
    Plant_trait_day_drought$Value <- Plant_trait_day_drought$Value/WT_mean_trait_day_drought
    Plant_trait_day_control <- rbind(Plant_trait_day_control, Plant_trait_day_drought)
    Plant_trait_fill <- rbind(Plant_trait_fill,Plant_trait_day_control)
  }
  Plant_fill <- rbind(Plant_fill,Plant_trait_fill)
}

Plant_fill2 <- Plant_fill
Plant_fill2 <- Plant_fill2 %>% filter(Plant_fill2$Value != "Inf", Plant_fill2$Value != "-Inf", Plant_fill2$Value != "NA")
#Plant2 <- Plant_fill2
#now go back and finish the dataprep
#PlantSize3 <- Plant3 %>% filter(projPlantSurfaceArea_mm2 > 0.00000001)

Plant6sub <- Plant6 %>% filter(MeasurementDate_das == 25, Plant6$GT == "WT", Plant6$Trait == "projPlantSurfaceArea_mm2")
write.csv(write.csv(Plant6sub,'Plant6sub.csv'))

#normalize to Control.
Plant_fill3 <- Plant6 %>% filter(Plant6$Device == "6")
Plant_fill3$Value <- as.numeric(Plant_fill3$Value)
uniquetraits <- unique(Plant6$Trait)
for (val in uniquetraits){
  Plant_trait <- Plant6 %>% filter(Plant6$Trait == val)
  uniquedays <- unique(Plant_trait$MeasurementDate_das)
  Plant_trait_fill <- Plant_trait %>% filter(Plant_trait$Device == "6")
  for (days in uniquedays){
    Plant_trait_day <- Plant_trait %>% filter(Plant_trait$MeasurementDate_das == days)
    Plant_trait_day <- Plant_trait_day %>% filter(Plant_trait_day$Value > 0.000000000001) 
    
    Plant_trait_day_WT <- Plant_trait_day %>% filter(Plant_trait_day$GT == "WT")
    Control_mean_trait_day_WT <- Plant_trait_day_WT %>% filter(Plant_trait_day_WT$stress == "control", Plant_trait_day_WT$Value != "NA")
    Control_mean_trait_day_WT <- mean(Control_mean_trait_day_WT$Value)
    Plant_trait_day_WT$Value <- Plant_trait_day_WT$Value/Control_mean_trait_day_WT
    
    
    Plant_trait_day_PLC2 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "PLC2")
    Control_mean_trait_day_PLC2 <- Plant_trait_day_PLC2 %>% filter(Plant_trait_day_PLC2$stress == "control", Plant_trait_day_PLC2$Value != "NA")
    Control_mean_trait_day_PLC2 <- mean(Control_mean_trait_day_PLC2$Value)
    Plant_trait_day_PLC2$Value <- Plant_trait_day_PLC2$Value/Control_mean_trait_day_PLC2
    
    Plant_trait_day_PLC3 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "PLC3")
    Control_mean_trait_day_PLC3 <- Plant_trait_day_PLC3 %>% filter(Plant_trait_day_PLC3$stress == "control", Plant_trait_day_PLC3$Value != "NA")
    Control_mean_trait_day_PLC3 <- mean(Control_mean_trait_day_PLC3$Value)
    Plant_trait_day_PLC3$Value <- Plant_trait_day_PLC3$Value/Control_mean_trait_day_PLC3
    
    Plant_trait_day_PLC4 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "PLC4")
    Control_mean_trait_day_PLC4 <- Plant_trait_day_PLC4 %>% filter(Plant_trait_day_PLC4$stress == "control", Plant_trait_day_PLC4$Value != "NA")
    Control_mean_trait_day_PLC4 <- mean(Control_mean_trait_day_PLC4$Value)
    Plant_trait_day_PLC4$Value <- Plant_trait_day_PLC4$Value/Control_mean_trait_day_PLC4
    
    Plant_trait_day_PLC5 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "PLC5")
    Control_mean_trait_day_PLC5 <- Plant_trait_day_PLC5 %>% filter(Plant_trait_day_PLC5$stress == "control", Plant_trait_day_PLC5$Value != "NA")
    Control_mean_trait_day_PLC5 <- mean(Control_mean_trait_day_PLC5$Value)
    Plant_trait_day_PLC5$Value <- Plant_trait_day_PLC5$Value/Control_mean_trait_day_PLC5
    
    Plant_trait_day_PLC7 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "PLC7")
    Control_mean_trait_day_PLC7 <- Plant_trait_day_PLC7 %>% filter(Plant_trait_day_PLC7$stress == "control", Plant_trait_day_PLC7$Value != "NA")
    Control_mean_trait_day_PLC7 <- mean(Control_mean_trait_day_PLC7$Value)
    Plant_trait_day_PLC7$Value <- Plant_trait_day_PLC7$Value/Control_mean_trait_day_PLC7
    
    Plant_trait_day_PLC9 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "PLC9")
    Control_mean_trait_day_PLC9 <- Plant_trait_day_PLC9 %>% filter(Plant_trait_day_PLC9$stress == "control", Plant_trait_day_PLC9$Value != "NA")
    Control_mean_trait_day_PLC9 <- mean(Control_mean_trait_day_PLC9$Value)
    Plant_trait_day_PLC9$Value <- Plant_trait_day_PLC9$Value/Control_mean_trait_day_PLC9
    
    Plant_trait_day_S2 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "S2")
    Control_mean_trait_day_S2 <- Plant_trait_day_S2 %>% filter(Plant_trait_day_S2$stress == "control", Plant_trait_day_S2$Value != "NA")
    Control_mean_trait_day_S2 <- mean(Control_mean_trait_day_S2$Value)
    Plant_trait_day_S2$Value <- Plant_trait_day_S2$Value/Control_mean_trait_day_S2
    
    Plant_trait_day_PLC57KO <- Plant_trait_day %>% filter(Plant_trait_day$GT == "PLC5/7 KO")
    Control_mean_trait_day_PLC57KO <- Plant_trait_day_PLC57KO %>% filter(Plant_trait_day_PLC57KO$stress == "control",Plant_trait_day_PLC57KO$Value != "NA")
    Control_mean_trait_day_PLC57KO <- mean(Control_mean_trait_day_PLC57KO$Value)
    Plant_trait_day_PLC57KO$Value <- Plant_trait_day_PLC57KO$Value/Control_mean_trait_day_PLC57KO
    
    Plant_trait_day_Col <- Plant_trait_day %>% filter(Plant_trait_day$GT == "Col-0")
    Control_mean_trait_day_Col <- Plant_trait_day_Col %>% filter(Plant_trait_day_Col$stress == "control", Plant_trait_day_Col$Value != "NA")
    Control_mean_trait_day_Col <- mean(Control_mean_trait_day_Col$Value)
    Plant_trait_day_Col$Value <- Plant_trait_day_Col$Value/Control_mean_trait_day_Col
    
    Plant_trait_day_E30 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "E30")
    Control_mean_trait_day_E30 <- Plant_trait_day_E30 %>% filter(Plant_trait_day_E30$stress == "control", Plant_trait_day_E30$Value != "NA")
    Control_mean_trait_day_E30 <- mean(Control_mean_trait_day_E30$Value)
    Plant_trait_day_E30$Value <- Plant_trait_day_E30$Value/Control_mean_trait_day_E30
    
    Plant_trait_day_Q4 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "Q4")
    Control_mean_trait_day_Q4 <- Plant_trait_day_Q4 %>% filter(Plant_trait_day_Q4$stress == "control", Plant_trait_day_Q4$Value != "NA")
    Control_mean_trait_day_Q4 <- mean(Control_mean_trait_day_Q4$Value)
    Plant_trait_day_Q4$Value <- Plant_trait_day_Q4$Value/Control_mean_trait_day_Q4
    
    Plant_trait_day_S1 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "S1")
    Control_mean_trait_day_S1 <- Plant_trait_day_S1 %>% filter(Plant_trait_day_S1$stress == "control", Plant_trait_day_S1$Value != "NA")
    Control_mean_trait_day_S1 <- mean(Control_mean_trait_day_S1$Value)
    Plant_trait_day_S1$Value <- Plant_trait_day_S1$Value/Control_mean_trait_day_S1
    
    Plant_trait_day_ML1 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "ML1-1")
    Control_mean_trait_day_ML1 <- Plant_trait_day_ML1 %>% filter(Plant_trait_day_ML1$stress == "control", Plant_trait_day_ML1$Value != "NA")
    Control_mean_trait_day_ML1 <- mean(Control_mean_trait_day_ML1$Value)
    Plant_trait_day_ML1$Value <- Plant_trait_day_ML1$Value/Control_mean_trait_day_ML1
    
    Plant_trait_day_Cab3 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "Cab3")
    Control_mean_trait_day_Cab3 <- Plant_trait_day_Cab3 %>% filter(Plant_trait_day_Cab3$stress == "control", Plant_trait_day_Cab3$Value != "NA")
    Control_mean_trait_day_Cab3 <- mean(Control_mean_trait_day_Cab3$Value)
    Plant_trait_day_Cab3$Value <- Plant_trait_day_Cab3$Value/Control_mean_trait_day_Cab3
    
    Plant_trait_day_CER6 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "CER6")
    Control_mean_trait_day_CER6 <- Plant_trait_day_CER6 %>% filter(Plant_trait_day_CER6$stress == "control", Plant_trait_day_CER6$Value != "NA")
    Control_mean_trait_day_CER6 <- mean(Control_mean_trait_day_CER6$Value)
    Plant_trait_day_CER6$Value <- Plant_trait_day_CER6$Value/Control_mean_trait_day_CER6
    
    Plant_trait_day_LRC3 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "LRC3")
    Control_mean_trait_day_LRC3 <- Plant_trait_day_LRC3 %>% filter(Plant_trait_day_LRC3$stress == "control", Plant_trait_day_LRC3$Value != "NA")
    Control_mean_trait_day_LRC3 <- mean(Control_mean_trait_day_LRC3$Value)
    Plant_trait_day_LRC3$Value <- Plant_trait_day_LRC3$Value/Control_mean_trait_day_LRC3
    
    Plant_trait_day_A14 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "A14")
    Control_mean_trait_day_A14 <- Plant_trait_day_A14 %>% filter(Plant_trait_day_A14$stress == "control", Plant_trait_day_A14$Value != "NA")
    Control_mean_trait_day_A14 <- mean(Control_mean_trait_day_A14$Value)
    Plant_trait_day_A14$Value <- Plant_trait_day_A14$Value/Control_mean_trait_day_A14
    
    Plant_trait_day_E28 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "E28")
    Control_mean_trait_day_E28 <- Plant_trait_day_E28 %>% filter(Plant_trait_day_E28$stress == "control", Plant_trait_day_E28$Value != "NA")
    Control_mean_trait_day_E28 <- mean(Control_mean_trait_day_E28$Value)
    Plant_trait_day_E28$Value <- Plant_trait_day_E28$Value/Control_mean_trait_day_E28
    
    Plant_trait_day_LRC1 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "LRC1")
    Control_mean_trait_day_LRC1 <- Plant_trait_day_LRC1 %>% filter(Plant_trait_day_LRC1$stress == "control", Plant_trait_day_LRC1$Value != "NA")
    Control_mean_trait_day_LRC1 <- mean(Control_mean_trait_day_LRC1$Value)
    Plant_trait_day_LRC1$Value <- Plant_trait_day_LRC1$Value/Control_mean_trait_day_LRC1
    
    Plant_trait_day_E49 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "E49")
    Control_mean_trait_day_E49 <- Plant_trait_day_E49 %>% filter(Plant_trait_day_E49$stress == "control", Plant_trait_day_E49$Value != "NA")
    Control_mean_trait_day_E49 <- mean(Control_mean_trait_day_E49$Value)
    Plant_trait_day_E49$Value <- Plant_trait_day_E49$Value/Control_mean_trait_day_E49
    
    Plant_trait_day_DR5 <- Plant_trait_day %>% filter(Plant_trait_day$GT == "DR5")
    Control_mean_trait_day_DR5 <- Plant_trait_day_DR5 %>% filter(Plant_trait_day_DR5$stress == "control", Plant_trait_day_DR5$Value != "NA")
    Control_mean_trait_day_DR5 <- mean(Control_mean_trait_day_DR5$Value)
    Plant_trait_day_DR5$Value <- Plant_trait_day_DR5$Value/Control_mean_trait_day_DR5
    
    Plant_trait_day_PLC5KO <- Plant_trait_day %>% filter(Plant_trait_day$GT == "PLC5-1 KO")
    Control_mean_trait_day_PLC5KO <- Plant_trait_day_PLC5KO %>% filter(Plant_trait_day_PLC5KO$stress == "control", Plant_trait_day_PLC5KO$Value != "NA")
    Control_mean_trait_day_PLC5KO <- mean(Control_mean_trait_day_PLC5KO$Value)
    Plant_trait_day_PLC5KO$Value <- Plant_trait_day_PLC5KO$Value/Control_mean_trait_day_PLC5KO
    
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_PLC2)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_PLC3)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_PLC4)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_PLC5)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_PLC7)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_PLC9)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_S2)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_PLC57KO)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_Col)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_E30)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_Q4)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_S1)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_ML1)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_Cab3)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_CER6)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_LRC3)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_A14)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_E28)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_LRC1)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_E49)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_DR5)
    Plant_trait_day_WT <- rbind(Plant_trait_day_WT, Plant_trait_day_PLC5KO)
    
    Plant_trait_fill <- rbind(Plant_trait_fill,Plant_trait_day_WT)
  }
  Plant_fill3 <- rbind(Plant_fill3,Plant_trait_fill)
}  

Plant_fill4 <- Plant_fill3
Plant_fill4 <- Plant_fill4 %>% filter(Plant_fill4$Value != "Inf", Plant_fill4$Value != "-Inf", Plant_fill4$Value != "NA")

#Plant2 <- Plant_fill4
#now go back and finish the dataprep, and then turn plant into plantsize here. Without removing outliers again
PlantSize3 <- Plant3 %>% filter(projPlantSurfaceArea_mm2 > 0.000000000001)



#### Identify all samples which only have 1 or 2 timepoints for an ID
rm(countsize)
countsize<-data.frame(ID=character(0),count=numeric(0))
for (val in uniqueID) {
  ID <- c(val)
  counttemp <- PlantSize3 %>% filter(PlantSize3$ID == val)
  counts <- nrow(counttemp)
  
  countsdf <- data.frame(ID)
  countsdf$Genotype <- unique(sumtemp$Genotype)
  countsdf$stress <- unique(sumtemp$stress)
  countsdf$gene <- unique(sumtemp$gene)
  countsdf$GT <- unique(sumtemp$GT)
  countsdf$count <- counts
  
  countsize <- rbind(countsize,countsdf)
}
countremove <- countsize %>% filter(countsize$count < 3)
uniqueCountremove <- unique(countremove$ID)
for (val in uniqueCountremove) {
  PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ID != val)
}

#normalize to day 
#do seperate for control and drought loop over traits. 
Plant_fill7 <- Plant6 %>% dplyr::filter(Plant6$Device == "6")
Plant_fill7$Value <- as.numeric(Plant_fill7$Value)
uniquetraits <- as.vector(unique(Plant6$Trait))
for (val in uniquetraits){
  Plant_trait <- Plant6 %>% filter(Trait == val)
  uniquedays <- unique(Plant_trait$MeasurementDate_das)
  Plant_trait_fill <- Plant_trait %>% filter(Device == "6")
  for (days in uniquedays){
    Plant_trait_day <- Plant_trait %>% filter(MeasurementDate_das == days)
    Plant_trait_day_control <- Plant_trait_day %>% filter(stress == "control")
    mean_trait_day_control <- mean(Plant_trait_day_control$Value, na.rm=TRUE)
    Plant_trait_day_control$Value <- Plant_trait_day_control$Value/mean_trait_day_control
    Plant_trait_day_drought <- Plant_trait_day %>% filter(stress == "drought")
    mean_trait_day_drought <- mean(Plant_trait_day_drought$Value, na.rm=TRUE)
    Plant_trait_day_drought$Value <- Plant_trait_day_drought$Value/mean_trait_day_drought
    Plant_trait_day_control <- rbind(Plant_trait_day_control, Plant_trait_day_drought)
    Plant_trait_fill <- rbind(Plant_trait_fill,Plant_trait_day_control)
  }
  Plant_fill7 <- rbind(Plant_fill7,Plant_trait_fill)
}
Plant_fill8 <- Plant_fill7
Plant_fill8 <- Plant_fill8 %>% filter(Plant_fill8$Value != "Inf", Plant_fill8$Value != "-Inf", Plant_fill8$Value != "NA")
Plant2 <- Plant_fill8


############################################################################################################
#write the projected plantsize to something after removing
########

projectedplantsize <- data.frame(PlantSize3$ID)
projectedplantsize$Genotype <- PlantSize3$Genotype
projectedplantsize$MeasurementDate_das <- PlantSize3$MeasurementDate_das
projectedplantsize$gene <- PlantSize3$gene
projectedplantsize$Device <- PlantSize3$Device
projectedplantsize$stress <- PlantSize3$stress
projectedplantsize$GT <- PlantSize3$GT
projectedplantsize$ExperimentID <- PlantSize3$ExperimentID
projectedplantsize$projPlantSurfaceArea_mm2 <- PlantSize3$projPlantSurfaceArea_mm2
projectedplantsize$projPlantSurfaceArea_pixels2 <- PlantSize3$projPlantSurfaceArea_pixels2

projectedplantsize <- projectedplantsize %>% filter(projectedplantsize$projPlantSurfaceArea_mm2 > 0.0001)
write.csv(projectedplantsize,'projectedplantsize.csv')


setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/PlantSurfaceArea")


PlantSize3_OE <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "OE")
PlantSize3_Tissue <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "Tissue")
PlantSize3_KO <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "KO")

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,PlantSize3_OE$projPlantSurfaceArea_mm2 > 0.000001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress, ExperimentID) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~ExperimentID)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_GT_OE_drought_no_errorbar_experimentID.png", plot = last_plot(),width = 6, height =5)

PlantSize3  %>% 
  filter(MeasurementDate_das == 33, projPlantSurfaceArea_mm2 > 0.000001, stress == "drought")%>%
  group_by(MeasurementDate_das, Device) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_point(aes(color=Device))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + 
  ylab("projPlantSurfaceArea_mm2") +
  labs(title = "PlantSurfaceArea")
ggsave("Test_raw_Plant_SurfaceArea_seperated_by_exp.png", plot = last_plot(),width = 12, height =12)
  
PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,PlantSize3_OE$projPlantSurfaceArea_mm2 > 0.00001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,PlantSize3_OE$projPlantSurfaceArea_mm2 > 0.00001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,PlantSize3_OE$projPlantSurfaceArea_mm2 > 0.00001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,PlantSize3_OE$projPlantSurfaceArea_mm2 > 0.00001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,PlantSize3_OE$projPlantSurfaceArea_mm2 > 0.00001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,PlantSize3_OE$projPlantSurfaceArea_mm2 > 0.00001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,PlantSize3_OE$projPlantSurfaceArea_mm2 > 0.00001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18,PlantSize3_Tissue$projPlantSurfaceArea_mm2 > 0.00001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("projPlantSurfaceArea(mm2)") +labs(title = "projPlantSurfaceArea_mm2")
ggsave("Plant_SurfaceArea_GT_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,PlantSize3_KO$projPlantSurfaceArea_mm2 > 0.00001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)

PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,PlantSize3_KO$projPlantSurfaceArea_mm2 > 0.00001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_Genotype_KO_control_errorbar.png", plot = last_plot(),width = 7, height =5)















######################################################################################################
#############################################################################################################
# Make subgroups for the tredlines
######
daysafterstress <- data.frame(time=c(39,40,41,42,43,44,45))
daysafterstressV <- c(39,40,41,42,43,44,45)
daysbeforestress <- data.frame(time=c(16,17,18,19,20,21,22,23,24))
daysbeforestressV <- c(16,17,18,19,20,21,22,23,24)
daysOfstress <- data.frame(time=c(25,26,27,28,29,30,31,32,33,34,35,36,37,38))
daysOfstressV <- c(25,26,27,28,29,30,31,32,33,34,35,36,37,38)
alldays <- data.frame(time=c(16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45))
alldaysV <- c(16,17,18,19,20,21,22,23,24,25,26,27,28,29,30,31,32,33,34,35,36,37,38,39,40,41,42,43,44,45)

daysafterstressmore <- data.frame(time=seq(39, 45, by=0.05))
daysbeforestressmore <- data.frame(time=seq(16, 24, by=0.05))
daysOfstressmore <- data.frame(time=seq(25, 38, by=0.05))
alldaysmore <- data.frame(time=seq(16, 45, by=0.05))

plant3control <- PlantSize3 %>% filter(PlantSize3$stress == "control")
plant3controlall <- plant3control %>% filter(plant3control$MeasurementDate_das < 60)
plant3controlbefore <- plant3control %>% filter(plant3control$MeasurementDate_das < 25)
plant3controlduring <- plant3control %>% filter(plant3control$MeasurementDate_das > 24 & plant3control$MeasurementDate_das < 39)
plant3controlafter <- plant3control %>% filter(plant3control$MeasurementDate_das >38)

plant3drought <- PlantSize3 %>% filter(PlantSize3$stress == "drought")
plant3droughtall <- plant3drought %>% filter(plant3drought$MeasurementDate_das < 60)
plant3droughtbefore <- plant3drought %>% filter(plant3drought$MeasurementDate_das < 25)
plant3droughtduring <-plant3drought %>% filter(plant3drought$MeasurementDate_das > 24 & plant3drought$MeasurementDate_das < 39)
plant3droughtafter <-plant3drought %>% filter(plant3drought$MeasurementDate_das >38) 
plantDroughtRecovery3 <- plant3droughtafter
######################################################################################################
############################################################################################################
# Predicted control tredlines
######
rm(countsizecontrol)
countsizecontrol<-data.frame(ID=character(0),count=numeric(0))
uniqueID2 <- unique(plant3control$ID)
for (val in uniqueID2) {
  ID <- c(val)
  counttemp <- plant3control %>% filter(plant3control$ID == val)
  counts <- nrow(counttemp)
  
  countsdf <- data.frame(ID)
  countsdf$ShootIDs <- unique(counttemp$ShootIDs)
  countsdf$Genotype <- unique(counttemp$Genotype)
  countsdf$stress <- unique(counttemp$stress)
  countsdf$gene <- unique(counttemp$gene)
  countsdf$GT <- unique(counttemp$GT)
  countsdf$count <- counts
  
  countsizecontrol <- rbind(countsizecontrol,countsdf)
}
uniqueCountControl <- countsizecontrol %>% filter(countsizecontrol$count < 4)
uniqueCountControl <- unique(uniqueCountControl$ID)

for (val in uniqueCountControl) {
  plant3control <- plant3control %>% filter(plant3control$ID != val)
}



rm(predictedplantsize2)
rm(predictioncontrolcofficients)
predictedplantsize2<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  predictedplantsize=numeric(0))
predictioncontrolcofficients <-data.frame(coffecients=character(0),Estimates=numeric(0), "Std. Error"=numeric(0),"t value"=numeric(0), "Pr(>|t|)"=numeric(0),ID=character(0), Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0))
days <- alldays
uniqueID <- unique(plant3control$ID)
numberofcycle <- 0
#model uses: in the case of normalized data
for (val in uniqueID) {
  PlantTemp <- plant3control %>% filter(plant3control$ID == val)
  PlantTemp2 <- subset(PlantTemp, select=c("MeasurementDate_das", "projPlantSurfaceArea_mm2"))
  size <- PlantTemp2$projPlantSurfaceArea_mm2
  time <- PlantTemp2$MeasurementDate_das
  #normal start:    start = c(alpha = 0.1, beta = 0.2))
    model <- nls(size ~ alpha * exp(beta * time), 
                 start = c(alpha = 0.1, beta = 0.2))
  #Only for the days that range the original data.
  days <- data.frame(time=seq(min(time), max(time), by=1))
  predictedplantsize <- predict(model, newdata=days)
  predictedplantsizedf <- data.frame(days)
  predictedplantsizedf$ID <- val
  predictedplantsizedf$ShootIDs <- unique(PlantTemp$ShootIDs)
  predictedplantsizedf$Genotype <- unique(PlantTemp$Genotype)
  predictedplantsizedf$stress <- unique(PlantTemp$stress)
  predictedplantsizedf$gene <- unique(PlantTemp$gene)
  predictedplantsizedf$GT <- unique(PlantTemp$GT)
  
  predictedplantsizedf$predictedplantsize <- predictedplantsize
  predictedplantsize2 <- rbind(predictedplantsize2,predictedplantsizedf)
  
  #but variables of the model in a dataframe
  sum_sizecontrol <- summary(model)
  mat_sizecontrol <- sum_sizecontrol$coefficients
  mat_sizecontrol_df <- as.data.frame((mat_sizecontrol))
  mat_sizecontrol_df <- tibble::rownames_to_column(mat_sizecontrol_df, "cofficients")
  mat_sizecontrol_df$ID <- val
  mat_sizecontrol_df$Genotype <- unique(PlantTemp$Genotype)
  mat_sizecontrol_df$ShootIDs <- unique(PlantTemp$ShootIDs)
  mat_sizecontrol_df$stress <- unique(PlantTemp$stress)
  mat_sizecontrol_df$gene <- unique(PlantTemp$gene)
  mat_sizecontrol_df$GT <- unique(PlantTemp$GT)
  predictioncontrolcofficients <- rbind(predictioncontrolcofficients, mat_sizecontrol_df)
  #how many runs
  numberofcycle <- numberofcycle +1
}

predictedplantsize_control_summery <- predictedplantsize2 %>% 
  group_by(GT, time) %>%
  summarise(
    mean = mean(predictedplantsize, na.rm = TRUE),
    sd = sd(predictedplantsize, na.rm = TRUE),
    se = sd / 2^0.5
  )

write.csv(predictedplantsize_control_summery, 'predictedplantsize_control_summery.csv')


######################################################################################################
############################################################################################################
#Output files and graphs
#####



temp <- predictedplantsize2
temp$ID <- NULL
temp$stress <- NULL
temp$gene <- NULL
tempd22 <- temp %>% filter(temp$time == "22")
tempd22$time <- NULL
tempd22$Genotype <- NULL

predictedplantsize_sort <- spread(tempd22, GT, predictedplantsize)



#raw data output files
for (val2 in alldaysV) {
  rm(temptime)
  temptime <- predictedplantsize2 %>% filter(time == val2)
  day <- paste("predict","day",val2,".csv", sep = "")
  rm(predictedplantsize_sort)
  predictedplantsize_sort <- as.data.frame(seq(1, 122, by=1))
  
  for (val in uniqueGT) {
    protemp <- temptime %>% filter(GT == val)
    protemp2 <- subset(protemp, select=c("predictedplantsize"))
    colnames(protemp2) <- c(val)
    predictedplantsize_sort <- cbind.fill(predictedplantsize_sort, protemp2)
  }
  
  write.csv(predictedplantsize_sort, file = file.path("raw","control", day))
}



#cofficients output file
predictioncontrolcofficients_beta <- predictioncontrolcofficients %>% filter(cofficients == "alpha")
rm(predictioncontrolcofficients_sort)
IDs <- predictioncontrolcofficients_beta$ID
predictioncontrolcofficients_sort <- data.frame(IDs)

uniqueGenotype <- unique(projectedplantsize$GT)
rm(protemp2)

for (val in uniqueGenotype) {
  protemp <- predictioncontrolcofficients_beta %>% filter(GT == val)
  ID <- protemp$ID
  protemp2 <- data.frame(ID)
  protemp2$Estimate <- protemp$Estimate
  
  colnames(protemp2) <- c("IDs", val)
  predictioncontrolcofficients_sort <- merge(predictioncontrolcofficients_sort, protemp2, by="IDs", all.x = TRUE)
}

write.csv(predictioncontrolcofficients_sort,'predictioncontrolcofficients_sort.csv')

#
#now that we have predicted values we can growth per day. But first see how the lines look like

predictedplantsize2  %>% filter(gene != "OE") %>% filter(time < 43) %>%
  group_by(time,gene, GT) %>%
  summarise(
    mean = mean(predictedplantsize, na.rm = TRUE),
    sd = sd(predictedplantsize, na.rm = TRUE),
    se = sd / 2^0.5
  ) %>%
  ggplot(mapping = aes(group=GT,shape=GT, color=GT, x = time,y=mean)) +
  geom_line() + 
  geom_point() +
  scale_shape_manual(values = c(1,2,3,4,5,6,7,8,9,10,11,12,13,14,15,16,17,18,19,20,21,22,23)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se),) +
  theme_bw() +
  labs(
    title = "predictedplantsize for Tissue specific in control conditions"
  )


predictioncontrolcofficients  %>% filter(gene != "Tissue") %>% filter(cofficients == "beta") %>%
  group_by(gene, GT) %>%
  summarise(
    mean = mean(Estimate, na.rm = TRUE),
    sd = sd(Estimate, na.rm = TRUE),
    se = sd / 2^0.5
  ) %>%
  ggplot(predictioncontrolcofficients, mapping = aes(x = reorder(GT, -mean),y=mean)) +
  geom_bar( stat = "identity") +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se),) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

######################################################################################################
###########################################################################################################
# distribution of number of drought plants per period of time
#####
rm(countsizedroughbefore)
countsizedroughbefore<-data.frame(ID=character(0),count=numeric(0))
uniqueID2 <- unique(plant3droughtbefore$ID)
for (val in uniqueID2) {
  ID <- c(val)
  counttemp <- plant3droughtbefore %>% filter(plant3droughtbefore$ID == val)
  counts <- nrow(counttemp)
  
  countsdf <- data.frame(ID)
  countsdf$ShootIDs <- unique(counttemp$ShootIDs)
  countsdf$Genotype <- unique(counttemp$Genotype)
  countsdf$stress <- unique(counttemp$stress)
  countsdf$gene <- unique(counttemp$gene)
  countsdf$GT <- unique(counttemp$GT)
  countsdf$count <- counts
  
  countsizedroughbefore <- rbind(countsizedroughbefore,countsdf)
}
# countsize before drought is all between 2 and 4 timepoints.

####
rm(countsizedroughtduring)
countsizedroughtduring<-data.frame(ID=character(0),count=numeric(0))
uniqueID2 <- unique(plant3droughtduring$ID)
for (val in uniqueID2) {
  ID <- c(val)
  counttemp <- plant3droughtduring %>% filter(plant3droughtduring$ID == val)
  counts <- nrow(counttemp)
  
  countsdf <- data.frame(ID)
  countsdf$Genotype <- unique(counttemp$Genotype)
  countsdf$ShootIDs <- unique(counttemp$ShootIDs)
  countsdf$stress <- unique(counttemp$stress)
  countsdf$gene <- unique(counttemp$gene)
  countsdf$GT <- unique(counttemp$GT)
  countsdf$count <- counts
  
  countsizedroughtduring <- rbind(countsizedroughtduring,countsdf)
}
# countsize before drought is all between 5 and 10 timepoints.

###
rm(countsizedroughtafter)
countsizedroughtafter<-data.frame(ID=character(0),count=numeric(0))
uniqueID2 <- unique(plant3droughtafter$ID)
for (val in uniqueID2) {
  ID <- c(val)
  counttemp <- plant3droughtafter %>% filter(plant3droughtafter$ID == val)
  counts <- nrow(counttemp)
  
  countsdf <- data.frame(ID)
  countsdf$Genotype <- unique(counttemp$Genotype)
  countsdf$ShootIDs <- unique(counttemp$ShootIDs)
  countsdf$stress <- unique(counttemp$stress)
  countsdf$gene <- unique(counttemp$gene)
  countsdf$GT <- unique(counttemp$GT)
  countsdf$count <- counts
  
  countsizedroughtafter <- rbind(countsizedroughtafter,countsdf)
}
# countsize before drought is all between 1 and 2 timepoints.
######################################################################################################
###########################################################################################################
# predicted drought before tredlines
#####
# The plants with only 2 time points I will manually take the differential and 
# draw a exponential line through the rest of the data, same code as control data but only with earliest time points form drought.

daysbeforestress <- data.frame(time=c(16,17,18,19,20,21,22,23,24))
daysbeforestressV <- c(16,17,18,19,20,21,22,23,24)
plant3droughtbefore <- plant3drought %>% filter(plant3drought$MeasurementDate_das < 25)

countsizedroughbefore3 <- countsizedroughbefore %>% filter(countsizedroughbefore$count > 2)
unique_before_stay_count3 <- unique(countsizedroughbefore3$ID)
rm(plant3droughtbefore3)
plant3droughtbefore3<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  predictedplantsize=numeric(0))
for (val in unique_before_stay_count3) {
  temprecovery <- plant3droughtbefore %>% filter(plant3droughtbefore$ID == val)
  plant3droughtbefore3 <- rbind(plant3droughtbefore3,temprecovery)
}

countsizedroughbefore2 <- countsizedroughbefore %>% filter(countsizedroughbefore$count == 2)
unique_before_stay_count2 <- unique(countsizedroughbefore2$ID)
rm(plant3droughtbefore2)
plant3droughtbefore2<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  predictedplantsize=numeric(0))
for (val in unique_before_stay_count2) {
  temprecovery <- plant3droughtbefore %>% filter(plant3droughtbefore$ID == val)
  plant3droughtbefore2 <- rbind(plant3droughtbefore2,temprecovery)
}
unique(plant3droughtbefore3$MeasurementDate_das)

rm(predictedplantsizebefore)
rm(predictedplantsizebeforecofficients)
predictedplantsizebefore<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  predictedplantsize=numeric(0))
predictedplantsizebeforecofficients <-data.frame(coffecients=character(0),Estimates=numeric(0), "Std. Error"=numeric(0),"t value"=numeric(0), "Pr(>|t|)"=numeric(0),ID=character(0), Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0))
days <- daysbeforestress
uniqueID <- unique(plant3droughtbefore3$ID)
numberofcycle <- 0
for (val in uniqueID) {
  PlantTemp <- plant3droughtbefore3 %>% filter(plant3droughtbefore3$ID == val)
  PlantTemp2 <- subset(PlantTemp, select=c("MeasurementDate_das", "projPlantSurfaceArea_mm2"))
  size <- PlantTemp2$projPlantSurfaceArea_mm2
  time <- PlantTemp2$MeasurementDate_das
  model <- nls(size ~ alpha * exp(beta * time), 
               start = c(alpha = 0.1, beta = 0.2))
  #Only for the days that range the original data.
  predictedplantsize <- predict(model, newdata=days)
  predictedplantsizedf <- data.frame(days)
  predictedplantsizedf$ID <- val
  predictedplantsizedf$ShootIDs <- unique(PlantTemp$ShootIDs)
  predictedplantsizedf$Genotype <- unique(PlantTemp$Genotype)
  predictedplantsizedf$stress <- unique(PlantTemp$stress)
  predictedplantsizedf$gene <- unique(PlantTemp$gene)
  predictedplantsizedf$GT <- unique(PlantTemp$GT)
  
  predictedplantsizedf$predictedplantsize <- predictedplantsize
  predictedplantsizebefore <- rbind(predictedplantsizebefore,predictedplantsizedf)
  
  #but variables of the model in a dataframe
  sum_sizecontrol <- summary(model)
  mat_sizecontrol <- sum_sizecontrol$coefficients
  mat_sizecontrol_df <- as.data.frame((mat_sizecontrol))
  mat_sizecontrol_df <- tibble::rownames_to_column(mat_sizecontrol_df, "cofficients")
  mat_sizecontrol_df$ID <- val
  mat_sizecontrol_df$Genotype <- unique(PlantTemp$Genotype)
  mat_sizecontrol_df$ShootIDs <- unique(PlantTemp$ShootIDs)
  mat_sizecontrol_df$stress <- unique(PlantTemp$stress)
  mat_sizecontrol_df$gene <- unique(PlantTemp$gene)
  mat_sizecontrol_df$GT <- unique(PlantTemp$GT)
  predictedplantsizebeforecofficients <- rbind(predictedplantsizebeforecofficients, mat_sizecontrol_df)
  #how many runs
  numberofcycle <- numberofcycle +1
}

# the 2 day data points are day 21 and day 23 only (so that's easy) and should be for 
# day: 16,17,18,19,20,21,22,23,24
rm(predictedplantsizebefore2)
predictedplantsizebefore2<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  predictedplantsize=numeric(0))
days <- daysbeforestress
numberofcycle <- 0
unique_before_stay_count2 <- unique(plant3droughtbefore2$ID)
for (val in unique_before_stay_count2) {
  day21 <- plant3droughtbefore2 %>% filter(plant3droughtbefore2$ID == val) 
  day21 <- day21 %>% filter(day21$MeasurementDate_das == "21")
  day21 <- day21$projPlantSurfaceArea_mm2
  day23 <- plant3droughtbefore2 %>% filter(plant3droughtbefore2$ID == val) 
  day23 <- day23 %>% filter(day23$MeasurementDate_das == "23")
  day23 <- day23$projPlantSurfaceArea_mm2
  
  delta_before_drought <- (day23 - day21)/2
  
  #now put in the data
  PlantTemp <- countsizedroughbefore2 %>% filter(countsizedroughbefore2$ID == val)
  PlantTemp$count <- NULL 
  PlantTemp16 <- PlantTemp
  PlantTemp16$time <- "16"
  PlantTemp16$projPlantSurfaceArea_mm2 <- day21 - (5*delta_before_drought)
  
  PlantTemp17 <- PlantTemp
  PlantTemp17$time <- "17"
  PlantTemp17$projPlantSurfaceArea_mm2 <- day21 - (4*delta_before_drought)
  
  PlantTemp18 <- PlantTemp
  PlantTemp18$time <- "18"
  PlantTemp18$projPlantSurfaceArea_mm2 <- day21 - (3*delta_before_drought)
  
  PlantTemp19 <- PlantTemp
  PlantTemp19$time <- "19"
  PlantTemp19$projPlantSurfaceArea_mm2 <- day21 - (2*delta_before_drought)
  
  PlantTemp20 <- PlantTemp
  PlantTemp20$time <- "20"
  PlantTemp20$projPlantSurfaceArea_mm2 <- day21 - (1*delta_before_drought)
  
  PlantTemp21 <- PlantTemp
  PlantTemp21$time <- "21"
  PlantTemp21$projPlantSurfaceArea_mm2 <- day21
  
  PlantTemp22 <- PlantTemp
  PlantTemp22$time <- "22"
  PlantTemp22$projPlantSurfaceArea_mm2 <- day21 + (1*delta_before_drought)
  
  PlantTemp23 <- PlantTemp
  PlantTemp23$time <- "23"
  PlantTemp23$projPlantSurfaceArea_mm2 <- day23
  
  PlantTemp24 <- PlantTemp
  PlantTemp24$time <- "24"
  PlantTemp24$projPlantSurfaceArea_mm2 <- day23 + (1*delta_before_drought)
  
  predictedplantsizedf <- rbind(PlantTemp16,PlantTemp17)
  predictedplantsizedf <- rbind(predictedplantsizedf, PlantTemp18)
  predictedplantsizedf <- rbind(predictedplantsizedf, PlantTemp19)
  predictedplantsizedf <- rbind(predictedplantsizedf, PlantTemp20)
  predictedplantsizedf <- rbind(predictedplantsizedf, PlantTemp21)
  predictedplantsizedf <- rbind(predictedplantsizedf, PlantTemp22)
  predictedplantsizedf <- rbind(predictedplantsizedf, PlantTemp23)
  predictedplantsizedf <- rbind(predictedplantsizedf, PlantTemp24)
  numberofcycle <- numberofcycle +1
  predictedplantsizedf$value <- NULL
  predictedplantsizebefore2 <- rbind(predictedplantsizebefore2,predictedplantsizedf)
}  

predictedplantsizebefore2 <- predictedplantsizebefore2 %>% filter(predictedplantsizebefore2$projPlantSurfaceArea_mm2 > 5)
predictedplantsizebefore2 <- predictedplantsizebefore2 %>% 
  rename(
    predictedplantsize = projPlantSurfaceArea_mm2,
  )
predictedplantsizebefore <- rbind(predictedplantsizebefore, predictedplantsizebefore2)




######################################################################################################
###########################################################################################################
# predicted drought during tredlines
#####
#Plants make stop growing after a period of time after being exposed to drought so assume ax^2+bx+c curve
days <- daysOfstress
rm(predictedplantsizeduringdrought)
rm(predictiondroughtduringcofficients)
predictedplantsizeduringdrought<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  predictedplantsize=numeric(0))
predictiondroughtduringcofficients <-data.frame(coffecients=character(0),Estimates=numeric(0), "Std. Error"=numeric(0),"t value"=numeric(0), "Pr(>|t|)"=numeric(0),ID=character(0), Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0))
uniqueIDdroughtDuring <- unique(plant3droughtduring$ID)
numberofcycle <- 0
for (val in uniqueIDdroughtDuring) {
  PlantTemp <- plant3droughtduring %>% filter(plant3droughtduring$ID == val)
  PlantTemp2 <- subset(PlantTemp, select=c("MeasurementDate_das", "projPlantSurfaceArea_mm2"))
  size <- PlantTemp2$projPlantSurfaceArea_mm2
  time <- PlantTemp2$MeasurementDate_das
  #              start = c(alpha = -0.7, beta = 30, delta = -500))
  model <- nls(size ~ alpha * time * time + beta *time + delta,
               start = c(alpha = -0.7, beta = 30, delta = -500))
  predictedplantsize <- predict(model, newdata=days)
  predictedplantsizedf <- data.frame(days)
  predictedplantsizedf$ID <- val
  predictedplantsizedf$ShootIDs <- unique(PlantTemp$ShootIDs)
  predictedplantsizedf$Genotype <- unique(PlantTemp$Genotype)
  predictedplantsizedf$stress <- unique(PlantTemp$stress)
  predictedplantsizedf$gene <- unique(PlantTemp$gene)
  predictedplantsizedf$GT <- unique(PlantTemp$GT)
  
  predictedplantsizedf$predictedplantsize <- predictedplantsize
  numberofcycle <- numberofcycle +1
  predictedplantsizeduringdrought <- rbind(predictedplantsizeduringdrought,predictedplantsizedf)
  
  #but variables of the model in a dataframe
  sum_sizedroughtduring <- summary(model)
  mat_sizedroughtduring <- sum_sizedroughtduring$coefficients
  mat_sizedroughtduring_df <- as.data.frame((mat_sizedroughtduring))
  mat_sizedroughtduring_df <- tibble::rownames_to_column(mat_sizedroughtduring_df, "cofficients")
  mat_sizedroughtduring_df$ID <- val
  mat_sizedroughtduring_df$ShootIDs <- unique(PlantTemp$ShootIDs)
  mat_sizedroughtduring_df$Genotype <- unique(PlantTemp$Genotype)
  mat_sizedroughtduring_df$stress <- unique(PlantTemp$stress)
  mat_sizedroughtduring_df$gene <- unique(PlantTemp$gene)
  mat_sizedroughtduring_df$GT <- unique(PlantTemp$GT)
  predictiondroughtduringcofficients <- rbind(predictiondroughtduringcofficients, mat_sizedroughtduring_df)
  
}
### using the predicted total growth during drought  dataset I want to find the growth during the drought period. I took day 37 for the last day (instead of 38, as they might go down again at that point)
# for the first day we are taking day 26. Again not the first day, because there the outliers will be even bigger.
#for the control dataset just take the same. only for the control dataset.

predictday25 <- predictedplantsizeduringdrought %>% filter(predictedplantsizeduringdrought$time == 25) 
predictday35 <- predictedplantsizeduringdrought %>% filter(predictedplantsizeduringdrought$time == 35)

duringdroughtsize <- merge(predictday25, predictday35, by= "ID")
duringdroughtsize$differential2535 <- (duringdroughtsize$predictedplantsize.y - duringdroughtsize$predictedplantsize.x)/10
#
predictday25control <- predictedplantsize2 %>% filter(predictedplantsize2$time == 25) 
predictday35control <- predictedplantsize2 %>% filter(predictedplantsize2$time == 35)

duringdroughtsizecontrol <- merge(predictday25control, predictday35control, by= "ID")
duringdroughtsizecontrol$differential2535 <- (duringdroughtsizecontrol$predictedplantsize.y - duringdroughtsizecontrol$predictedplantsize.x)/10

#dan nu normaliseren..
predictedplantsizecontroltemp2 <- duringdroughtsizecontrol %>% group_by(Genotype.x, stress.x) %>%
  summarise(
    mean = mean(differential2535, na.rm = TRUE),
    sd = sd(differential2535, na.rm = TRUE),
    se = sd / 2^0.5
  )

#maar dan dat ie de tabel helemaal opvult.
duringdroughtsizenormalized <- merge(duringdroughtsize, predictedplantsizecontroltemp2, by="Genotype.x", all = T)

#deel kolom a door kolom b
duringdroughtsizenormalized$normalized <- duringdroughtsizenormalized$differential2535 / duringdroughtsizenormalized$mean


######################################################################################################
###########################################################################################################
# predicted drought after tredlines
#####
#add Day 37 from the predicted dataset to the drought after data set, so it has a beginning and a start.
predictdfday37 <- predictedplantsizeduringdrought %>% filter(predictedplantsizeduringdrought$time == 37)
names(predictdfday37)[names(predictdfday37) == 'predictedplantsize'] <- 'projPlantSurfaceArea_mm2'

rm(plantDroughtRecovery)
plantDroughtRecovery<-data.frame(time=numeric(0),  ID=character(0),  ShootIDs=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  predictedplantsize=numeric(0))
plantDroughtRecovery <- subset(plant3droughtafter, select=c("MeasurementDate_das", "ID", "ShootIDs", "Genotype", "stress", "gene", "GT", "projPlantSurfaceArea_mm2"))
names(plantDroughtRecovery)[names(plantDroughtRecovery) == 'MeasurementDate_das'] <- 'time'

plantDroughtRecovery <- rbind(plantDroughtRecovery,predictdfday37)

#now remove all the ID that only have no data points after day 37, which is only plant: 1397117
plantDroughtRecovery <- plantDroughtRecovery %>% filter(plantDroughtRecovery$ID != 1397117)




#drawing a tredline can only be with 3 datapoints. So that I will that for those with 3 data points. For the ones with only 2 points I'll mannually calculate de delta

####
###only take plants with 2 timepoints after day 38
countsizedroughtRecovery3 <- countsizedroughtafter %>% filter(countsizedroughtafter$count == 2)
uniquestaycount3 <- unique(countsizedroughtRecovery3$ID)
rm(plantDroughtRecovery3)
plantDroughtRecovery3<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  predictedplantsize=numeric(0))
for (val in uniquestaycount3) {
  temprecovery <- plantDroughtRecovery %>% filter(plantDroughtRecovery$ID == val)
  plantDroughtRecovery3 <- rbind(plantDroughtRecovery3,temprecovery)
}

#only take plants with 1 timepoints after day 38
countsizedroughtRecovery2 <- countsizedroughtafter %>% filter(countsizedroughtafter$count == 1)
uniquestaycount2 <- unique(countsizedroughtRecovery2$ID)
rm(plantDroughtRecovery2)
plantDroughtRecovery2<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  predictedplantsize=numeric(0))
for (val in uniquestaycount2) {
  temprecovery <- plantDroughtRecovery %>% filter(plantDroughtRecovery$ID == val)
  plantDroughtRecovery2 <- rbind(plantDroughtRecovery2,temprecovery)
}

####
#for the plants with multiple timepoints after day 38 we draw a line through them and export the data per timepoint to a new dataframe
daysofrecovery <- data.frame(time=c(37,38,39,40,41,42,43,44,45))
days <- daysofrecovery
rm(predictedplantsizerecovery)
rm(predictiondroughrecoverycofficients)
predictedplantsizerecovery<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  predictedplantsize=numeric(0))
predictiondroughrecoverycofficients <-data.frame(coffecients=character(0),Estimates=numeric(0), "Std. Error"=numeric(0),"t value"=numeric(0), "Pr(>|t|)"=numeric(0),ID=character(0), Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0))
uniqueIDrecovery <- unique(plantDroughtRecovery3$ID)
numberofcycle <- 0
for (val in uniqueIDrecovery) {
  PlantTemp <- plantDroughtRecovery3 %>% filter(plantDroughtRecovery3$ID == val)
  PlantTemp2 <- subset(PlantTemp, select=c("time", "projPlantSurfaceArea_mm2"))
  size <- PlantTemp2$projPlantSurfaceArea_mm2
  time <- PlantTemp2$time
  model <- nls(size ~ alpha * time + beta,
               start = c(alpha = 68, beta = -2500))
  predictedplantsize <- predict(model, newdata=days)
  predictedplantsizedf <- data.frame(days)
  predictedplantsizedf$ID <- val
  predictedplantsizedf$ShootIDs <- unique(PlantTemp$ShootIDs)
  predictedplantsizedf$Genotype <- unique(PlantTemp$Genotype)
  predictedplantsizedf$stress <- unique(PlantTemp$stress)
  predictedplantsizedf$gene <- unique(PlantTemp$gene)
  predictedplantsizedf$GT <- unique(PlantTemp$GT)
  
  predictedplantsizedf$projPlantSurfaceArea_mm2 <- predictedplantsize
  numberofcycle <- numberofcycle +1
  predictedplantsizerecovery <- rbind(predictedplantsizerecovery,predictedplantsizedf)
  
  sum_sizedroughtrecovery <- summary(model)
  mat_sizedroughtrecovery <- sum_sizedroughtrecovery$coefficients
  mat_sizedroughtrecovery_df <- as.data.frame((mat_sizedroughtrecovery))
  mat_sizedroughtrecovery_df <- tibble::rownames_to_column(mat_sizedroughtrecovery_df, "cofficients")
  mat_sizedroughtrecovery_df$ID <- val
  mat_sizedroughtrecovery_df$ShootIDs <- unique(PlantTemp$ShootIDs)
  mat_sizedroughtrecovery_df$Genotype <- unique(PlantTemp$Genotype)
  mat_sizedroughtrecovery_df$stress <- unique(PlantTemp$stress)
  mat_sizedroughtrecovery_df$gene <- unique(PlantTemp$gene)
  mat_sizedroughtrecovery_df$GT <- unique(PlantTemp$GT)
  predictiondroughrecoverycofficients <- rbind(predictiondroughrecoverycofficients, mat_sizedroughtrecovery_df)
}

predictiondroughrecoverycofficients_small <- predictiondroughrecoverycofficients %>% filter(cofficients == "alpha") %>% filter(Estimate < 10)

# from the predictedplantsizerecovery we now extract day 44. Add this to the day 37 data, and the seperate timepoint from only 1 time point data. 
recoverysize <- plantDroughtRecovery2 %>% spread(time, projPlantSurfaceArea_mm2)

#nu de verschillende colummen van elkaar af trekken.
recoverysize$"37_41" <- (recoverysize$"41" - recoverysize$"37")/4
recoverysize$"37_42" <- (recoverysize$"42" - recoverysize$"37")/5
recoverysize$"37_43" <- (recoverysize$"43" - recoverysize$"37")/6
recoverysize$"37_44" <- (recoverysize$"44" - recoverysize$"37")/7

#remove rows that are not usefull anymore. 
#melt different rows back (opposite of spread). And then remove the "time" row, and rename the value row.
recoverysize2 <- recoverysize
recoverysize2$"41" <- NULL
recoverysize2$"42" <- NULL
recoverysize2$"43" <- NULL
recoverysize2$"44" <- NULL
recoverysize2$"37" <- NULL

recoverysize2molten <- melt(recoverysize2, id = c("ID","ShootIDs", "Genotype", "stress", "gene", "GT"))
recoverysize2molten <- na.omit(recoverysize2molten)
recoverysize2molten$variable <- NULL



# now loop per ID. And fill in the the day 38 - 44 data
rm(predictedplantsizerecovery2)
rm(predictiondroughrecoverycofficients)
predictedplantsizerecovery2<-data.frame(time=numeric(0),  ID=character(0), ShootIDs=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  predictedplantsize=numeric(0))
predictiondroughrecoverycofficients <-data.frame(coffecients=character(0), ShootIDs=character(0),Estimates=numeric(0), "Std. Error"=numeric(0),"t value"=numeric(0), "Pr(>|t|)"=numeric(0),ID=character(0), Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0))
uniquerecoverysize2molten <- unique(recoverysize2molten$ID)
numberofcycle <- 0

for (val in uniquerecoverysize2molten) {
  PlantTemp <- recoverysize2molten %>% filter(recoverysize2molten$ID == val)
  PlantTemp38 <- recoverysize2molten %>% filter(recoverysize2molten$ID == val)
  PlantTemp38$time <- "38"
  sizeday37 <- predictdfday37 %>% filter(ID == val)
  PlantTemp38$projPlantSurfaceArea_mm2 <- sizeday37$projPlantSurfaceArea_mm2 + PlantTemp$value
  
  PlantTemp39 <- recoverysize2molten %>% filter(recoverysize2molten$ID == val)
  PlantTemp39$time <- "39"
  sizeday37 <- predictdfday37 %>% filter(ID == val)
  PlantTemp39$projPlantSurfaceArea_mm2 <- sizeday37$projPlantSurfaceArea_mm2 + (2* PlantTemp$value)
  
  PlantTemp40 <- recoverysize2molten %>% filter(recoverysize2molten$ID == val)
  PlantTemp40$time <- "40"
  sizeday37 <- predictdfday37 %>% filter(ID == val)
  PlantTemp40$projPlantSurfaceArea_mm2 <- sizeday37$projPlantSurfaceArea_mm2 + (3* PlantTemp$value)
  
  PlantTemp41 <- recoverysize2molten %>% filter(recoverysize2molten$ID == val)
  PlantTemp41$time <- "41"
  sizeday37 <- predictdfday37 %>% filter(ID == val)
  PlantTemp41$projPlantSurfaceArea_mm2 <- sizeday37$projPlantSurfaceArea_mm2 + (4* PlantTemp$value)
  
  PlantTemp42 <- recoverysize2molten %>% filter(recoverysize2molten$ID == val)
  PlantTemp42$time <- "42"
  sizeday37 <- predictdfday37 %>% filter(ID == val)
  PlantTemp42$projPlantSurfaceArea_mm2 <- sizeday37$projPlantSurfaceArea_mm2 + (5* PlantTemp$value)
  
  PlantTemp43 <- recoverysize2molten %>% filter(recoverysize2molten$ID == val)
  PlantTemp43$time <- "43"
  sizeday37 <- predictdfday37 %>% filter(ID == val)
  PlantTemp43$projPlantSurfaceArea_mm2 <- sizeday37$projPlantSurfaceArea_mm2 + (6* PlantTemp$value)
  
  PlantTemp44 <- recoverysize2molten %>% filter(recoverysize2molten$ID == val)
  PlantTemp44$time <- "44"
  sizeday37 <- predictdfday37 %>% filter(ID == val)
  PlantTemp44$projPlantSurfaceArea_mm2 <- sizeday37$projPlantSurfaceArea_mm2 + (7* PlantTemp$value)
  
  predictedplantsizedf <- rbind(PlantTemp38,PlantTemp39)
  predictedplantsizedf <- rbind(predictedplantsizedf, PlantTemp40)
  predictedplantsizedf <- rbind(predictedplantsizedf, PlantTemp41)
  predictedplantsizedf <- rbind(predictedplantsizedf, PlantTemp42)
  predictedplantsizedf <- rbind(predictedplantsizedf, PlantTemp43)
  predictedplantsizedf <- rbind(predictedplantsizedf, PlantTemp44)
  numberofcycle <- numberofcycle +1
  predictedplantsizedf$value <- NULL
  predictedplantsizerecovery2 <- rbind(predictedplantsizerecovery2,predictedplantsizedf)
}  

predictedplantsizerecovery2$value <- NULL
predictedplantsizerecovery <- predictedplantsizerecovery %>% 
  rename(
    predictedplantsize = projPlantSurfaceArea_mm2,
  )
predictedplantsizerecovery2 <- predictedplantsizerecovery2 %>% 
  rename(
    predictedplantsize = projPlantSurfaceArea_mm2,
  )
predictedplantsizerecovery <- rbind(predictedplantsizerecovery, predictedplantsizerecovery2)





################### normalized after drought growth per day.
### control conditions after drought
predictday37control <- predictedplantsize2 %>% filter(predictedplantsize2$time == 37) 
predictday43control <- predictedplantsize2 %>% filter(predictedplantsize2$time == 43)

afterdroughtsizecontrol <- merge(predictday37control, predictday43control, by= "ID")
afterdroughtsizecontrol$differential3743 <- (afterdroughtsizecontrol$predictedplantsize.y - afterdroughtsizecontrol$predictedplantsize.x)/6

#dan nu normaliseren..
predictedplantsizecontroltemp3 <- afterdroughtsizecontrol %>% group_by(Genotype.x) %>%
  summarise(
    mean = mean(differential3743, na.rm = TRUE),
    sd = sd(differential3743, na.rm = TRUE),
    se = sd / 2^0.5
  )

#maar dan dat ie de tabel helemaal opvult.
colnames(predictedplantsizecontroltemp3) <- c("Genotype", "mean", "sd", "se")
afterdroughtsizenormalized <- merge(recoverysize2molten, predictedplantsizecontroltemp3, by="Genotype", all = T)
#hierhier
#deel kolom a door kolom b
afterdroughtsizenormalized$normalized <- afterdroughtsizenormalized$value / afterdroughtsizenormalized$mean


#growth per day normalized during and after drought
relativegrowth1 <- afterdroughtsizenormalized %>% group_by(GT) %>%
  summarise(
    mean_after = mean(normalized, na.rm = TRUE),
    se_after = sd(normalized, na.rm = TRUE)/2^0.5
  )
relativegrowth2 <- duringdroughtsizenormalized %>% group_by(GT.x) %>%
  summarise(
    mean_during = mean(normalized, na.rm = TRUE),
    se_during = sd(normalized, na.rm = TRUE)/2^0.5
  )
colnames(relativegrowth2) <- c("GT", "mean_during","se_during")
relativegrowth <- merge(relativegrowth1, relativegrowth2, by="GT", all = T)

#I will make it ready for the graphpad in excel.
write.csv(relativegrowth,'relativegrowth.csv')

















#####################################################################################################
#####################################################################################################
# add all drought things together and calculate growth per day
#####
rm(Predictedplantsizedrought)
Predictedplantsizedrought <- rbind(predictedplantsizebefore, (predictedplantsizeduringdrought %>% filter(predictedplantsizeduringdrought$time < "38")))
Predictedplantsizedrought <- rbind(Predictedplantsizedrought, (predictedplantsizerecovery %>% filter(predictedplantsizerecovery$time > "37")))

Predictedplantsizedrought_summery <- Predictedplantsizedrought %>% 
  group_by(GT, time) %>%
  summarise(
    mean = mean(predictedplantsize, na.rm = TRUE),
    sd = sd(predictedplantsize, na.rm = TRUE),
    se = sd / 2^0.5
  )

write.csv(Predictedplantsizedrought_summery, 'Predictedplantsizedrought_summery.csv')

rm(delta_growth_drought)
delta_growth_drought<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  Delta_growth=numeric(0))
uniquedelta <- unique(Predictedplantsizedrought$ID)
val <- 1396864
day <- 20
Predictedplantsizedrought <- unique(Predictedplantsizedrought)

for (val in uniquedelta) {
  deltadf <- Predictedplantsizedrought %>% filter(Predictedplantsizedrought$ID == val)
  daysdelta <- unique(deltadf$time)
  daysdelta2 <- head(daysdelta, -1)
  rm(deltaIDdf)
  deltaIDdf <- data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  Delta_growth=numeric(0))
    for (day in daysdelta2) {
    time <- as.numeric(day) + 1
    time2 <- time
    deltaIDdf2 <- data.frame(time)
    deltaIDdf2$ID <- val
    deltaIDdf2$Genotype <- unique(deltadf$Genotype)
    deltaIDdf2$stress <- unique(deltadf$stress)
    deltaIDdf2$gene <- unique(deltadf$gene)
    deltaIDdf2$GT <- unique(deltadf$GT)
    d <- deltadf %>% filter(deltadf$time == day)
    d <- d$predictedplantsize
    d1 <- deltadf %>% filter(deltadf$time == (time2))
    d1 <- d1$predictedplantsize
    deltaIDdf2$Delta_growth <- (d1 - d)
    
    deltaIDdf <- (rbind(deltaIDdf,deltaIDdf2))
    }
  delta_growth_drought <- rbind(delta_growth_drought, deltaIDdf)
}    

delta_growth_drought_graph <- 
  delta_growth_drought %>% filter(delta_growth_drought$time != "25")
#delta_growth_drought_graph <- 
#  delta_growth_drought_graph %>% filter(delta_growth_drought_graph$time < "38")


delta_growth_drought_graph$GT2 <- ifelse(grepl("W",delta_growth_drought_graph$GT),'.WT','B')
delta_growth_drought_graph$GT2 <- ifelse(grepl("2",delta_growth_drought_graph$GT),'PLC2',delta_growth_drought_graph$GT2)
delta_growth_drought_graph$GT2 <- ifelse(grepl("3",delta_growth_drought_graph$GT),'PLC3',delta_growth_drought_graph$GT2)
delta_growth_drought_graph$GT2 <- ifelse(grepl("4",delta_growth_drought_graph$GT),'PLC4',delta_growth_drought_graph$GT2)
delta_growth_drought_graph$GT2 <- ifelse(grepl("5",delta_growth_drought_graph$GT),'PLC5',delta_growth_drought_graph$GT2)
delta_growth_drought_graph$GT2 <- ifelse(grepl("7",delta_growth_drought_graph$GT),'PLC7',delta_growth_drought_graph$GT2)
delta_growth_drought_graph$GT2 <- ifelse(grepl("9",delta_growth_drought_graph$GT),'PLC9',delta_growth_drought_graph$GT2)


view(delta_growth_drought_graph)

ifelse(grepl("Red",color),"red","other")

delta_growth_drought_graph_OE <- delta_growth_drought_graph %>% filter(delta_growth_drought_graph$gene == "WT" | delta_growth_drought_graph$gene == "OE")
delta_growth_drought_graph_Tissue <- delta_growth_drought_graph %>% filter(delta_growth_drought_graph$gene == "WT" | delta_growth_drought_graph$gene == "Tissue")
delta_growth_drought_graph_KO <- delta_growth_drought_graph %>% filter(delta_growth_drought_graph$gene == "WT" | delta_growth_drought_graph$gene == "KO")

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs2")

  
delta_growth_drought_graph_OE %>% 
  group_by(GT, time, stress) %>%
  summarise(
    mean = mean(Delta_growth, na.rm = TRUE),
    sd = sd(Delta_growth, na.rm = TRUE),
    se = sd / 2^0.5
  ) %>%
  ggplot(delta_growth_drought_graph_OE,mapping = aes(color=GT, x = time,y=mean)) +
  facet_wrap( ~ GT) +
  geom_line() + 
  geom_hline(yintercept=0) +
  geom_point() +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se),) +
  labs(
    title = "growth per day OEs all days"
  )
ggsave("growth_per_day_OEs_all_days.png", plot = last_plot())
view(delta_growth_drought_graph_OE)


delta_growth_drought_graph_OE  %>% 
  group_by(time,gene, GT2,stress) %>%
  summarise(mean = mean(Delta_growth, na.rm = TRUE), sd = sd(Delta_growth, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT2, color=GT2),size = 1)+
  facet_wrap(~GT2,ncol = 4)+
  scale_linetype_manual(values=c(2,1,1,1,1,1,1))+
  scale_color_manual(values=c('#000000','#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02'))+
  geom_point(aes(shape=GT2, color=GT2, size=GT2))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#000000','#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02'))+
  scale_size_manual(values=c(1,1,1,1,1,1,1))+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT2)) +
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("growthrate_OE_drought.png", plot = last_plot())


delta_growth_drought_graph <- 
  delta_growth_drought %>% filter(delta_growth_drought$time != "25")
#delta_growth_drought_graph <- 
#  delta_growth_drought_graph %>% filter(delta_growth_drought_graph$time < "38")

delta_growth_drought_summery <- delta_growth_drought_graph %>% 
  group_by(GT, time, stress) %>%
  summarise(
    mean = mean(Delta_growth, na.rm = TRUE),
    sd = sd(Delta_growth, na.rm = TRUE),
    se = sd / 2^0.5
    )
write.csv(delta_growth_drought_summery, 'delta_growth_drought_summery.csv')

hierzo

#######
#when do plants stop growing

growth_stop_day <- delta_growth_drought %>% filter(delta_growth_drought$time > 25, delta_growth_drought$time < 39)
growth_stop_day$Growth_square <- growth_stop_day$Delta_growth * growth_stop_day$Delta_growth
UniqueID <- unique(growth_stop_day$ID)
min_growth2 <- growth_stop_day %>% filter(growth_stop_day$time == "banjo")
for (val in UniqueID){
  min_growth <- growth_stop_day %>% filter(growth_stop_day$ID == val)
  min_growth <- min(min_growth$Growth_square)
  min_growth <- growth_stop_day %>% filter(growth_stop_day$Growth_square == min_growth)
  min_growth2 <- rbind(min_growth2, min_growth)
}
#mingrowth exportable
min_growth3 <- min_growth2
min_growth3$Delta_growth <- NULL
min_growth3$Growth_square <- NULL
min_growth3$time <- as.numeric(min_growth3$time)
min_growth3$ID <- NULL
min_growth4 <- min_growth3 %>% spread(GT, time)
uniqueGT <- unique(min_growth2$GT)

PP <- "PLC2"
min_growth5 <- min_growth4
for (PP in uniqueGT){
  min_growth3 <- min_growth2 %>% filter(min_growth2$GT == PP)
  min_growth4 <- as.data.frame(min_growth3$time)
  colnames(min_growth4) <- c(PP)
  #map2(min_growth5, min_growth4, left_join)
  min_growth5 <- cbind.fill(min_growth5, min_growth4)
}
min_growth5 <- as.data.frame(min_growth5)
write.csv(min_growth5,'min_growth5.csv')





min_growth2  %>% filter(min_growth2$gene == "WT" | min_growth2$gene == "OE") %>%
  group_by(GT) %>%
  summarise(
    mean = mean(time, na.rm = TRUE),
    sd = sd(time, na.rm = TRUE),
    se = sd / 2^0.5
  ) %>%
  ggplot(min_growth2, mapping = aes(x =GT,y=mean)) +
  geom_bar( stat = "identity",  ylim=c(20,40)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se)) +
  theme_bw() +
  theme(axis.text.x = element_text(angle = 90, hjust = 1))

PlantSize3_OE <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "OE")
PlantSize3_Tissue <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "Tissue")
PlantSize3_KO <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "KO")

#####################################################################################################
#####################################################################################################
# predicted size graphs
#####################################################################################################
setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/predicted_PlantSurfaceArea")




predictedplantsize$predictedplantsize <- as.numeric(predictedplantsize$predictedplantsize)
predictedplantsize$time <- as.numeric(predictedplantsize$time)




predictedplantsize_OE <- predictedplantsize %>% filter(gene == "WT" | gene == "OE")
predictedplantsize_Tissue <- predictedplantsize %>% filter(gene == "WT" | gene == "Tissue")
predictedplantsize_KO <- predictedplantsize %>% filter(gene == "WT" | gene == "KO")

predictedplantsize_OE  %>% 
  filter(predictedplantsize_OE$time > 18,predictedplantsize_OE$predictedplantsize > 0.000001, predictedplantsize_OE$stress == "control")%>%
  group_by(time,gene, GT,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = time,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_SurfaceArea_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

predictedplantsize_OE  %>% 
  filter(time > 18, stress == "control")%>%
  group_by(time,gene, GT,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_predictedplantsize_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)


predictedplantsize_OE  %>% 
  filter(time > 18,predictedplantsize > 0.00001, stress == "drought")%>%
  group_by(time,gene, GT,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_predictedplantsize_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


predictedplantsize_OE  %>% 
  filter(time > 18,stress == "control")%>%
  group_by(time,gene,GT,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_predictedplantsize_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



predictedplantsize_OE  %>% 
  filter(time > 18,predictedplantsize > 0.00001, stress == "drought")%>%
  group_by(time,gene, Genotype,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_predictedplantsize_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

predictedplantsize_OE  %>% 
  filter(time > 18,predictedplantsize > 0.00001, stress == "control")%>%
  group_by(time,gene, Genotype,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_predictedplantsize_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

predictedplantsize_OE  %>% 
  filter(time > 18,predictedplantsize > 0.00001, stress == "drought")%>%
  group_by(time,gene, Genotype,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_predictedplantsize_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

predictedplantsize_OE  %>% 
  filter(time > 18,predictedplantsize > 0.00001, stress == "control")%>%
  group_by(time,gene, Genotype,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_predictedplantsize_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


predictedplantsize_Tissue  %>% 
  filter(predictedplantsize_Tissue$time > 18,predictedplantsize_Tissue$predictedplantsize > 0.00001)%>%
  group_by(time,gene, Genotype,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_predictedplantsize_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

predictedplantsize_KO  %>% 
  filter(predictedplantsize_KO$time > 18,predictedplantsize_KO$predictedplantsize > 0.00001)%>%
  group_by(time,gene, Genotype,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Plant_predictedplantsize_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)


#####################################################################################################
#Relative growth during and after growth
################################################################################################
view(Predictedplantsizedrought)
#The other paper used growth compared to the control conditions

#for every ID
#size at day 26, 37 en -44- max days
#dataframe$ID <- ID
#dataframe$GT
#dataframe$genotype
#during <- 37-26/44
#recovery <- 44-37/44

#####################################################################################################
#normalize predicted size
#####################################################################################################
#Copy the info from the normaliziation just don't do the stuff that's loops for traits

#ik ben hier

predictedplantsize2$predictedplantsize
Predictedplantsizedrought


predictedplantsize_normalized_drought <- predictedplantsize2 %>% filter(predictedplantsize2$time == 456)
uniquedays <- unique(predictedplantsize2$time)
uniqueGT  <- unique(predictedplantsize2$GT)
for (x in uniquedays){
  predic_control_day <- predictedplantsize2 %>% filter(predictedplantsize2$time == x)
  predic_drought_day <- Predictedplantsizedrought %>% filter(Predictedplantsizedrought$time == x)
  predictedsize_drought_day <- predic_drought_day %>% filter(predic_drought_day$time == 456)  
  for (y in uniqueGT) {
    predic_control_day_GT <- predic_control_day %>% filter(predic_control_day$GT == y)
    predic_control_day_GT <- mean(predic_control_day_GT$predictedplantsize)
    predic_drought_day_GT <- predic_drought_day %>% filter(predic_drought_day$GT == y)
    predic_drought_day_GT$predictedplantsize <- predic_drought_day_GT$predictedplantsize / predic_control_day_GT
    
    predictedsize_drought_day <- rbind(predictedsize_drought_day, predic_drought_day_GT)
    }
  predictedplantsize_normalized_drought <- rbind(predictedplantsize_normalized_drought,predictedsize_drought_day)
}

predictedplantsize_normalized_drought %>% ggplot2(time, predictedplantsize)
predictedplantsize_normalized_drought <- predictedplantsize_normalized_drought %>% filter(predictedplantsize != "NaN")
predictedplantsize_normalized_drought$predictedplantsize <- as.numeric(predictedplantsize_normalized_drought$predictedplantsize)






setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/predicted_PlantSurfaceArea")
predictedplantsize_normalized_drought_OE <- predictedplantsize_normalized_drought %>% filter(predictedplantsize_normalized_drought$gene == "WT" | predictedplantsize_normalized_drought$gene == "OE")
predictedplantsize_normalized_drought_Tissue <- predictedplantsize_normalized_drought %>% filter(predictedplantsize_normalized_drought$gene == "WT" | predictedplantsize_normalized_drought$gene == "Tissue")
predictedplantsize_normalized_drought_KO <- predictedplantsize_normalized_drought %>% filter(predictedplantsize_normalized_drought$gene == "WT" | predictedplantsize_normalized_drought$gene == "KO")


bluh <- predictedplantsize_normalized_drought_OE %>% filter(predictedplantsize > -2)

predictedplantsize_normalized_drought_OE  %>% 
  filter(predictedplantsize_normalized_drought_OE$time > 19,predictedplantsize_normalized_drought_OE$predictedplantsize > 0.00001, predictedplantsize_normalized_drought_OE$stress == "drought")%>%
  group_by(time,GT,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean, group = GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  geom_rect(aes(xmin = 6, xmax = 18, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Predicted_PlantSurfaceArea(mm2)") +labs(title = "predicted_PlantSurfaceArea")
ggsave("predicted_plantsize_drought_GT_OE_no_errorbar.png", plot = last_plot(),width = 6, height =5)

predictedplantsize_normalized_drought_OE  %>% 
  filter(predictedplantsize_normalized_drought_OE$time > 19,predictedplantsize_normalized_drought_OE$predictedplantsize > 0.00001, predictedplantsize_normalized_drought_OE$stress == "drought")%>%
  group_by(time,GT,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean, group = GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  geom_rect(aes(xmin = 6, xmax = 18, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Predicted_PlantSurfaceArea(mm2)") +labs(title = "predicted_PlantSurfaceArea")
ggsave("predicted_plantsize_drought_GT_OE_errorbar.png", plot = last_plot(),width = 6, height =5)

predictedplantsize_normalized_drought_OE  %>% 
  filter(predictedplantsize_normalized_drought_OE$time > 19,predictedplantsize_normalized_drought_OE$predictedplantsize > 0.00001, predictedplantsize_normalized_drought_OE$stress == "drought")%>%
  group_by(time,Genotype,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean, group = Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  geom_rect(aes(xmin = 6, xmax = 18, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Predicted_PlantSurfaceArea(mm2)") +labs(title = "predicted_PlantSurfaceArea")
ggsave("predicted_plantsize_drought_Genotype_OE_no_errorbar.png", plot = last_plot(),width = 6, height =5)

predictedplantsize_normalized_drought_OE  %>% 
  filter(predictedplantsize_normalized_drought_OE$time > 19,predictedplantsize_normalized_drought_OE$predictedplantsize > 0.00001, predictedplantsize_normalized_drought_OE$stress == "drought")%>%
  group_by(time,Genotype,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean, group = Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  geom_rect(aes(xmin = 6, xmax = 18, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Predicted_PlantSurfaceArea(mm2)") +labs(title = "predicted_PlantSurfaceArea")
ggsave("predicted_plantsize_drought_Genotype_OE_errorbar.png", plot = last_plot(),width = 6, height =5)

predictedplantsize_normalized_drought_Tissue  %>% 
  filter(predictedplantsize_normalized_drought_Tissue$time > 19,predictedplantsize_normalized_drought_Tissue$predictedplantsize > 0.00001, predictedplantsize_normalized_drought_Tissue$stress == "drought")%>%
  group_by(time,Genotype,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean, group = Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  geom_rect(aes(xmin = 6, xmax = 18, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  facet_wrap(~stress)+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Predicted_PlantSurfaceArea(mm2)") +labs(title = "predicted_PlantSurfaceArea")
ggsave("predicted_plantsize_drought_Genotype_Tissue_errorbar.png", plot = last_plot(),width = 16, height =8)



predictedplantsize_normalized_drought_KO  %>% 
  filter(predictedplantsize_normalized_drought_KO$time > 19,predictedplantsize_normalized_drought_KO$predictedplantsize > 0.00001, predictedplantsize_normalized_drought_KO$stress == "drought")%>%
  group_by(time,Genotype,stress) %>%
  summarise(mean = mean(predictedplantsize, na.rm = TRUE), sd = sd(predictedplantsize, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = time,y=mean, group = Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  geom_rect(aes(xmin = 6, xmax = 18, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Predicted_PlantSurfaceArea(mm2)") +labs(title = "predicted_PlantSurfaceArea")
ggsave("predicted_plantsize_drought_Genotype_KO_no_errorbar.png", plot = last_plot(),width = 6, height =5)








###########################################################################################################
#When do the plants stop growing
#####
daysOfstressmore <- data.frame(time=seq(25, 45, by=0.05))
days <- daysOfstressmore
rm(predictedplantsizeduringdrought_more)
predictedplantsizeduringdrought_more<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  predictedplantsize=numeric(0))
uniqueIDdroughtDuring <- unique(plant3droughtduring$ID)
numberofcycle <- 0
for (val in uniqueIDdroughtDuring) {
  PlantTemp <- plant3droughtduring %>% filter(plant3droughtduring$ID == val)
  PlantTemp2 <- subset(PlantTemp, select=c("MeasurementDate_das", "projPlantSurfaceArea_mm2"))
  size <- PlantTemp2$projPlantSurfaceArea_mm2
  time <- PlantTemp2$MeasurementDate_das
  model <- nls(size ~ alpha * time * time + beta *time + delta,
               start = c(alpha = -0.7, beta = 30, delta = -500))
  predictedplantsize <- predict(model, newdata=days)
  predictedplantsizedf <- data.frame(days)
  predictedplantsizedf$ID <- val
  predictedplantsizedf$ShootIDs <- unique(PlantTemp$ShootIDs)
  predictedplantsizedf$Genotype <- unique(PlantTemp$Genotype)
  predictedplantsizedf$stress <- unique(PlantTemp$stress)
  predictedplantsizedf$gene <- unique(PlantTemp$gene)
  predictedplantsizedf$GT <- unique(PlantTemp$GT)
  
  predictedplantsizedf$predictedplantsize <- predictedplantsize
  numberofcycle <- numberofcycle +1
  predictedplantsizeduringdrought_more <- rbind(predictedplantsizeduringdrought_more,predictedplantsizedf)
}




rm(delta_growth_drought_more)
delta_growth_drought_more<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  Delta_growth=numeric(0))
uniquedelta <- unique(predictedplantsizeduringdrought_more$ID)

for (val in uniquedelta) {
  deltadf <- predictedplantsizeduringdrought_more %>% filter(predictedplantsizeduringdrought_more$ID == val)
  daysdelta <- unique(deltadf$time)
  daysdelta2 <- head(daysdelta, -20)
  rm(deltaIDdf)
  deltaIDdf <- data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  Delta_growth=numeric(0))
  for (day in daysdelta2) {
    time <- day + 1
    moment <- day+1
    deltaIDdf2 <- data.frame(time)

    deltaIDdf2$ID <- val
    deltaIDdf2$Genotype <- unique(deltadf$Genotype)
    deltaIDdf2$stress <- unique(deltadf$stress)
    deltaIDdf2$gene <- unique(deltadf$gene)
    deltaIDdf2$GT <- unique(deltadf$GT)
    d <- deltadf %>% filter(deltadf$time == day)
    d <- d$predictedplantsize
    d1 <- deltadf %>% filter(deltadf$time == moment)
    d1 <- d1$predictedplantsize
    if (length(d1) == 0){
      d1 <- "bleuh"
    }
    deltaIDdf2$d <- d
    deltaIDdf2$d1 <- d1
    tryCatch({
      deltaIDdf <- (rbind(deltaIDdf,deltaIDdf2))
    }, error=function(e){})
  }
  delta_growth_drought_more <- rbind(delta_growth_drought_more, deltaIDdf)
}    



sapply(delta_growth_drought_more, colnames)

delta_growth_drought_more$d <- as.numeric(delta_growth_drought_more$d)
delta_growth_drought_more$d1 <- as.numeric(delta_growth_drought_more$d1)
delta_growth_drought_more$delta <- delta_growth_drought_more$d1 - delta_growth_drought_more$d
delta_growth_drought_more$delta_square <- delta_growth_drought_more$delta * delta_growth_drought_more$delta


rm(min_delta)
min_delta_drought <-data.frame(ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  time=numeric(0))
uniqueMinDelta <- unique(delta_growth_drought_more$ID)
for (val in uniqueMinDelta) {
  ID <- c(val)
  minsizetemp <- delta_growth_drought_more %>% filter(delta_growth_drought_more$ID == val)
  minsizetemp <- na.omit(minsizetemp)
  mingrowth <- min(minsizetemp$delta_square)
  minsizetemp <- minsizetemp %>% filter(minsizetemp$delta_square == mingrowth)
  min_delta_drought <- rbind(min_delta_drought,minsizetemp)
}

ggplot(min_delta_drought,mapping = aes(color=gene, x = Genotype ,y=time)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(
    title = "when do plants stop growing"
  )


#take out plants that are still growing -> all the plots with a positive Alpha
predictiondroughtduringcofficients_growing <- predictiondroughtduringcofficients %>% filter(predictiondroughtduringcofficients$cofficients == "alpha")
predictiondroughtduringcofficients_growing <- predictiondroughtduringcofficients_growing %>% filter(predictiondroughtduringcofficients_growing$Estimate > 0)
unique_predictiondroughtduringcofficients_growing <- unique(predictiondroughtduringcofficients_growing$ID)
min_delta_drought_filter <- min_delta_drought
for (val in unique_predictiondroughtduringcofficients_growing) {
  min_delta_drought_filter <- min_delta_drought_filter %>% filter(min_delta_drought_filter$ID != val)
}
#take out plants that don't stop growing untill after the end of the experiment
min_delta_drought_filter1 <- min_delta_drought_filter %>% filter(min_delta_drought_filter$time < 38)

ggplot(min_delta_drought_filter,mapping = aes(color=gene, x = Genotype ,y=time)) +
  geom_boxplot() +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(
    title = "Timepoint at which growth becomes closest to 0"
  )

ggplot(min_delta_drought_filter1,mapping = aes(color=gene, x = Genotype,y=time)) +
  geom_violin() +
  theme(axis.text.x = element_text(angle = 90)) +
  labs(
    title = "Timepoint at which growth becomes closest to 0"
  )


min_delta_drought_filter1_summery <- min_delta_drought_filter1 %>% 
  group_by(Genotype, stress) %>%
  summarise(
    mean = mean(time, na.rm = TRUE),
    sd = sd(time, na.rm = TRUE),
    se = sd / 2^0.5
)
write.csv(min_delta_drought_filter1_summery,'min_delta_drought_filter1_summery.csv')
######################################################################################################
#####################################################################################################
#delta delta of growth
#####################################################################################################
#Because the growth per day is a straight line, I can just look at the growth rate difference for 2 days.
UniqueIDDelta <- unique(delta_growth_drought$ID)
delta_growth_drought$delta_delta <- 0
delta_delta_growth_drought <- delta_growth_drought %>% filter(delta_growth_drought$time == "The_end_times")
for (val in UniqueIDDelta){
  delta_growth_ID <- delta_growth_drought %>% filter(delta_growth_drought$ID == val)
  growth_27 <- delta_growth_ID %>% filter(delta_growth_ID$time == 27)
  growth_28 <- delta_growth_ID %>% filter(delta_growth_ID$time == 28) 
  growth_27$delta_delta <-  growth_27$Delta_growth - growth_28$Delta_growth
  delta_delta_growth_drought <- rbind(delta_delta_growth_drought,growth_27)
}
view(delta_delta_growth_drought)
uniqueTrait <- sort(unique(delta_delta_growth_drought$Genotype))
rm(delta_delta_growth_drought_export)
delta_delta_growth_drought_export <- as.data.frame(sort(uniqueTrait))
for (val in uniqueTrait){
  delta_delta_growth_drought_Genotype <- delta_delta_growth_drought %>% filter(delta_delta_growth_drought$Genotype == val)
  delta_delta_growth_drought_Genotype <- as.data.frame(delta_delta_growth_drought_Genotype$delta_delta)
  colnames(delta_delta_growth_drought_Genotype) <- c(val)
  delta_delta_growth_drought_export <- cbind.fill(delta_delta_growth_drought_export,delta_delta_growth_drought_Genotype)
  delta_delta_growth_drought_export <- as.data.frame(delta_delta_growth_drought_export)
}
setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs2/predicted_PlantSurfaceArea")
#should have been the other way around with 28-27, so with results do everything times -1

#write.csv(delta_delta_growth_drought_export, 'delta_delta_growth_drought_export_GT.csv')
#write.csv(delta_delta_growth_drought_export, 'delta_delta_growth_drought_export_genotype.csv')

###########################################################################################################
#normalized to total size delta delta
###########################################################################################################
uniqueID <- unique(Predictedplantsizedrought$ID)
Predictedplantsizedrought_normalized26 <- Predictedplantsizedrought %>% filter(ID == "I_feel_fine")
for (val in uniqueID){
  predictedplantsizeduringdrought_ID <- Predictedplantsizedrought %>% filter(ID == val)
  predictedplantsizeduringdrought_ID_26 <- predictedplantsizeduringdrought_ID %>% filter(time == 26)
  predictedplantsizeduringdrought_ID_26 <- predictedplantsizeduringdrought_ID_26$predictedplantsize
  predictedplantsizeduringdrought_ID$predictedplantsize <- predictedplantsizeduringdrought_ID$predictedplantsize/predictedplantsizeduringdrought_ID_26*100
  Predictedplantsizedrought_normalized26 <- rbind(Predictedplantsizedrought_normalized26,predictedplantsizeduringdrought_ID)
}  

rm(delta_growth_drought_normalized26)
delta_growth_drought_normalized26<-data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  Delta_growth=numeric(0))
uniquedelta <- unique(Predictedplantsizedrought_normalized26$ID)
for (val in uniquedelta) {
  deltadf <- Predictedplantsizedrought_normalized26 %>% filter(Predictedplantsizedrought_normalized26$ID == val)
  daysdelta <- unique(deltadf$time)
  daysdelta2 <- head(daysdelta, -1)
  rm(deltaIDdf)
  deltaIDdf <- data.frame(time=numeric(0),  ID=character(0),  Genotype=character(0),  stress=character(0),  gene=character(0),  GT=character(0),  Delta_growth=numeric(0))
  for (day in daysdelta2) {
    time <- as.numeric(day) + 1
    time2 <- time
    deltaIDdf2 <- data.frame(time)
    deltaIDdf2$ID <- val
    deltaIDdf2$Genotype <- unique(deltadf$Genotype)
    deltaIDdf2$stress <- unique(deltadf$stress)
    deltaIDdf2$gene <- unique(deltadf$gene)
    deltaIDdf2$GT <- unique(deltadf$GT)
    d <- deltadf %>% filter(deltadf$time == day)
    d <- d$predictedplantsize
    d1 <- deltadf %>% filter(deltadf$time == (time2))
    d1 <- d1$predictedplantsize
    deltaIDdf2$Delta_growth <- (d1 - d)
    
    deltaIDdf <- (rbind(deltaIDdf,deltaIDdf2))
  }
  delta_growth_drought_normalized26 <- rbind(delta_growth_drought_normalized26, deltaIDdf)
}    

UniqueIDDelta <- unique(delta_growth_drought_normalized26$ID)
delta_growth_drought_normalized26$delta_delta <- 0
delta_delta_growth_drought_normalized26 <- delta_growth_drought_normalized26 %>% filter(delta_growth_drought_normalized26$time == "The_end_times")
for (val in UniqueIDDelta){
  delta_growth_ID <- delta_growth_drought_normalized26 %>% filter(delta_growth_drought_normalized26$ID == val)
  growth_27 <- delta_growth_ID %>% filter(delta_growth_ID$time == 27)
  growth_28 <- delta_growth_ID %>% filter(delta_growth_ID$time == 28) 
  growth_27$delta_delta <-  growth_27$Delta_growth - growth_28$Delta_growth
  delta_delta_growth_drought_normalized26 <- rbind(delta_delta_growth_drought_normalized26,growth_27)
}

uniqueTrait <- sort(unique(delta_delta_growth_drought_normalized26$GT))
rm(delta_delta_growth_drought_export_normalized26)
delta_delta_growth_drought_export_normalized26 <- as.data.frame(sort(uniqueTrait))
for (val in uniqueTrait){
  delta_delta_growth_drought_GT <- delta_delta_growth_drought_normalized26 %>% filter(delta_delta_growth_drought_normalized26$GT == val)
  delta_delta_growth_drought_GT <- as.data.frame(delta_delta_growth_drought_GT$delta_delta)
  colnames(delta_delta_growth_drought_GT) <- c(val)
  delta_delta_growth_drought_export_normalized26 <- cbind.fill(delta_delta_growth_drought_export_normalized26,delta_delta_growth_drought_GT)
  delta_delta_growth_drought_export_normalized26 <- as.data.frame(delta_delta_growth_drought_export_normalized26)
}
setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs2/predicted_PlantSurfaceArea")
write.csv(delta_delta_growth_drought_export_normalized26, 'delta_delta_growth_drought_export__normalized26_GT.csv')
#write.csv(delta_delta_growth_drought_export_normalized26, 'delta_delta_growth_drought_export_normalized_26_genotype.csv')


###########################################################################################################
#Plant biomass
#####
setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/biomass")
disconnectedplantpart %>% 
  filter(delta_growth_drought_graph$gene != "Tissue") %>%
  group_by(GT, time, stress) %>%
  summarise(
    mean = mean(Delta_growth, na.rm = TRUE),
    sd = sd(Delta_growth, na.rm = TRUE),
    se = sd / 2^0.5
  ) %>%
  ggplot(delta_growth_drought_graph,mapping = aes(color=GT, x = time,y=mean)) +
  facet_wrap( ~ GT) +
  geom_line() + 
  geom_hline(yintercept=0) +
  geom_point() +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se),) +
  labs(
    title = "growth per day OEs all days"
  )

#there are a bunch of dried plants that have triple measurements and are way to big. By filtering these can be (exactly) removed
disconnectedplantpart2 <- disconnectedplantpart %>% 
  filter(disconnectedplantpart$Value < 0.0011)
disconnectedplantpart2 <- disconnectedplantpart2 %>% 
  filter(disconnectedplantpart2$Value > 0.0000005)
hist(disconnectedplantpart2$Value, breaks = "sturges")

disconnectedplantpart_small <- as.data.frame(disconnectedplantpart2$ID)
disconnectedplantpart_small <- disconnectedplantpart_small %>% 
  rename(
    "ID" = "disconnectedplantpart2$ID"
  )
disconnectedplantpart_small$ShootIDs <- disconnectedplantpart2$ShootIDs
disconnectedplantpart_small$Trait <- disconnectedplantpart2$Trait
disconnectedplantpart_small$Value <- disconnectedplantpart2$Value
Disconnect_dry <- disconnectedplantpart_small %>% filter(Trait == "dry weight")
disconnectedplantpart_small$GT <- disconnectedplantpart2$GT
disconnectedplantpart_small$gene <- disconnectedplantpart2$gene
disconnectedplantpart_small$Genotype <- disconnectedplantpart2$Genotype
disconnectedplantpart_small$Treatments <- disconnectedplantpart2$Treatments
disconnectedplantpart_small$MeasurementDate_das <- disconnectedplantpart2$MeasurementDate_das
Disconnect_fresh <- disconnectedplantpart_small %>% filter(Trait == "fresh weight")

disconnectedplantpart_small2 <- merge(Disconnect_fresh, Disconnect_dry, by = "ID")

disconnectedplantpart_small2 <- disconnectedplantpart_small2 %>% 
  rename(
      "dry_weight" = "Value.y",
      "fresh_weight" = "Value.x"
      )
disconnectedplantpart_small2$Trait.x <- NULL 
disconnectedplantpart_small2$Trait.y <- NULL
disconnectedplantpart_small2$ShootIDs.y <- NULL
disconnectedplantpart_small2 <- disconnectedplantpart_small2 %>% 
  rename(
    "ShootIDs" = "ShootIDs.x",
  )


disconnectedplantpart_small2$fresh_weight <- disconnectedplantpart_small2$fresh_weight *1000
disconnectedplantpart_small2$dry_weight <-disconnectedplantpart_small2$dry_weight*1000

disconnectedplantpart_small3 <- disconnectedplantpart_small2 %>% filter(fresh_weight > 0.025, dry_weight > 0.0025)
disconnectedplantpart_small3$RWC <- (disconnectedplantpart_small3$fresh_weight - disconnectedplantpart_small3$dry_weight) / disconnectedplantpart_small3$fresh_weight *100
disconnectedplantpart_small3 <- disconnectedplantpart_small3 %>% filter(disconnectedplantpart_small3$fresh_weight < 1, disconnectedplantpart_small3$RWC > 50)
disconnectedplantpart_small3.raw <- disconnectedplantpart_small3
disconnectedplantpart_small3 <- disconnectedplantpart_small3.raw
#
disconnectedplantpart_small3 <- discontrait_normalized
disconnectedplantpart_small3 <- disconnectedplantpart_small3 %>% filter(Treatments == "drought_10perc_waterAvailability")
#
uniqueGT <- unique(disconnectedplantpart_small3$Genotype)
discontrait_FW <-as.data.frame(discontrait_FWtemp)
discontrait_DW <-as.data.frame(discontrait_DWtemp)
discontrait_RWC <- as.data.frame(discontrait_RWCtemp)
for (Val in uniqueGT){
  discontrait <- disconnectedplantpart_small3 %>% filter(disconnectedplantpart_small3$Genotype == Val)
  discontrait_FWtemp <- as.data.frame(discontrait$fresh_weight)
  discontrait_DWtemp <- as.data.frame(discontrait$dry_weight)
  discontrait_RWCtemp <- as.data.frame(discontrait$RWC)
  colnames(discontrait_FWtemp) <- c(Val)
  colnames(discontrait_DWtemp) <- c(Val)
  colnames(discontrait_RWCtemp) <- c(Val)
  discontrait_FW <- cbind.fill(discontrait_FW, discontrait_FWtemp)
  discontrait_DW <- cbind.fill(discontrait_DW, discontrait_DWtemp)
  discontrait_RWC <- cbind.fill(discontrait_RWC, discontrait_RWCtemp)
}
discontrait_FW <-as.data.frame(discontrait_FW)
discontrait_DW <-as.data.frame(discontrait_DW)
discontrait_RWC <- as.data.frame(discontrait_RWC)
write.csv(discontrait_FW, 'normalized_drought_discontrait_FW_Genotype.csv')
write.csv(discontrait_DW, 'normalized_drought_discontrait_DW_Genotype.csv')
write.csv(discontrait_RWC, 'normalized_drought_discontrait_RWC_Genotype.csv')

#control_discontrait_FW_GT <-as.data.frame(discontrait_FW)
#control_discontrait_DW_GT <-as.data.frame(discontrait_DW)
#control_discontrait_RWC_GT <- as.data.frame(discontrait_RWC)
#control_discontrait_FW_Genotype <-as.data.frame(discontrait_FW)
#control_discontrait_DW_Genotype <-as.data.frame(discontrait_DW)
#control_discontrait_RWC_Genotype <- as.data.frame(discontrait_RWC)

#drought_discontrait_FW_GT <-as.data.frame(discontrait_FW)
#drought_discontrait_DW_GT <-as.data.frame(discontrait_DW)
#drought_discontrait_RWC_GT <- as.data.frame(discontrait_RWC)
#drought_discontrait_FW_Genotype <-as.data.frame(discontrait_FW)
#drought_discontrait_DW_Genotype <-as.data.frame(discontrait_DW)
#drought_discontrait_RWC_Genotype <- as.data.frame(discontrait_RWC)

discontrait_normalized <- disconnectedplantpart_small3 %>% filter(disconnectedplantpart_small3$GT == "pelican")
for (Val in uniqueGT){
  discontrait <- disconnectedplantpart_small3 %>% filter(disconnectedplantpart_small3$GT == Val)
  discontrait_control <- discontrait %>% filter(Treatments == "control_60perc_waterAvailability")
  discontrait_control_fresh <- mean(discontrait$fresh_weight)
  discontrait_control_dry <- mean(discontrait$dry_weight)
  discontrait$fresh_weight <- discontrait$fresh_weight/discontrait_control_fresh
  discontrait$dry_weight <- discontrait$dry_weight/discontrait_control_dry
  discontrait_normalized <- rbind(discontrait_normalized,discontrait)
}  
  
  
  
norm_drought_discontrait_FW_GT <-as.data.frame(discontrait_FW)
norm_drought_discontrait_DW_GT <-as.data.frame(discontrait_DW)
norm_drought_discontrait_RWC_GT <- as.data.frame(discontrait_RWC)
norm_drought_discontrait_FW_Genotype <-as.data.frame(discontrait_FW)
norm_drought_discontrait_DW_Genotype <-as.data.frame(discontrait_DW)
norm_drought_discontrait_RWC_Genotype <- as.data.frame(discontrait_RWC)  
  





#fresh weight
#dry weigh
#control fresh weig
#control dry
disconnectedplantpart_small$Value <- disconnectedplantpart_small$Value *1000
disconnectedplantpart_small_OE <- disconnectedplantpart_small %>% filter(disconnectedplantpart_small$gene == "WT" | disconnectedplantpart_small$gene == "OE")
disconnectedplantpart_small_Tissue <- disconnectedplantpart_small %>% filter(disconnectedplantpart_small$gene == "WT" | disconnectedplantpart_small$gene == "Tissue")
disconnectedplantpart_small_KO <- disconnectedplantpart_small %>% filter(disconnectedplantpart_small$gene == "WT" | disconnectedplantpart_small$gene == "KO")


disconnectedplantpart_small_OE$GT <- factor(disconnectedplantpart_small_OE$GT , levels=c("WT", "PLC2", "PLC3", "PLC4", "PLC5", "PLC7", "PLC9"))

disconnectedplantpart_small_OE %>% filter(disconnectedplantpart_small_OE$Trait == "fresh weight",disconnectedplantpart_small_OE$Value < 0.6) %>%
ggplot(disconnectedplantpart_small_OE,mapping = aes(x = GT, y=Value, color = Treatments)) +
  facet_wrap( ~ Trait) +
  geom_boxplot() +
  theme_bw()+
  xlab(" ") + ylab("Fresh Weight(g)") +
  labs(
    title = "Fresh weight of OEs at harvest"
)
ggsave("Fresh_weight_of_OEs_at_harvest.png", plot = last_plot(),width = 8, height =5)


######################################################################################################
###########################################################################################################
#size and weight linear dependend?
#####

Predictdroughtday42 <- Predictedplantsizedrought %>% filter(time == "42")
disconnectVSpredict <- merge(disconnectedplantpart_small2,Predictdroughtday42, by="ShootIDs")
ggplot(disconnectVSpredict,mapping = aes(color=GT.x, x = dry_weight ,y=predictedplantsize)) +
  geom_point() +
  labs(
    title = "growth per day OEs all days"
  )

######################################################################################################
###########################################################################################################
#Germination rate
#####
setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/germination")
#each seed germination: germinationtime - measurementDate (from seedsourceglasspanel)
########

view(seeds)
germtime <- dat %>% filter(dat$Trait == "germinationtime")
germtime790 <- germtime %>% filter(germtime$ExperimentID == "790")
germtime812 <- germtime %>% filter(germtime$ExperimentID == "812")

germtime2 <- subset(germtime, select=c("GT", "MeasurementDate_das"))

germtime2 <- germtime2 %>% spread(GT, MeasurementDate_das)

#manually make a germtime3
for (val in unique(germtime2$GT)) {
  germtemp <- germtime2 %>% filter(germtime2$GT == val)
  germtemp <- as.data.frame(germtemp$MeasurementDate_das)
  colnames(germtemp) <- c(val)
  germtime3 <- qpcR:::cbind.na(germtime3, germtemp)
}
write.csv(germtime3, 'GerminationtimesGType.csv')

germtime$Creation.Date <- as.POSIXct(as.numeric(germtime$Creation.Date), origin = "1970-01-01", tz = "CET")
germtime$Creation.Date.time <- format(germtime$Creation.Date, '%H:%M:%S')
germtime$Germination <- as.POSIXct(as.numeric(germtime$Germination), origin = "1970-01-01", tz = "CET")
germtime$Value <- as.POSIXct(as.numeric(germtime$Value), origin = "1970-01-01", tz = "CET")

germtime$germdays <- germtime$Germination - germtime$Creation.Date 
germtime$germdays2 <- germtime$Value - germtime$Creation.Date 

germtime %>% 
  group_by(GT, gene) %>%
  summarise(
    mean = mean(germdays2, na.rm = TRUE),
    sd = sd(germdays2, na.rm = TRUE),
    se = sd / 2^0.5
  ) %>%
  ggplot(germtime,mapping = aes(color=gene, x = GT,y=mean)) +
  geom_point() +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se),) +
  labs(
    title = "growth per day OEs all days"
  )
ggsave("germtime_germdays2.png", plot = last_plot(),width = 7, height =5)
####

unique(germtime$Trait)

uniqueseeID <- unique(Plant2$SeedID)
germtime2 <- germtime
germtime3 <- germtime


for (val in uniqueseeID) {
  germtime2 <- germtime2 %>% filter(germtime2$SeedID != val)
}

germtime2$picked <- "no"

uniqueseeID2 <- unique(germtime2$SeedID)
for (val in uniqueseeID2) {
  germtime3 <- germtime3 %>% filter(germtime3$SeedID != val)
}
germtime3$picked <- "yes"
germtime4 <- rbind(germtime2, germtime3)

germtime4 %>% 
  filter(germtime4$Value > 0, germtime4$Trait == "germinationtime", germtime4$ExperimentID == "812") %>%
  ggplot(germtime,mapping = aes(x = GT,y=Value, color=picked)) +
  facet_wrap(~Trait) +
  geom_violin() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
labs(
  title = "growth per day OEs all days"
)

germtime4$germdays <- germtime4$germdays -4 
germtime4_OE <- germtime4 %>% filter(germtime4$gene == "WT" | germtime4$gene == "OE")
germtime4_Tissue <- germtime4 %>% filter(germtime4$gene == "WT" | germtime4$gene == "Tissue")


germtime4_Tissue %>% 
  filter(germtime4_Tissue$Value > 0, germtime4_Tissue$Trait == "germinationtime") %>%
  group_by(GT, Trait, picked, ExperimentID) %>%
  summarise(
    mean = mean(germdays, na.rm = TRUE),
    sd = sd(germdays, na.rm = TRUE),
    se = sd / 2^0.5
  ) %>%
  ggplot(germtime,mapping = aes(x = GT,y=mean, color=picked)) +
  facet_wrap(~ExperimentID) +
  geom_line() + 
  geom_point() +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se),) +
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1)) +
  xlab("") + ylab("Germination date") +labs(title = "Selection of germinated plants")
ggsave("selection_of_germinated_plant_OE.png", plot = last_plot(),width = 6, height =5)

germtime_average <- germtime4 %>% 
  filter(germtime4$Value > 0, germtime4$Trait == "germinationtime", germtime4$GT != "Col-0") %>%
  group_by(Trait, picked) %>%
  summarise(
    mean = mean(germdays, na.rm = TRUE),
    sd = sd(germdays, na.rm = TRUE),
    se = sd / 2^0.5
  )
########


unique(seeds$Trait)

uniqueseeID <- unique(Plant2$SeedID)
seeds2 <- seeds
seeds3 <- seeds


for (val in uniqueseeID) {
  seeds2 <- seeds2 %>% filter(seeds2$SeedID != val)
}
seeds2$picked <- "no"

uniqueseeID2 <- unique(seeds2$SeedID)
for (val in uniqueseeID2) {
  seeds3 <- seeds3 %>% filter(seeds3$SeedID != val)
}
seeds3$picked <- "yes"
seeds4 <- rbind(seeds2, seeds3)

seeds4 %>% 
  filter(seeds4$Value > 0, seeds4$Trait == "germinationtime") %>%
  ggplot(seeds,mapping = aes(x = GT,y=MeasurementDate_das, color=picked)) +
  facet_wrap(~Trait) +
  geom_violin() +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))
labs(
  title = "growth per day OEs all days"
)
seeds4 %>% 
  filter(seeds4$Value > 0, seeds4$Trait == "germinationtime") %>%
  group_by(GT, Trait, picked) %>%
  summarise(
    mean = mean(Value, na.rm = TRUE),
    sd = sd(Value, na.rm = TRUE),
    se = sd / 2^0.5
  ) %>%
  ggplot(seeds,mapping = aes(x = GT,y=mean, color=picked)) +
  facet_wrap(~Trait) +
  geom_line() + 
  geom_point() +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se),) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
  labs(
    title = "Germination time by germinationtime"
)
seeds4 %>% 
  filter(seeds4$Value > 0, seeds4$Trait == "germinationtime") %>%
  group_by(GT, Trait, picked) %>%
  summarise(
    mean = mean(Germination, na.rm = TRUE),
    sd = sd(Germination, na.rm = TRUE),
    se = sd / 2^0.5
  ) %>%
  ggplot(seeds,mapping = aes(x = GT,y=mean, color=picked)) +
  facet_wrap(~Trait) +
  geom_line() + 
  geom_point() +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se),) +
  theme(axis.text.x = element_text(angle = 90, vjust = 0.5, hjust=1))+
  labs(
    title = "Germination time by MeasurementDate_DAS"
  )
seed_average <- seeds4 %>% 
    filter(seeds4$Value > 0, seeds4$Trait == "germinationtime", seeds4$GT != "Col-0") %>%
    group_by(GT, Trait, picked) %>%
    summarise(
      mean = mean(germinationtime, na.rm = TRUE),
      sd = sd(germinationtime, na.rm = TRUE),
      se = sd / 2^0.5
    )
  
#########################
#ok how to actually do it  
germtime <- dat %>% filter(dat$Trait == "germinationtime")
sowtimetime <- dat %>% filter(dat$Trait == "rMean")
germtime2 <- merge(germtime, sowtimetime, by="ShootIDs", all = T)

germtime2$germinationtime <- as.POSIXct(as.numeric(germtime2$Value.x), origin = "1970-01-01", tz = "CET")
germtime2$sowtime <- as.POSIXct(as.numeric(germtime2$MeasurementDate.y), origin = "1970-01-01", tz = "CET")
germtime2$germinationage <- germtime2$germinationtime - germtime2$sowtime

rm(germtime3)
germtime3 <- germtemp
for (val in sort(unique(germtime2$GT.x))) {
  germtemp <- germtime2 %>% filter(germtime2$GT.x == val)
  germtemp <- as.data.frame(germtemp$germinationage)
  colnames(germtemp) <- c(val)
  germtime3 <- cbind.fill(germtime3, germtemp)
}
write.csv(germtime3, 'GerminationtimesGT.csv')
 

######################################################################################################
########################################################################################################
#Loop all traits graphs
#####
uniquetraits

# moet nog Fm etc eruit halen. En dan de Plant4 lijst maken met hun eigen lijts
uniquetraits <- colnames(PlantSize3)
uniquetraits <- uniquetraits[25:43]
uniquetraits <- uniquetraits[-16]
uniquetraits <- uniquetraits[-12]
uniquetraits <- uniquetraits[-10]
uniquetraits <- uniquetraits[-3]
uniquetraits <- uniquetraits[-2]
trait <- "convexHullPerimeter_mm"

PlantSize3.raw <- PlantSize3.raw %>% filter(PlantSize3.raw$ExperimentID == "812")
Plant4 <- Plant4 %>% filter(Plant4$ExperimentID == "812")
Plant4_OE <- Plant4 %>% filter(Plant4$gene == "WT" | Plant4$gene == "OE")
Plant4_Tissue <- Plant4 %>% filter(Plant4$gene == "WT" | Plant4$gene == "Tissue")
Plant4_KO <- Plant4 %>% filter(Plant4$gene == "WT" | Plant4$gene == "KO")
trait <- "plantSurfaceCoverage"
for (trait in uniquetraits){
  savename <- paste("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs_normalized_control/812/", trait, sep = "")
  setwd(savename)
  
  PlantSize3 <- PlantSize3.raw
  if(trait == "hue"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ExperimentID == 812)}
  if(trait == "saturation"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ExperimentID == 812)}
  if(trait == "colorvalue"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ExperimentID == 812)}
  if(trait == "plantSurfaceCoverage"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$plantSurfaceCoverage < 5)}
  PlantSize3_OE <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "OE")
  PlantSize3_Tissue <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "Tissue")
  PlantSize3_KO <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "KO")

########################### OE GT
PlantSize3_OE  %>% 
  filter(MeasurementDate_das > 18, stress == "drought") %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_OE_drought_no_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(MeasurementDate_das > 18, stress == "control") %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_GT_OE_control_no_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(MeasurementDate_das > 18, stress == "drought") %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_GT_OE_drought_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(MeasurementDate_das > 18, stress == "control") %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_GT_OE_control_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

########################### OE Genotype
PlantSize3_OE  %>% 
  filter(MeasurementDate_das > 18, stress == "drought") %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_Genotype_OE_drought_no_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(MeasurementDate_das > 18, stress == "control") %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_Genotype_OE_control_no_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(MeasurementDate_das > 18, stress == "drought") %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_Genotype_OE_drought_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(MeasurementDate_das > 18, stress == "control") %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_Genotype_OE_control_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

########################### tissue GT
PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, stress == "drought") %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_GT_Tissue_drought_no_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, stress == "control") %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_GT_Tissue_control_no_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, stress == "drought") %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_GT_Tissue_drought_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, stress == "control") %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_GT_Tissue_control_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

########################### tissue Genotype
PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, stress == "drought") %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_Genotype_Tissue_drought_no_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 10, height =5)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, stress == "control") %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_Genotype_Tissue_control_no_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 10, height =5)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, stress == "drought") %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_Genotype_Tissue_drought_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 10, height =5)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, stress == "control") %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_Genotype_Tissue_control_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 10, height =5)

PlantSize3_KO  %>% 
  filter(MeasurementDate_das > 18, stress == "drought") %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_Genotype_KO_drought_no_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

PlantSize3_KO  %>% 
  filter(MeasurementDate_das > 18, stress == "control") %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_Genotype_KO_control_no_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

PlantSize3_KO  %>% 
  filter(MeasurementDate_das > 18, stress == "drought") %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_Genotype_KO_drought_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

PlantSize3_KO  %>% 
  filter(MeasurementDate_das > 18, stress == "control") %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_Genotype_KO_control_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

#############################################
PlantSize3_OE  %>% 
  filter(MeasurementDate_das > 18, stress == "drought") %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab(trait) +labs(title = trait)
ggsavename <- paste(trait, "_GT_OE_drought_no_errorbar.png")
ggsave(ggsavename, plot = last_plot(),width = 6, height =5)

titlename <- paste("size vs",trait)
PlantSize3_OE  %>% 
  filter(MeasurementDate_das > 18, stress == "drought") %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
            mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = mean,y=mean2)) +
  facet_wrap(~stress, scales = "free_x")+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("projPlantSurfaceArea_mm2") + ylab(trait) +labs(title = titlename)
ggsavename <- paste(trait, "_vs_plantsize_OE_GT2.png", sep = "")
ggsave(ggsavename, plot = last_plot(),width = 14, height =10)


PlantSize3_OE  %>% 
  filter(MeasurementDate_das > 18) %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
            mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = mean,y=mean2)) +
  facet_wrap(~stress, scales = "free_x")+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("projPlantSurfaceArea_mm2") + ylab(trait) +labs(title = titlename)
ggsavename <- paste(trait, "_vs_plantsize_OE_Genotype.png", sep = "")
ggsave(ggsavename, plot = last_plot(),width = 7, height =5)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18) %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
            mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = mean,y=mean2)) +
  facet_wrap(~stress, scales = "free_x")+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("projPlantSurfaceArea_mm2") + ylab(trait) +labs(title = titlename)
ggsavename <- paste(trait, "_vs_plantsize_Tissue_GT.png", sep = "")
ggsave(ggsavename, plot = last_plot(),width = 7, height =5)


PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18) %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
            mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = mean,y=mean2)) +
  facet_wrap(~stress, scales = "free_x")+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("projPlantSurfaceArea_mm2") + ylab(trait) +labs(title = titlename)
ggsavename <- paste(trait, "_vs_plantsize_Tissue_Genotype.png", sep = "")
ggsave(ggsavename, plot = last_plot(),width = 11, height =5)


PlantSize3_KO  %>% 
  filter(MeasurementDate_das > 18) %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
            mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = mean,y=mean2)) +
  facet_wrap(~stress, scales = "free_x")+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("projPlantSurfaceArea_mm2") + ylab(trait) +labs(title = titlename)
ggsavename <- paste(trait, "_vs_plantsize_KO_Genotype.png", sep = "")
ggsave(ggsavename, plot = last_plot(),width = 7, height =5)

}

#uniquetraits4 <- "darkyield_stddev"
uniquetraits4
uniquetraits4 <- colnames(Plant4)
uniquetraits4 <- uniquetraits4[26:44]
uniquetraits4 <- uniquetraits4[-20]
uniquetraits4 <- uniquetraits4[-19]
uniquetraits4 <- uniquetraits4[-18]
uniquetraits4 <- uniquetraits4[-16]
uniquetraits4 <- uniquetraits4[-15]
uniquetraits4 <- uniquetraits4[-14]
uniquetraits4 <- uniquetraits4[-9]
uniquetraits4 <- uniquetraits4[-5]
uniquetraits4 <- uniquetraits4[-3]
trait <- "Fm"
for (trait in uniquetraits4){
  savename <- paste("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs2/812/", trait, sep = "")
  setwd(savename)
  
  ########################### OE GT
  Plant4_OE  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_OE_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_OE  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_OE_control_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_OE  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_OE_drought_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_OE  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_OE_control_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  ########################### OE Genotype
  Plant4_OE  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_OE_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_OE  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_OE_control_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_OE  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_OE_drought_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_OE  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
      geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_OE_control_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  ########################### tissue GT
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_Tissue_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_Tissue_control_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_Tissue_drought_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
     geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_Tissue_control_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  ########################### tissue Genotype
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_Tissue_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
     geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_Tissue_control_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_Tissue_drought_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
     geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_Tissue_control_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
  Plant4_KO  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,2,2))+
    scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,19,19,1))+
    scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_KO_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_KO  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,2,2))+
    scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,19,19,1))+
    scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_KO_drought_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  #############################################
  Plant4_OE  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_OE_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  titlename <- paste("Fm_Fv vs",trait)
  Plant4_OE  %>% 
    filter(MeasurementDate_das > 18) %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("Fv_Fm") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_Fv_Fm_OE_GT.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 7, height =5)
  
  
  Plant4_OE  %>% 
    filter(MeasurementDate_das > 18) %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("Fv_Fm") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_Fv_Fm_OE_Genotype.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 8, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18) %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("Fv_Fm") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_Fv_Fm_Tissue_GT.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 7, height =5)
  
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18) %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("Fv_Fm") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_Fv_Fm_Tissue_Genotype.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
  
  Plant4_KO  %>% 
    filter(MeasurementDate_das > 18) %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,19,19,1))+
    scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("Fv_Fm") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_Fv_Fm_KO_Genotype.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 7, height =5)
  
  
  
  
  
}

#for the normalized data
for (trait in uniquetraits){
  savename <- paste("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs_normalized_control/812/", trait, sep = "")
  setwd(savename)
  
  PlantSize3 <- PlantSize3.raw
  if(trait == "hue"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ExperimentID == 812)}
  if(trait == "saturation"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ExperimentID == 812)}
  if(trait == "colorvalue"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ExperimentID == 812)}
  if(trait == "plantSurfaceCoverage"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$plantSurfaceCoverage < 5)}
  PlantSize3_OE <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "OE")
  PlantSize3_Tissue <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "Tissue")
  PlantSize3_KO <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "KO")

  #############################################
  titlename <- paste("size vs",trait)
  PlantSize3_OE  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("projPlantSurfaceArea_mm2") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_plantsize_OE_GT.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 7, height =5)
  
  
  PlantSize3_OE  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("projPlantSurfaceArea_mm2") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_plantsize_OE_Genotype.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 7, height =5)
  
  PlantSize3_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("projPlantSurfaceArea_mm2") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_plantsize_Tissue_GT.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 7, height =5)
  
  
  PlantSize3_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("projPlantSurfaceArea_mm2") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_plantsize_Tissue_Genotype.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 11, height =5)
  
  
  PlantSize3_KO  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,19,19,1))+
    scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("projPlantSurfaceArea_mm2") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_plantsize_KO_Genotype.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 7, height =5)
  
  
  
  
  
}

################################################################################################
########################################################################################################
#Loop all traits graphs But only gene2 (tissue lines)
#####

# moet nog Fm etc eruit halen. En dan de Plant4 lijst maken met hun eigen lijts
uniquetraits <- colnames(PlantSize3)
uniquetraits <- uniquetraits[25:43]
uniquetraits <- uniquetraits[-16]
uniquetraits <- uniquetraits[-12]
uniquetraits <- uniquetraits[-10]
uniquetraits <- uniquetraits[-3]
# <- uniquetraits[-2]
#trait <- "Fm"

PlantSize3.raw <- PlantSize3.raw %>% filter(PlantSize3.raw$ExperimentID == "812")
Plant4 <- Plant4 %>% filter(Plant4$ExperimentID == "812")
Plant4_OE <- Plant4 %>% filter(Plant4$gene == "WT" | Plant4$gene == "OE")
Plant4_Tissue <- Plant4 %>% filter(Plant4$gene2 == "WT" | Plant4$gene2 == "Tissue2" | Plant4$gene2 == "Tissue3"| Plant4$GT == "PLC5 OE")
#Plant4_Tissue <- Plant4 %>% filter(Plant4$gene2 == "WT" | Plant4$gene2 == "Tissue2"| Plant4$GT == "PLC5")
Plant4_KO <- Plant4 %>% filter(Plant4$gene == "WT" | Plant4$gene == "KO")
trait <- "convexHullPerimeter_mm"
uniquetraits
for (trait in uniquetraits){
  savename <- paste("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs2/812/", trait, sep = "")
  #savename <- paste("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs_normalized_control/812/", trait, sep = "")
  setwd(savename)
  
  PlantSize3 <- PlantSize3.raw
  if(trait == "hue"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ExperimentID == 812)}
  if(trait == "saturation"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ExperimentID == 812)}
  if(trait == "colorvalue"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ExperimentID == 812)}
  if(trait == "plantSurfaceCoverage"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$plantSurfaceCoverage < 5)}
  PlantSize3_Tissue <- PlantSize3 %>% filter(PlantSize3$gene2 == "WT" | PlantSize3$gene2 == "Tissue2"| PlantSize3$gene2 == "Tissue3"| PlantSize3$GT == "PLC5")
  PlantSize3_Tissue <- PlantSize3 %>% filter(PlantSize3$gene2 == "WT" | PlantSize3$gene2 == "Tissue2"| PlantSize3$GT == "PLC5")
  
  ########################### tissue GT
  PlantSize3_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_Tissue3_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  PlantSize3_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_Tissue3_control_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  PlantSize3_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_Tissue3_drought_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  PlantSize3_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_Tissue3_control_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  ########################### tissue Genotype
  titlename <- paste("size vs",trait)
  PlantSize3_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_Tissue3_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
  PlantSize3_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_Tissue3_control_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
  PlantSize3_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_Tissue3_drought_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
  PlantSize3_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_Tissue3_control_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
   PlantSize3_Tissue  %>% 
    filter(MeasurementDate_das > 18) %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("projPlantSurfaceArea_mm2") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_plantsize_Tissue3_GT.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 7, height =5)
  
  
  PlantSize3_Tissue  %>% 
    filter(MeasurementDate_das > 18) %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("projPlantSurfaceArea_mm2") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_plantsize_Tissue3_Genotype.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 11, height =5)
  
}

#uniquetraits4 <- "darkyield_stddev"
uniquetraits4
uniquetraits4 <- colnames(Plant4)
uniquetraits4 <- uniquetraits4[26:44]
uniquetraits4 <- uniquetraits4[-20]
uniquetraits4 <- uniquetraits4[-19]
uniquetraits4 <- uniquetraits4[-18]
uniquetraits4 <- uniquetraits4[-16]
uniquetraits4 <- uniquetraits4[-15]
uniquetraits4 <- uniquetraits4[-14]
uniquetraits4 <- uniquetraits4[-9]
uniquetraits4 <- uniquetraits4[-5]
uniquetraits4 <- uniquetraits4[-3]
trait <- "Fm"
for (trait in uniquetraits4){
  savename <- paste("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs2/812/", trait, sep = "")
  #savename <- paste("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs_normalized_control/812/", trait, sep = "")
  setwd(savename)
  

  ########################### tissue GT
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_Tissue3_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_Tissue3_control_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_Tissue3_drought_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,2))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_GT_Tissue3_control_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  ########################### tissue Genotype
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_Tissue3_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    heme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_Tissue3_control_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_Tissue3_drought_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a',
                                '#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, "_Genotype_Tissue3_control_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18) %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
    scale_color_manual(values=c('#33a02c','#fb9a99','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#e7298a','#e6ab02','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("Fv_Fm") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_Fv_Fm_Tissue3_GT.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 7, height =5)
  
  
  Plant4_Tissue  %>% 
    filter(MeasurementDate_das > 18) %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5,
              mean2 = mean(get(trait), na.rm = TRUE), sd2 = sd(get(trait), na.rm = TRUE),se2 = sd / 2^0.5) %>% 
    ggplot(mapping = aes(x = mean,y=mean2)) +
    facet_wrap(~stress, scales = "free_x")+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
    scale_color_manual(values=c('#33a02c','#33a02c','#fb9a99','#fb9a99','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#e7298a','#e7298a','#e6ab02','#e6ab02','#000000','#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("Fv_Fm") + ylab(trait) +labs(title = titlename)
  ggsavename <- paste(trait, "_vs_Fv_Fm_Tissue3_Genotype.png", sep = "")
  ggsave(ggsavename, plot = last_plot(),width = 10, height =5)
  
}


#########
###########################################################################################################
#plantPerimeter_mm
#####
setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/plantPerimeter")


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, MeasurementDate_das <47,PlantSize3_OE$plantPerimeter_mm > 0.000001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantPerimeter_mm, na.rm = TRUE), sd = sd(plantPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantPerimeter (mm)") +labs(title = "plantPerimeter_mm")
ggsave("plantPerimeter_mmGT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantPerimeter_mm > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantPerimeter_mm, na.rm = TRUE), sd = sd(plantPerimeter_mm, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantPerimeter (mm)") +labs(title = "plantPerimeter_mm")
ggsave("plantPerimeter_mmGT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantPerimeter_mm > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantPerimeter_mm, na.rm = TRUE), sd = sd(plantPerimeter_mm, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("plantPerimeter_mmGT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantPerimeter_mm > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantPerimeter_mm, na.rm = TRUE), sd = sd(plantPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantPerimeter (mm)") +labs(title = "plantPerimeter_mm")
ggsave("plantPerimeter_mmGT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantPerimeter_mm > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantPerimeter_mm, na.rm = TRUE), sd = sd(plantPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantPerimeter (mm)") +labs(title = "plantPerimeter_mm")
ggsave("plantPerimeter_mmGenotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantPerimeter_mm > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantPerimeter_mm, na.rm = TRUE), sd = sd(plantPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantPerimeter (mm)") +labs(title = "plantPerimeter_mm")
ggsave("plantPerimeter_mmGenotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantPerimeter_mm > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantPerimeter_mm, na.rm = TRUE), sd = sd(plantPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantPerimeter (mm)") +labs(title = "plantPerimeter_mm")
ggsave("plantPerimeter_mmGenotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantPerimeter_mm > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantPerimeter_mm, na.rm = TRUE), sd = sd(plantPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantPerimeter (mm)") +labs(title = "plantPerimeter_mm")
ggsave("plantPerimeter_mmGenotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18, GTDAS !=	"E28 45",  PlantSize3_Tissue$plantPerimeter_mm > 0.0001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantPerimeter_mm, na.rm = TRUE), sd = sd(plantPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantPerimeter (mm)") +labs(title = "plantPerimeter_mm")
ggsave("plantPerimeter_mmGenotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, GTDAS !=	"E28 45",)%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantPerimeter_mm, na.rm = TRUE), sd = sd(plantPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantPerimeter(mm)") +labs(title = "plantPerimeter_mm2")
ggsave("plantPerimeter_mm_GT_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)


PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,  PlantSize3_KO$plantPerimeter_mm > 0.0001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantPerimeter_mm, na.rm = TRUE), sd = sd(plantPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantPerimeter (mm)") +labs(title = "plantPerimeter_mm")
ggsave("plantPerimeter_mmGenotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)





######################################################################################################
###########################################################################################################
#plantConvexHullArea_mm2
#####

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/plantConvexHullArea")


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantConvexHullArea_mm2 > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantConvexHullArea_mm2, na.rm = TRUE), sd = sd(plantConvexHullArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantConvexHullArea (mm2)") +labs(title = "plantConvexHullArea")
ggsave("plantConvexHullArea_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantConvexHullArea_mm2 > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantConvexHullArea_mm2, na.rm = TRUE), sd = sd(plantConvexHullArea_mm2, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantConvexHullArea (mm2)") +labs(title = "plantConvexHullArea")
ggsave("plantConvexHullArea_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantConvexHullArea_mm2 > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantConvexHullArea_mm2, na.rm = TRUE), sd = sd(plantConvexHullArea_mm2, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantConvexHullArea (mm2)") +labs(title = "plantConvexHullArea")
ggsave("plantConvexHullArea_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantConvexHullArea_mm2 > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantConvexHullArea_mm2, na.rm = TRUE), sd = sd(plantConvexHullArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantConvexHullArea (mm2)") +labs(title = "plantConvexHullArea")
ggsave("plantConvexHullArea_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantConvexHullArea_mm2 > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantConvexHullArea_mm2, na.rm = TRUE), sd = sd(plantConvexHullArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantConvexHullArea (mm2)") +labs(title = "plantConvexHullArea")
ggsave("plantConvexHullArea_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantConvexHullArea_mm2 > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantConvexHullArea_mm2, na.rm = TRUE), sd = sd(plantConvexHullArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantConvexHullArea (mm2)") +labs(title = "plantConvexHullArea")
ggsave("plantConvexHullArea_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantConvexHullArea_mm2 > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantConvexHullArea_mm2, na.rm = TRUE), sd = sd(plantConvexHullArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantConvexHullArea (mm2)") +labs(title = "plantConvexHullArea")
ggsave("plantConvexHullArea_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantConvexHullArea_mm2 > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantConvexHullArea_mm2, na.rm = TRUE), sd = sd(plantConvexHullArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantConvexHullArea (mm2)") +labs(title = "plantConvexHullArea")
ggsave("plantConvexHullArea_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18, GTDAS !=	"E28 45",  PlantSize3_Tissue$plantConvexHullArea_mm2 > 0.0001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantConvexHullArea_mm2, na.rm = TRUE), sd = sd(plantConvexHullArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantConvexHullArea (mm2)") +labs(title = "plantConvexHullArea")
ggsave("plantConvexHullArea_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, GTDAS !=	"E28 45")%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantConvexHullArea_mm2, na.rm = TRUE), sd = sd(plantConvexHullArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantConvexHullArea_mm2") +labs(title = "plantConvexHullArea_mm2")
ggsave("plantConvexHullArea_GT_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)


PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,  PlantSize3_KO$plantConvexHullArea_mm2 > 0.0001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantConvexHullArea_mm2, na.rm = TRUE), sd = sd(plantConvexHullArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantConvexHullArea (mm2)") +labs(title = "plantConvexHullArea")
ggsave("plantConvexHullArea_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)



######################################################################################################
###########################################################################################################
#plantCompactness
#####


setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/plantCompactness")


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantCompactness >  0.00000001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress, ExperimentID) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~ExperimentID)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantCompactness >  0.00000001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantCompactness >  0.00000001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantCompactness >  0.00000001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantCompactness >  0.00000001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantCompactness >  0.00000001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantCompactness >  0.00000001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantCompactness >  0.00000001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18,  GTDAS !=	"E28 45", PlantSize3_Tissue$plantCompactness >  0.00000001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18,  GTDAS !=	"E28 45")%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_GT_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)


PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,  PlantSize3_KO$plantCompactness >  0.00000001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)

######################################################################################################
###########################################################################################################
#plantStockiness
#####

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/plantStockiness")


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantStockiness >  0.00000001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantStockiness, na.rm = TRUE), sd = sd(plantStockiness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantStockiness") +labs(title = "plantStockiness")
ggsave("plantStockiness_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantStockiness >  0.00000001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantStockiness, na.rm = TRUE), sd = sd(plantStockiness, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantStockiness") +labs(title = "plantStockiness")
ggsave("plantStockiness_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantStockiness >  0.00000001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantStockiness, na.rm = TRUE), sd = sd(plantStockiness, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantStockiness") +labs(title = "plantStockiness")
ggsave("plantStockiness_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantStockiness >  0.00000001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantStockiness, na.rm = TRUE), sd = sd(plantStockiness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantStockiness") +labs(title = "plantStockiness")
ggsave("plantStockiness_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantStockiness >  0.00000001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantStockiness, na.rm = TRUE), sd = sd(plantStockiness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantStockiness") +labs(title = "plantStockiness")
ggsave("plantStockiness_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantStockiness >  0.00000001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantStockiness, na.rm = TRUE), sd = sd(plantStockiness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantStockiness") +labs(title = "plantStockiness")
ggsave("plantStockiness_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantStockiness >  0.00000001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantStockiness, na.rm = TRUE), sd = sd(plantStockiness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantStockiness") +labs(title = "plantStockiness")
ggsave("plantStockiness_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantStockiness >  0.00000001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantStockiness, na.rm = TRUE), sd = sd(plantStockiness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantStockiness") +labs(title = "plantStockiness")
ggsave("plantStockiness_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18,   GTDAS !=	"E28 45", PlantSize3_Tissue$plantStockiness >  0.00000001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantStockiness, na.rm = TRUE), sd = sd(plantStockiness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantStockiness") +labs(title = "plantStockiness")
ggsave("plantStockiness_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18,  GTDAS !=	"E28 45",  PlantSize3_Tissue$plantStockiness >  0.00000001)%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantStockiness, na.rm = TRUE), sd = sd(plantStockiness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantStockiness") +labs(title = "plantStockiness")
ggsave("plantStockiness_GT_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)


PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,  PlantSize3_KO$plantStockiness >  0.00000001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantStockiness, na.rm = TRUE), sd = sd(plantStockiness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantStockiness") +labs(title = "plantStockiness")
ggsave("plantStockiness_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)



######################################################################################################
###########################################################################################################
#plantAreaByCircumference
#####

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/plantAreaByCircumference")


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAreaByCircumference, na.rm = TRUE), sd = sd(plantAreaByCircumference, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAreaByCircumference") +labs(title = "plantAreaByCircumference")
ggsave("plantAreaByCircumference_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAreaByCircumference, na.rm = TRUE), sd = sd(plantAreaByCircumference, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAreaByCircumference") +labs(title = "plantAreaByCircumference")
ggsave("plantAreaByCircumference_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, PlantSize3_OE$plantAreaByCircumference < 2500000000, PlantSize3_OE$plantAreaByCircumference > 0.1, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAreaByCircumference, na.rm = TRUE), sd = sd(plantAreaByCircumference, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAreaByCircumference") +labs(title = "plantAreaByCircumference")
ggsave("plantAreaByCircumference_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAreaByCircumference > 0.01, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAreaByCircumference, na.rm = TRUE), sd = sd(plantAreaByCircumference, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAreaByCircumference") +labs(title = "plantAreaByCircumference")
ggsave("plantAreaByCircumference_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, PlantSize3_OE$plantAreaByCircumference < 2500000000, PlantSize3_OE$plantAreaByCircumference > 0.1, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAreaByCircumference, na.rm = TRUE), sd = sd(plantAreaByCircumference, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAreaByCircumference") +labs(title = "plantAreaByCircumference")
ggsave("plantAreaByCircumference_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAreaByCircumference > 0.01, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAreaByCircumference, na.rm = TRUE), sd = sd(plantAreaByCircumference, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAreaByCircumference") +labs(title = "plantAreaByCircumference")
ggsave("plantAreaByCircumference_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,PlantSize3_OE$plantAreaByCircumference < 2500000000, PlantSize3_OE$plantAreaByCircumference > 0.1, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAreaByCircumference, na.rm = TRUE), sd = sd(plantAreaByCircumference, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAreaByCircumference") +labs(title = "plantAreaByCircumference")
ggsave("plantAreaByCircumference_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, PlantSize3_OE$plantAreaByCircumference < 2500000000, PlantSize3_OE$plantAreaByCircumference > 0.1, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAreaByCircumference, na.rm = TRUE), sd = sd(plantAreaByCircumference, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAreaByCircumference") +labs(title = "plantAreaByCircumference")
ggsave("plantAreaByCircumference_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18, GTDAS !=	"E28 45",  PlantSize3_Tissue$plantAreaByCircumference < 2500000000,PlantSize3_Tissue$plantAreaByCircumference > 0.1)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAreaByCircumference, na.rm = TRUE), sd = sd(plantAreaByCircumference, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAreaByCircumference") +labs(title = "plantAreaByCircumference")
ggsave("plantAreaByCircumference_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, GTDAS !=	"E28 45", plantAreaByCircumference > 0.01 )%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantAreaByCircumference, na.rm = TRUE), sd = sd(plantAreaByCircumference, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAreaByCircumference") +labs(title = "plantAreaByCircumference")
ggsave("plantAreaByCircumference_GT_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,  PlantSize3_KO$plantAreaByCircumference > 0.01)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAreaByCircumference, na.rm = TRUE), sd = sd(plantAreaByCircumference, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAreaByCircumference") +labs(title = "plantAreaByCircumference")
ggsave("plantAreaByCircumference_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)


######################################################################################################
###########################################################################################################
#convexHullPerimeter_mm
#####

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/convexHullPerimeter")


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, PlantSize3_OE$convexHullPerimeter_mm > 0.01, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(convexHullPerimeter_mm, na.rm = TRUE), sd = sd(convexHullPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("convexHullPerimeter (mm)") +labs(title = "convexHullPerimeter")
ggsave("convexHullPerimeter_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$convexHullPerimeter_mm > 0.01, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(convexHullPerimeter_mm, na.rm = TRUE), sd = sd(convexHullPerimeter_mm, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("convexHullPerimeter (mm)") +labs(title = "convexHullPerimeter")
ggsave("convexHullPerimeter_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, PlantSize3_OE$convexHullPerimeter_mm < 250, PlantSize3_OE$convexHullPerimeter_mm > 0.01, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(convexHullPerimeter_mm, na.rm = TRUE), sd = sd(convexHullPerimeter_mm, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("convexHullPerimeter (mm)") +labs(title = "convexHullPerimeter")
ggsave("convexHullPerimeter_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$convexHullPerimeter_mm > 0.01, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(convexHullPerimeter_mm, na.rm = TRUE), sd = sd(convexHullPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("convexHullPerimeter (mm)") +labs(title = "convexHullPerimeter")
ggsave("convexHullPerimeter_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, PlantSize3_OE$convexHullPerimeter_mm < 250, PlantSize3_OE$convexHullPerimeter_mm > 0.01, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(convexHullPerimeter_mm, na.rm = TRUE), sd = sd(convexHullPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("convexHullPerimeter (mm)") +labs(title = "convexHullPerimeter")
ggsave("convexHullPerimeter_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$convexHullPerimeter_mm > 0.01, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(convexHullPerimeter_mm, na.rm = TRUE), sd = sd(convexHullPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("convexHullPerimeter (mm)") +labs(title = "convexHullPerimeter")
ggsave("convexHullPerimeter_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$convexHullPerimeter_mm > 0.01, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(convexHullPerimeter_mm, na.rm = TRUE), sd = sd(convexHullPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("convexHullPerimeter (mm)") +labs(title = "convexHullPerimeter")
ggsave("convexHullPerimeter_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$convexHullPerimeter_mm > 0.01, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(convexHullPerimeter_mm, na.rm = TRUE), sd = sd(convexHullPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("convexHullPerimeter (mm)") +labs(title = "convexHullPerimeter")
ggsave("convexHullPerimeter_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18,  PlantSize3_Tissue$convexHullPerimeter_mm > 0.1,  PlantSize3_Tissue$convexHullPerimeter_mm < 250)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(convexHullPerimeter_mm, na.rm = TRUE), sd = sd(convexHullPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("convexHullPerimeter (mm)") +labs(title = "convexHullPerimeter")
ggsave("convexHullPerimeter_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18,  PlantSize3_Tissue$convexHullPerimeter_mm > 0.1,  PlantSize3_Tissue$convexHullPerimeter_mm < 250)%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(convexHullPerimeter_mm, na.rm = TRUE), sd = sd(convexHullPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("convexHullPerimeter_mm") +labs(title = "convexHullPerimeter")
ggsave("convexHullPerimeter_mm_GT_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)


PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,  PlantSize3_KO$convexHullPerimeter_mm > 0.01)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(convexHullPerimeter_mm, na.rm = TRUE), sd = sd(convexHullPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("convexHullPerimeter (mm)") +labs(title = "convexHullPerimeter")
ggsave("convexHullPerimeter_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)



######################################################################################################
###########################################################################################################
#plantSurfaceCoverage
#####

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/plantSurfaceCoverage")

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,PlantSize3_OE$plantSurfaceCoverage < 2,  PlantSize3_OE$stress == "drought", GT == "PLC5")%>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=plantSurfaceCoverage)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantSurfaceCoverage") +labs(title = "plantSurfaceCoverage")
ggsave("plantSurfaceCoverage_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantSurfaceCoverage < 5,  PlantSize3_OE$plantSurfaceCoverage > 0.05, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantSurfaceCoverage, na.rm = TRUE), sd = sd(plantSurfaceCoverage, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantSurfaceCoverage") +labs(title = "plantSurfaceCoverage")
ggsave("plantSurfaceCoverage_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

Plant_PLC7 <- PlantSize3_OE %>% filter(GT == "PLC7")
PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantSurfaceCoverage, na.rm = TRUE), sd = sd(plantSurfaceCoverage, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantSurfaceCoverage") +labs(title = "plantSurfaceCoverage")
ggsave("plantSurfaceCoverage_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantSurfaceCoverage < 5, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantSurfaceCoverage, na.rm = TRUE), sd = sd(plantSurfaceCoverage, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantSurfaceCoverage") +labs(title = "plantSurfaceCoverage")
ggsave("plantSurfaceCoverage_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantSurfaceCoverage < 5, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantSurfaceCoverage, na.rm = TRUE), sd = sd(plantSurfaceCoverage, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantSurfaceCoverage") +labs(title = "plantSurfaceCoverage")
ggsave("plantSurfaceCoverage_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantSurfaceCoverage < 5, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantSurfaceCoverage, na.rm = TRUE), sd = sd(plantSurfaceCoverage, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantSurfaceCoverage") +labs(title = "plantSurfaceCoverage")
ggsave("plantSurfaceCoverage_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantSurfaceCoverage < 5, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantSurfaceCoverage, na.rm = TRUE), sd = sd(plantSurfaceCoverage, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantSurfaceCoverage") +labs(title = "plantSurfaceCoverage")
ggsave("plantSurfaceCoverage_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantSurfaceCoverage < 5, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantSurfaceCoverage, na.rm = TRUE), sd = sd(plantSurfaceCoverage, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantSurfaceCoverage") +labs(title = "plantSurfaceCoverage")
ggsave("plantSurfaceCoverage_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantSurfaceCoverage < 5, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantSurfaceCoverage, na.rm = TRUE), sd = sd(plantSurfaceCoverage, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantSurfaceCoverage") +labs(title = "plantSurfaceCoverage")
ggsave("plantSurfaceCoverage_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18,  PlantSize3_Tissue$plantSurfaceCoverage < 5)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantSurfaceCoverage, na.rm = TRUE), sd = sd(plantSurfaceCoverage, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantSurfaceCoverage") +labs(title = "plantSurfaceCoverage")
ggsave("plantSurfaceCoverage_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18, PlantSize3_Tissue$plantSurfaceCoverage > 0 ,  PlantSize3_Tissue$plantSurfaceCoverage < 5)%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantSurfaceCoverage, na.rm = TRUE), sd = sd(plantSurfaceCoverage, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantSurfaceCoverage") +labs(title = "plantSurfaceCoverage")
ggsave("plantSurfaceCoverage_GT_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)


PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,  PlantSize3_KO$plantSurfaceCoverage < 5)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantSurfaceCoverage, na.rm = TRUE), sd = sd(plantSurfaceCoverage, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantSurfaceCoverage") +labs(title = "plantSurfaceCoverage")
ggsave("plantSurfaceCoverage_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)
######################################################################################################
###########################################################################################################
#Green
#####

#Points with and without error bars per day
#For OE and Tissue and KO seperate from each other. 
#remove values that are not usefull (bigger than 1)
#
#Ordering the samples in a line is very hard. For specifically the line graphs_normalized_WT better to just rename WT to _WT
#
setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/green")


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageGreen > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAverageGreen, na.rm = TRUE), sd = sd(plantAverageGreen, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB green level") +labs(title = "Green levels")
ggsave("Average_green_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageGreen > 0.000001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAverageGreen, na.rm = TRUE), sd = sd(plantAverageGreen, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB green level") + labs(title = "Green levels")
ggsave("Average_green_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageGreen > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAverageGreen, na.rm = TRUE), sd = sd(plantAverageGreen, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB green level") +  labs(title = "Green levels")
ggsave("Average_green_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageGreen > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAverageGreen, na.rm = TRUE), sd = sd(plantAverageGreen, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB green level") + labs(title = "Green levels")
ggsave("Average_green_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageGreen > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageGreen, na.rm = TRUE), sd = sd(plantAverageGreen, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB green level") +labs(title = "Green levels")
ggsave("Average_green_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageGreen > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageGreen, na.rm = TRUE), sd = sd(plantAverageGreen, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB green level") +labs(title = "Green levels")
ggsave("Average_green_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageGreen > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageGreen, na.rm = TRUE), sd = sd(plantAverageGreen, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB green level") +labs(title = "Green levels")
ggsave("Average_green_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageGreen > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageGreen, na.rm = TRUE), sd = sd(plantAverageGreen, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB green level") +labs(title = "Green levels")
ggsave("Average_green_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18,  PlantSize3_Tissue$plantAverageGreen > 0.0001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageGreen, na.rm = TRUE), sd = sd(plantAverageGreen, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB green level") +labs(title = "Green levels")
ggsave("Average_green_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18 )%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)


PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,  PlantSize3_KO$plantAverageGreen > 0.0001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageGreen, na.rm = TRUE), sd = sd(plantAverageGreen, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB green level") +labs(title = "Green levels")
ggsave("Average_green_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)

######################################################################################################
###########################################################################################################
#Redness
#####

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/red")


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageRed > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAverageRed, na.rm = TRUE), sd = sd(plantAverageRed, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB red level") +labs(title = "Red levels")
ggsave("Average_red_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageRed > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAverageRed, na.rm = TRUE), sd = sd(plantAverageRed, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB red level") +labs(title = "Red levels")
ggsave("Average_red_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageRed > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAverageRed, na.rm = TRUE), sd = sd(plantAverageRed, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB red level") +labs(title = "Red levels")
ggsave("Average_red_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageRed > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAverageRed, na.rm = TRUE), sd = sd(plantAverageRed, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB red level") +labs(title = "Red levels")
ggsave("Average_red_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageRed > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageRed, na.rm = TRUE), sd = sd(plantAverageRed, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB red level") +labs(title = "Red levels")
ggsave("Average_red_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageRed > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageRed, na.rm = TRUE), sd = sd(plantAverageRed, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB red level") +labs(title = "Red levels")
ggsave("Average_red_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageRed > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageRed, na.rm = TRUE), sd = sd(plantAverageRed, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB red level") +labs(title = "Red levels")
ggsave("Average_red_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageRed > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageRed, na.rm = TRUE), sd = sd(plantAverageRed, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB red level") +labs(title = "Red levels")
ggsave("Average_red_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18,  PlantSize3_Tissue$plantAverageRed > 0.0001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageRed, na.rm = TRUE), sd = sd(plantAverageRed, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB red level") +labs(title = "Red levels")
ggsave("Average_red_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18 )%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)


PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,  PlantSize3_KO$plantAverageRed > 0.0001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageRed, na.rm = TRUE), sd = sd(plantAverageRed, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB red level") +labs(title = "Red levels")
ggsave("Average_red_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)

######################################################################################################
###########################################################################################################
#Blueness
#####

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/blue")


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageBlue > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAverageBlue, na.rm = TRUE), sd = sd(plantAverageBlue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB blue level") +labs(title = "Blue levels")
ggsave("Average_blue_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageBlue > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAverageBlue, na.rm = TRUE), sd = sd(plantAverageBlue, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB blue level") + labs(title = "Blue levels")
ggsave("Average_blue_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageBlue > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAverageBlue, na.rm = TRUE), sd = sd(plantAverageBlue, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("Average_blue_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageBlue > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(plantAverageBlue, na.rm = TRUE), sd = sd(plantAverageBlue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB blue level") + labs(title = "Blue levels")
ggsave("Average_blue_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageBlue > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageBlue, na.rm = TRUE), sd = sd(plantAverageBlue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB blue level") +labs(title = "Blue levels")
ggsave("Average_blue_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageBlue > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageBlue, na.rm = TRUE), sd = sd(plantAverageBlue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB blue level") +labs(title = "Blue levels")
ggsave("Average_blue_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageBlue > 0.0001, PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageBlue, na.rm = TRUE), sd = sd(plantAverageBlue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB blue level") +labs(title = "Blue levels")
ggsave("Average_blue_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantAverageBlue > 0.0001, PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageBlue, na.rm = TRUE), sd = sd(plantAverageBlue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB blue level") +labs(title = "Blue levels")
ggsave("Average_blue_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18,  PlantSize3_Tissue$plantAverageBlue > 0.00001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageBlue, na.rm = TRUE), sd = sd(plantAverageBlue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB blue level") +labs(title = "Blue levels")
ggsave("Average_blue_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18 )%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)


PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,  PlantSize3_KO$plantAverageBlue > 0.000001)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(plantAverageBlue, na.rm = TRUE), sd = sd(plantAverageBlue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("RGB blue level") +labs(title = "Blue levels")
ggsave("Average_blue_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)



######################################################################################################
###########################################################################################################
#Hue
#####

#the 812 and 790 experiments have quite different RGB values, so butter to just do them seperate..

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/Hue")

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(hue, na.rm = TRUE), sd = sd(hue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Hue") +labs(title = "Hue")
ggsave("hue_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(hue, na.rm = TRUE), sd = sd(hue, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Hue") + labs(title = "Hue")
ggsave("hue_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(hue, na.rm = TRUE), sd = sd(hue, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Hue") + labs(title = "Hue")
ggsave("hue_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(hue, na.rm = TRUE), sd = sd(hue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Hue") + labs(title = "Hue")
ggsave("hue_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(hue, na.rm = TRUE), sd = sd(hue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Hue") +labs(title = "Hue")
ggsave("hue_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(hue, na.rm = TRUE), sd = sd(hue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Hue") +labs(title = "Hue")
ggsave("hue_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(hue, na.rm = TRUE), sd = sd(hue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Hue") +labs(title = "Hue")
ggsave("hue_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(hue, na.rm = TRUE), sd = sd(hue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Hue") +labs(title = "Hue")
ggsave("hue_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18, ExperimentID == "812")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(hue, na.rm = TRUE), sd = sd(hue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Hue") +labs(title = "Hue")
ggsave("hue_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18, ExperimentID == "812")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(hue, na.rm = TRUE), sd = sd(hue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Hue") +labs(title = "Hue")
ggsave("hue_Genotype_Tissue_errorbar.png", plot = last_plot(),width = 16, height =8)


PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18, ExperimentID == "812")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(hue, na.rm = TRUE), sd = sd(hue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Hue") +labs(title = "Hue")
ggsave("hue_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)

PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18, ExperimentID == "812")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(hue, na.rm = TRUE), sd = sd(hue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Hue") +labs(title = "Hue")
ggsave("hue_Genotype_KO_control_errorbar.png", plot = last_plot(),width = 7, height =5)



######################################################################################################
###########################################################################################################
#saturation
#####

#the 812 and 790 experiments have quite different RGB values, so butter to just do them seperate..

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/saturation")

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(saturation, na.rm = TRUE), sd = sd(saturation, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("saturation") +labs(title = "saturation")
ggsave("saturation_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(saturation, na.rm = TRUE), sd = sd(saturation, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("saturation") + labs(title = "saturation")
ggsave("saturation_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(saturation, na.rm = TRUE), sd = sd(saturation, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("saturation") + labs(title = "saturation")
ggsave("saturation_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(saturation, na.rm = TRUE), sd = sd(saturation, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("saturation") + labs(title = "saturation")
ggsave("saturation_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(saturation, na.rm = TRUE), sd = sd(saturation, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("saturation") +labs(title = "saturation")
ggsave("saturation_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(saturation, na.rm = TRUE), sd = sd(saturation, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("saturation") +labs(title = "saturation")
ggsave("saturation_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(saturation, na.rm = TRUE), sd = sd(saturation, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("saturation") +labs(title = "saturation")
ggsave("saturation_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(saturation, na.rm = TRUE), sd = sd(saturation, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("saturation") +labs(title = "saturation")
ggsave("saturation_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18, ExperimentID == "812")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(saturation, na.rm = TRUE), sd = sd(saturation, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("saturation") +labs(title = "saturation")
ggsave("saturation_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18, ExperimentID == "812")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(saturation, na.rm = TRUE), sd = sd(saturation, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("saturation") +labs(title = "saturation")
ggsave("saturation_Genotype_Tissue_errorbar.png", plot = last_plot(),width = 16, height =8)


PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18, ExperimentID == "812")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(saturation, na.rm = TRUE), sd = sd(saturation, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("saturation") +labs(title = "saturation")
ggsave("saturation_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)

PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18, ExperimentID == "812")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(saturation, na.rm = TRUE), sd = sd(saturation, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("saturation") +labs(title = "saturation")
ggsave("saturation_Genotype_KO_control_errorbar.png", plot = last_plot(),width = 7, height =5)



######################################################################################################
###########################################################################################################
#colorvalue
#####

#the 812 and 790 experiments have quite different RGB values, so butter to just do them seperate..

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/colorvalue")

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(colorvalue, na.rm = TRUE), sd = sd(colorvalue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("colorvalue") +labs(title = "colorvalue")
ggsave("colorvalue_GT_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(colorvalue, na.rm = TRUE), sd = sd(colorvalue, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("colorvalue") + labs(title = "colorvalue")
ggsave("colorvalue_GT_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(colorvalue, na.rm = TRUE), sd = sd(colorvalue, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("colorvalue") + labs(title = "colorvalue")
ggsave("colorvalue_GT_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(colorvalue, na.rm = TRUE), sd = sd(colorvalue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("colorvalue") + labs(title = "colorvalue")
ggsave("colorvalue_GT_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)



PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(colorvalue, na.rm = TRUE), sd = sd(colorvalue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("colorvalue") +labs(title = "colorvalue")
ggsave("colorvalue_Genotype_OE_drought_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(colorvalue, na.rm = TRUE), sd = sd(colorvalue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("colorvalue") +labs(title = "colorvalue")
ggsave("colorvalue_Genotype_OE_control_no_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(colorvalue, na.rm = TRUE), sd = sd(colorvalue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("colorvalue") +labs(title = "colorvalue")
ggsave("colorvalue_Genotype_OE_drought_errorbar.png", plot = last_plot(),width = 6, height =5)

PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18, ExperimentID == "812", PlantSize3_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(colorvalue, na.rm = TRUE), sd = sd(colorvalue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("colorvalue") +labs(title = "colorvalue")
ggsave("colorvalue_Genotype_OE_control_errorbar.png", plot = last_plot(),width = 6, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18, ExperimentID == "812")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(colorvalue, na.rm = TRUE), sd = sd(colorvalue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("colorvalue") +labs(title = "colorvalue")
ggsave("colorvalue_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18, ExperimentID == "812")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(colorvalue, na.rm = TRUE), sd = sd(colorvalue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("colorvalue") +labs(title = "colorvalue")
ggsave("colorvalue_Genotype_Tissue_errorbar.png", plot = last_plot(),width = 16, height =8)


PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18, ExperimentID == "812")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(colorvalue, na.rm = TRUE), sd = sd(colorvalue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("colorvalue") +labs(title = "colorvalue")
ggsave("colorvalue_Genotype_KO_control_no_errorbar.png", plot = last_plot(),width = 7, height =5)

PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18, ExperimentID == "812")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(colorvalue, na.rm = TRUE), sd = sd(colorvalue, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("colorvalue") +labs(title = "colorvalue")
ggsave("colorvalue_Genotype_KO_control_errorbar.png", plot = last_plot(),width = 7, height =5)



######################################################################################################


###########################################################################################################
#Grootte tegen andere variabelen uitzetten
#####


setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/plantSurfaceCoverage")


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantSurfaceCoverage < 15) %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
            mean2 = mean(plantSurfaceCoverage, na.rm = TRUE), sd2 = sd(plantSurfaceCoverage, na.rm = TRUE),se2 = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = mean,y=mean2)) +
  facet_wrap(~stress, scales = "free_x")+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("projPlantSurfaceArea_mm2") + ylab("plantSurfaceCoverage") +labs(title = "size vs convexhull")
ggsave("plantSurfaceCoverage_vs_plantsize_OE_GT.png", plot = last_plot(),width = 7, height =5)


PlantSize3_OE  %>% 
  filter(PlantSize3_OE$MeasurementDate_das > 18,  PlantSize3_OE$plantSurfaceCoverage < 15)%>%
  group_by(MeasurementDate_das,gene, GT,Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
            mean2 = mean(plantSurfaceCoverage, na.rm = TRUE), sd2 = sd(plantSurfaceCoverage, na.rm = TRUE),se2 = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = mean,y=mean2)) +
  facet_wrap(~stress, scales = "free_x")+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("projPlantSurfaceArea_mm2") + ylab("plantSurfaceCoverage") +labs(title = "size vs convexhull")
ggsave("plantSurfaceCoverage_vs_plantsize_OE_Genotype.png", plot = last_plot(),width = 9, height =5)

PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18,  PlantSize3_Tissue$plantSurfaceCoverage < 15)%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
            mean2 = mean(plantSurfaceCoverage, na.rm = TRUE), sd2 = sd(plantSurfaceCoverage, na.rm = TRUE),se2 = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = mean,y=mean2)) +
  facet_wrap(~stress, scales = "free_x")+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("projPlantSurfaceArea_mm2") + ylab("plantSurfaceCoverage") +labs(title = "size vs convexhull")
ggsave("plantSurfaceCoverage_vs_plantsize_Tissue_GT.png", plot = last_plot(),width = 7, height =5)


PlantSize3_Tissue  %>% 
  filter(PlantSize3_Tissue$MeasurementDate_das > 18,  PlantSize3_Tissue$plantSurfaceCoverage < 15)%>%
  group_by(MeasurementDate_das,gene, GT,Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
            mean2 = mean(plantSurfaceCoverage, na.rm = TRUE), sd2 = sd(plantSurfaceCoverage, na.rm = TRUE),se2 = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = mean,y=mean2)) +
  facet_wrap(~stress, scales = "free_x")+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("projPlantSurfaceArea_mm2") + ylab("plantSurfaceCoverage") +labs(title = "size vs convexhull")
ggsave("plantSurfaceCoverage_vs_plantsize_Tissue_Genotype.png", plot = last_plot(),width = 11, height =5)

PlantSize3_KO  %>% 
  filter(PlantSize3_KO$MeasurementDate_das > 18,  PlantSize3_KO$plantSurfaceCoverage < 15)%>%
  group_by(MeasurementDate_das,gene, GT,Genotype,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5,
            mean2 = mean(plantSurfaceCoverage, na.rm = TRUE), sd2 = sd(plantSurfaceCoverage, na.rm = TRUE),se2 = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = mean,y=mean2)) +
  facet_wrap(~stress, scales = "free_x")+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("projPlantSurfaceArea_mm2") + ylab("plantSurfaceCoverage") +labs(title = "size vs convexhull")
ggsave("plantSurfaceCoverage_vs_plantsize_KO_GT.png", plot = last_plot(),width = 7, height =5)




######################################################################################################
###########################################################################################################
#probeersel
#####

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/F_muh")


Plant4_OE$MeasurementDate <- as.POSIXct(as.numeric(Plant4_OE$MeasurementDate), origin = "1970-01-01", tz = "CET")

Plant4_OE$time <- format(Plant4_OE$MeasurementDate, '%H:%M:%S')


Plant4_OEA <- Plant4_OE %>% filter(Plant4_OE$Fv_Fm > 0.780) 
Plant4_OEA$HL <- "High"
Plant4_OEB <- Plant4_OE %>% filter(Plant4_OE$Fv_Fm < 0.780) 
Plant4_OEB$HL <- "Low"
Plant4_OEAB <- rbind(Plant4_OEA, Plant4_OEB)
Plant4_OEAB$MeasurementDate <- Plant4_OEAB$MeasurementDate
Plant4_KO  %>%
  filter(ExperimentID == "790", GT == "PLC5-1 KO") %>%
  ggplot(mapping = aes(x = MeasurementDate, y=Fv_Fm, color=Device)) +
  geom_point() +
  facet_wrap(~MeasurementDate_das, scales = "free") +
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+ 
  xlab("MeasurementDate") + ylab("Fv_Fm") +labs(title = "Fv_Fm_1st_exp")
 ggsave("Fv_Fm_1st_exp_device.png", plot = last_plot(),width = 10, height =8)

#F0 - yes correlated
#Fm - yes correlated
#plantsize - not correlated
#experimentID - not correlated
#stockiness - sort of correlated?
#surfaceCoverage kinda related 
#midyieldFluorescenceMeasurement - highly corrected
# 


###########################################################################################################
#Fm/fV
#####






setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/Fm_Fv")


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_GT_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_OE$ExperimentID
Plant4_OE  %>% 
  filter(ExperimentID == "812")%>%
  ggplot(mapping = aes(x = MeasurementDate,y=Fv_Fm, color= Device)) +
  geom_point()+
  facet_wrap(~MeasurementDate_das, scales = "free")+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv_control")
ggsave("Fm_Fv_violinplot_GT_OE_control_.png", plot = last_plot(),width = 8.5, height =7)


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_GT_OE_control_no_errorbar_.png", plot = last_plot(),width = 6, height =5)



Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_GT_OE_drought_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_GT_OE_control_errorbar_.png", plot = last_plot(),width = 6, height =5)



Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_OE_control_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_OE_drought_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_OE_control_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_Tissue  %>% 
  filter(Plant4_Tissue$MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_Tissue_no_errorbar_.png", plot = last_plot(),width = 16, height =8)

Plant4_Tissue  %>% 
  filter(MeasurementDate_das > 18 )%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)


Plant4_KO  %>% 
  filter(Plant4_KO$MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_KO_control_no_errorbar_.png", plot = last_plot(),width = 7, height =5)


###########################################################################################################
#Fm/fV normalized to devices.
#####


Plant4_growscreen3 <- Plant4 %>% filter(Plant4$Device == "Growscreen Fluoro 3")
Plant4_growscreen3_mean <- mean(Plant4_growscreen3$Fv_Fm,  na.rm = TRUE) 
Plant4_growscreen4 <- Plant4 %>% filter(Plant4$Device == "Growscreen Fluoro 4")
Plant4_growscreen4_mean <- mean(Plant4_growscreen4$Fv_Fm,  na.rm = TRUE) 
ratio_Fv_Fm <- Plant4_growscreen3_mean /Plant4_growscreen4_mean
Plant4_growscreen4$Fv_Fm <- Plant4_growscreen4$Fv_Fm * ratio_Fv_Fm
Plant5 <- rbind(Plant4_growscreen3,Plant4_growscreen4)

Plant5_OE <- Plant5 %>% filter(Plant5$gene == "WT" | Plant5$gene == "OE")
Plant5_Tissue <- Plant5 %>% filter(Plant5$gene == "WT" | Plant5$gene == "Tissue")
Plant5_KO <- Plant5 %>% filter(Plant5$gene == "WT" | Plant5$gene == "KO")

uniquedays <- unique(Plant4$MeasurementDate_das)
Plant5_2 <- Plant4 %>% filter(Plant4$Device == 7)
for (x in uniquedays) {
  Plant4_day <- Plant4 %>% filter(MeasurementDate_das == x)
  Plant4_growscreen3 <- Plant4_day %>% filter(Plant4_day$Device == "Growscreen Fluoro 3")
  Plant4_growscreen3_mean <- mean(Plant4_growscreen3$Fv_Fm,  na.rm = TRUE) 
  Plant4_growscreen4 <- Plant4_day %>% filter(Plant4_day$Device == "Growscreen Fluoro 4")
  Plant4_growscreen4_mean <- mean(Plant4_growscreen4$Fv_Fm,  na.rm = TRUE) 
  ratio_Fv_Fm <- Plant4_growscreen3_mean /Plant4_growscreen4_mean
  Plant4_growscreen4$Fv_Fm <- Plant4_growscreen4$Fv_Fm * ratio_Fv_Fm
  Plant5_2_temp <- rbind(Plant4_growscreen3,Plant4_growscreen4)
  Plant5_2 <- rbind(Plant5_2,Plant5_2_temp)
}

Plant5_2_OE <- Plant5_2 %>% filter(Plant5_2$gene == "WT" | Plant5_2$gene == "OE")
Plant5_2_Tissue <- Plant5_2 %>% filter(Plant5_2$gene == "WT" | Plant5_2$gene == "Tissue")
Plant5_2_KO <- Plant5_2 %>% filter(Plant5_2$gene == "WT" | Plant5_2$gene == "KO")

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/Fm_Fv/normalized_device/")

Plant5_OE  %>% 
  filter(Plant5_OE$MeasurementDate_das > 18,   Plant5_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_GT_OE_drought_no_errorba.png", plot = last_plot(),width = 6, height =5)



Plant5_OE  %>% 
  filter(Plant5_OE$stress == "control",Plant5_OE$Fv_Fm < 0.9,Plant5_OE$Fv_Fm > 0.62, MeasurementDate_das == 28)%>%
  ggplot(mapping = aes(x = GT,y=Fv_Fm)) +
  geom_violin()+
  geom_point()+
  facet_wrap(~MeasurementDate_das)+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv_control")
ggsave("Fm_Fv_violinplot_GT_OE_control_.png", plot = last_plot(),width = 8.5, height =7)


Plant5_OE  %>% 
  filter(Plant5_OE$MeasurementDate_das > 18,   Plant5_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_GT_OE_control_no_errorba.png", plot = last_plot(),width = 6, height =5)



Plant5_OE  %>% 
  filter(Plant5_OE$MeasurementDate_das > 18,   Plant5_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_GT_OE_drought_errorba.png", plot = last_plot(),width = 6, height =5)


Plant5_OE  %>% 
  filter(Plant5_OE$MeasurementDate_das > 18,   Plant5_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_GT_OE_control_errorba.png", plot = last_plot(),width = 6, height =5)



Plant5_OE  %>% 
  filter(Plant5_OE$MeasurementDate_das > 18,   Plant5_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_OE_drought_no_errorba.png", plot = last_plot(),width = 6, height =5)

Plant5_OE  %>% 
  filter(Plant5_OE$MeasurementDate_das > 18,   Plant5_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_OE_control_no_errorba.png", plot = last_plot(),width = 6, height =5)

Plant5_OE  %>% 
  filter(Plant5_OE$MeasurementDate_das > 18,   Plant5_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_OE_drought_errorba.png", plot = last_plot(),width = 6, height =5)

Plant5_OE  %>% 
  filter(Plant5_OE$MeasurementDate_das > 18,   Plant5_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_OE_control_errorba.png", plot = last_plot(),width = 6, height =5)


Plant5_Tissue  %>% 
  filter(Plant5_Tissue$MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_Tissue_no_errorba.png", plot = last_plot(),width = 16, height =8)

Plant5_KO  %>% 
  filter(Plant5_KO$MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_KO_control_no_errorba.png", plot = last_plot(),width = 7, height =5)



setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/Fm_Fv/normalized_device_day/")

Plant5_2_OE  %>% 
  filter(Plant5_2_OE$MeasurementDate_das > 18,   Plant5_2_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_GT_OE_drought_no_errorba.png", plot = last_plot(),width = 6, height =5)



Plant5_2_OE  %>% 
  filter(Plant5_2_OE$stress == "control",Plant5_2_OE$Fv_Fm < 0.9,Plant5_2_OE$Fv_Fm > 0.62, MeasurementDate_das == 28)%>%
  ggplot(mapping = aes(x = GT,y=Fv_Fm)) +
  geom_violin()+
  geom_point()+
  facet_wrap(~MeasurementDate_das)+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv_control")
ggsave("Fm_Fv_violinplot_GT_OE_control_.png", plot = last_plot(),width = 8.5, height =7)


Plant5_2_OE  %>% 
  filter(Plant5_2_OE$MeasurementDate_das > 18,   Plant5_2_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_GT_OE_control_no_errorba.png", plot = last_plot(),width = 6, height =5)



Plant5_2_OE  %>% 
  filter(Plant5_2_OE$MeasurementDate_das > 18,   Plant5_2_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_GT_OE_drought_errorba.png", plot = last_plot(),width = 6, height =5)


Plant5_2_OE  %>% 
  filter(Plant5_2_OE$MeasurementDate_das > 18,   Plant5_2_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_GT_OE_control_errorba.png", plot = last_plot(),width = 6, height =5)



Plant5_2_OE  %>% 
  filter(Plant5_2_OE$MeasurementDate_das > 18,   Plant5_2_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_OE_drought_no_errorba.png", plot = last_plot(),width = 6, height =5)

Plant5_2_OE  %>% 
  filter(Plant5_2_OE$MeasurementDate_das > 18,   Plant5_2_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_OE_control_no_errorba.png", plot = last_plot(),width = 6, height =5)

Plant5_2_OE  %>% 
  filter(Plant5_2_OE$MeasurementDate_das > 18,   Plant5_2_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_OE_drought_errorba.png", plot = last_plot(),width = 6, height =5)

Plant5_2_OE  %>% 
  filter(Plant5_2_OE$MeasurementDate_das > 18,   Plant5_2_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_OE_control_errorba.png", plot = last_plot(),width = 6, height =5)


Plant5_2_Tissue  %>% 
  filter(Plant5_2_Tissue$MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_Tissue_no_errorba.png", plot = last_plot(),width = 16, height =8)

Plant5_2_KO  %>% 
  filter(Plant5_2_KO$MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fv_Fm, na.rm = TRUE), sd = sd(Fv_Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm_Fv") +labs(title = "Fm_Fv")
ggsave("Fm_Fv_Genotype_KO_control_no_errorba.png", plot = last_plot(),width = 7, height =5)


######################################################################################################
###########################################################################################################
#f0
#####

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/F0")


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(F0, na.rm = TRUE), sd = sd(F0, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("F0") +labs(title = "F0")
ggsave("F0_GT_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$stress == "drought",Plant4_OE$F0 > 10)%>%
  ggplot(mapping = aes(x = GT, y=F0)) +
  geom_violin()+
  facet_wrap(~MeasurementDate_das) +
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("F0") +labs(title = "F0_drought")
ggsave("F0_violinplot_GT_OE_drought_.png", plot = last_plot(),width = 8.5, height =7)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(F0, na.rm = TRUE), sd = sd(F0, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("F0") +labs(title = "F0")
ggsave("F0_GT_OE_control_no_errorbar_.png", plot = last_plot(),width = 6, height =5)



Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(F0, na.rm = TRUE), sd = sd(F0, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("F0") +labs(title = "F0")
ggsave("F0_GT_OE_drought_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(F0, na.rm = TRUE), sd = sd(F0, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("F0") +labs(title = "F0")
ggsave("F0_GT_OE_control_errorbar_.png", plot = last_plot(),width = 6, height =5)



Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(F0, na.rm = TRUE), sd = sd(F0, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("F0") +labs(title = "F0")
ggsave("F0_Genotype_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(F0, na.rm = TRUE), sd = sd(F0, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("F0") +labs(title = "F0")
ggsave("F0_Genotype_OE_control_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(F0, na.rm = TRUE), sd = sd(F0, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("F0") +labs(title = "F0")
ggsave("F0_Genotype_OE_drought_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(F0, na.rm = TRUE), sd = sd(F0, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("F0") +labs(title = "F0")
ggsave("F0_Genotype_OE_control_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_Tissue  %>% 
  filter(Plant4_Tissue$MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(F0, na.rm = TRUE), sd = sd(F0, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("F0") +labs(title = "F0")
ggsave("F0_Genotype_Tissue_no_errorbar_.png", plot = last_plot(),width = 16, height =8)

Plant4_Tissue  %>% 
  filter(MeasurementDate_das > 18 )%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

Plant4_KO  %>% 
  filter(Plant4_KO$MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(F0, na.rm = TRUE), sd = sd(F0, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("F0") +labs(title = "F0")
ggsave("F0_Genotype_KO_control_no_errorbar_.png", plot = last_plot(),width = 7, height =5)
######################################################################################################
###########################################################################################################
#Fm
#####

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/Fm")


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fm, na.rm = TRUE), sd = sd(Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm") +labs(title = "Fm")
ggsave("Fm_GT_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$stress == "control",Plant4_OE$Fm > 80)%>%
  ggplot(mapping = aes(x = GT, y=Fm)) +
  geom_violin()+
  facet_wrap(~MeasurementDate_das) +
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm") +labs(title = "Fm_control")
ggsave("Fm_violinplot_GT_OE_control_.png", plot = last_plot(),width = 8.5, height =7)


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fm, na.rm = TRUE), sd = sd(Fm, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm") +labs(title = "Fm")
ggsave("Fm_GT_OE_control_no_errorbar_.png", plot = last_plot(),width = 6, height =5)



Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fm, na.rm = TRUE), sd = sd(Fm, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm") +labs(title = "Fm")
ggsave("Fm_GT_OE_drought_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(Fm, na.rm = TRUE), sd = sd(Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm") +labs(title = "Fm")
ggsave("Fm_GT_OE_control_errorbar_.png", plot = last_plot(),width = 6, height =5)



Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fm, na.rm = TRUE), sd = sd(Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm") +labs(title = "Fm")
ggsave("Fm_Genotype_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fm, na.rm = TRUE), sd = sd(Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm") +labs(title = "Fm")
ggsave("Fm_Genotype_OE_control_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fm, na.rm = TRUE), sd = sd(Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm") +labs(title = "Fm")
ggsave("Fm_Genotype_OE_drought_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fm, na.rm = TRUE), sd = sd(Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm") +labs(title = "Fm")
ggsave("Fm_Genotype_OE_control_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_Tissue  %>% 
  filter(Plant4_Tissue$MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fm, na.rm = TRUE), sd = sd(Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm") +labs(title = "Fm")
ggsave("Fm_Genotype_Tissue_no_errorbar_.png", plot = last_plot(),width = 16, height =8)

Plant4_Tissue  %>% 
  filter(MeasurementDate_das > 18 )%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

Plant4_KO  %>% 
  filter(Plant4_KO$MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(Fm, na.rm = TRUE), sd = sd(Fm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("Fm") +labs(title = "Fm")
ggsave("Fm_Genotype_KO_control_no_errorbar_.png", plot = last_plot(),width = 7, height =5)

######################################################################################################
###########################################################################################################
#averageLeafDiameter
#####


setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/averageLeafDiameter")

Plant4_OE$averageLeafDiameter <- as.numeric(Plant4_OE$averageLeafDiameter)


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18, Plant4_OE$averageLeafDiameter != "Inf",Plant4_OE$averageLeafDiameter != "NaN",Plant4_OE$averageLeafDiameter != "NaN",Plant4_OE$averageLeafDiameter != "NaN",Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(averageLeafDiameter, na.rm = TRUE), sd = sd(averageLeafDiameter, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("averageLeafDiameter") +labs(title = "averageLeafDiameter")
ggsave("averageLeafDiameter_GT_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$averageLeafDiameter != "Inf",Plant4_OE$averageLeafDiameter != "NaN", Plant4_OE$stress == "control") %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(averageLeafDiameter, na.rm = TRUE), sd = sd(averageLeafDiameter, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("averageLeafDiameter") +labs(title = "averageLeafDiameter")
ggsave("averageLeafDiameter_GT_OE_control_no_errorbar_.png", plot = last_plot(),width = 6, height =5)



Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$averageLeafDiameter != "Inf",Plant4_OE$averageLeafDiameter != "NaN", Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(averageLeafDiameter, na.rm = TRUE), sd = sd(averageLeafDiameter, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("averageLeafDiameter") +labs(title = "averageLeafDiameter")
ggsave("averageLeafDiameter_GT_OE_drought_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$averageLeafDiameter != "Inf",Plant4_OE$averageLeafDiameter != "NaN", Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(averageLeafDiameter, na.rm = TRUE), sd = sd(averageLeafDiameter, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("averageLeafDiameter") +labs(title = "averageLeafDiameter")
ggsave("averageLeafDiameter_GT_OE_control_errorbar_.png", plot = last_plot(),width = 6, height =5)



Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$averageLeafDiameter != "Inf",Plant4_OE$averageLeafDiameter != "NaN", Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(averageLeafDiameter, na.rm = TRUE), sd = sd(averageLeafDiameter, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("averageLeafDiameter") +labs(title = "averageLeafDiameter")
ggsave("averageLeafDiameter_Genotype_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$averageLeafDiameter != "Inf",Plant4_OE$averageLeafDiameter != "NaN", Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(averageLeafDiameter, na.rm = TRUE), sd = sd(averageLeafDiameter, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("averageLeafDiameter") +labs(title = "averageLeafDiameter")
ggsave("averageLeafDiameter_Genotype_OE_control_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$averageLeafDiameter != "Inf",Plant4_OE$averageLeafDiameter != "NaN", Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(averageLeafDiameter, na.rm = TRUE), sd = sd(averageLeafDiameter, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("averageLeafDiameter") +labs(title = "averageLeafDiameter")
ggsave("averageLeafDiameter_Genotype_OE_drought_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$averageLeafDiameter != "Inf",Plant4_OE$averageLeafDiameter != "NaN", Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(averageLeafDiameter, na.rm = TRUE), sd = sd(averageLeafDiameter, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("averageLeafDiameter") +labs(title = "averageLeafDiameter")
ggsave("averageLeafDiameter_Genotype_OE_control_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_Tissue  %>% 
  filter(Plant4_Tissue$MeasurementDate_das > 18,   Plant4_Tissue$averageLeafDiameter != "Inf",Plant4_OE$averageLeafDiameter != "NaN", Plant4_Tissue$averageLeafDiameter > 1)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(averageLeafDiameter, na.rm = TRUE), sd = sd(averageLeafDiameter, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("averageLeafDiameter") +labs(title = "averageLeafDiameter")
ggsave("averageLeafDiameter_Genotype_Tissue_no_errorbar_.png", plot = last_plot(),width = 16, height =8)

Plant4_Tissue  %>% 
  filter(MeasurementDate_das > 18 )%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

Plant4_KO  %>% 
  filter(Plant4_KO$MeasurementDate_das > 18,   Plant4_KO$averageLeafDiameter != "Inf",Plant4_OE$averageLeafDiameter != "NaN", Plant4_KO$averageLeafDiameter > 1)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(averageLeafDiameter, na.rm = TRUE), sd = sd(averageLeafDiameter, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("averageLeafDiameter") +labs(title = "averageLeafDiameter")
ggsave("averageLeafDiameter_Genotype_KO_control_no_errorbar_.png", plot = last_plot(),width = 7, height =5)

######################################################################################################
###########################################################################################################
#numberOfLeafs
#####

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/numberOfLeafs")

Plant4_leaf <- Plant4  %>% filter(Plant4$numberOfLeafs > 0 , Plant4$numberOfLeafs < 40)
Plant4_OE <- Plant4_leaf %>% filter(Plant4_leaf$gene == "WT" | Plant4_leaf$gene == "OE")
Plant4_Tissue <- Plant4_leaf %>% filter(Plant4_leaf$gene == "WT" | Plant4_leaf$gene == "Tissue")
Plant4_KO <- Plant4_leaf %>% filter(Plant4_leaf$gene == "WT" | Plant4_leaf$gene == "KO")

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(numberOfLeafs, na.rm = TRUE), sd = sd(numberOfLeafs, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("numberOfLeafs") +labs(title = "numberOfLeafs")
ggsave("numberOfLeafs_GT_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(numberOfLeafs, na.rm = TRUE), sd = sd(numberOfLeafs, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("numberOfLeafs") +labs(title = "numberOfLeafs")
ggsave("numberOfLeafs_GT_OE_control_no_errorbar_.png", plot = last_plot(),width = 6, height =5)



Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(numberOfLeafs, na.rm = TRUE), sd = sd(numberOfLeafs, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("numberOfLeafs") +labs(title = "numberOfLeafs")
ggsave("numberOfLeafs_GT_OE_drought_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(numberOfLeafs, na.rm = TRUE), sd = sd(numberOfLeafs, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("numberOfLeafs") +labs(title = "numberOfLeafs")
ggsave("numberOfLeafs_GT_OE_control_errorbar_.png", plot = last_plot(),width = 6, height =5)



Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(numberOfLeafs, na.rm = TRUE), sd = sd(numberOfLeafs, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("numberOfLeafs") +labs(title = "numberOfLeafs")
ggsave("numberOfLeafs_Genotype_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(numberOfLeafs, na.rm = TRUE), sd = sd(numberOfLeafs, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("numberOfLeafs") +labs(title = "numberOfLeafs")
ggsave("numberOfLeafs_Genotype_OE_control_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(numberOfLeafs, na.rm = TRUE), sd = sd(numberOfLeafs, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("numberOfLeafs") +labs(title = "numberOfLeafs")
ggsave("numberOfLeafs_Genotype_OE_drought_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(numberOfLeafs, na.rm = TRUE), sd = sd(numberOfLeafs, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("numberOfLeafs") +labs(title = "numberOfLeafs")
ggsave("numberOfLeafs_Genotype_OE_control_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_Tissue  %>% 
  filter(Plant4_Tissue$MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(numberOfLeafs, na.rm = TRUE), sd = sd(numberOfLeafs, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("numberOfLeafs") +labs(title = "numberOfLeafs")
ggsave("numberOfLeafs_Genotype_Tissue_no_errorbar_.png", plot = last_plot(),width = 16, height =8)

Plant4_Tissue  %>% 
  filter(MeasurementDate_das > 18 )%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

Plant4_KO  %>% 
  filter(Plant4_KO$MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(numberOfLeafs, na.rm = TRUE), sd = sd(numberOfLeafs, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("numberOfLeafs") +labs(title = "numberOfLeafs")
ggsave("numberOfLeafs_Genotype_KO_control_no_errorbar_.png", plot = last_plot(),width = 7, height =5)


######################################################################################################
###########################################################################################################
#rotationalSymmetry
#####

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/rotationalSymmetry")

Plant4_OE <- Plant4 %>% filter(Plant4$gene == "WT" | Plant4$gene == "OE")
Plant4_Tissue <- Plant4 %>% filter(Plant4$gene == "WT" | Plant4$gene == "Tissue")
Plant4_KO <- Plant4 %>% filter(Plant4$gene == "WT" | Plant4$gene == "KO")

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$stress == "drought") %>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(rotationalSymmetry, na.rm = TRUE), sd = sd(rotationalSymmetry, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("rotationalSymmetry") +labs(title = "rotationalSymmetry")
ggsave("rotationalSymmetry_GT_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$rotationalSymmetry != "Inf", Plant4_OE$rotationalSymmetry < 100, Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(rotationalSymmetry, na.rm = TRUE), sd = sd(rotationalSymmetry, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("rotationalSymmetry") +labs(title = "rotationalSymmetry")
ggsave("rotationalSymmetry_GT_OE_control_no_errorbar_.png", plot = last_plot(),width = 6, height =5)



Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$rotationalSymmetry != "Inf", Plant4_OE$rotationalSymmetry < 100, Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(rotationalSymmetry, na.rm = TRUE), sd = sd(rotationalSymmetry, na.rm = TRUE), se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("rotationalSymmetry") +labs(title = "rotationalSymmetry")
ggsave("rotationalSymmetry_GT_OE_drought_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$rotationalSymmetry != "Inf", Plant4_OE$rotationalSymmetry < 100, Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, GT,stress) %>%
  summarise(mean = mean(rotationalSymmetry, na.rm = TRUE), sd = sd(rotationalSymmetry, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19))+
  scale_color_manual(values=c('#1b9e77','#d95f02','#7570b3','#e7298a','#66a61e','#e6ab02','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2))+
  theme_bw() +  theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("rotationalSymmetry") +labs(title = "rotationalSymmetry")
ggsave("rotationalSymmetry_GT_OE_control_errorbar_.png", plot = last_plot(),width = 6, height =5)



Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$rotationalSymmetry != "Inf", Plant4_OE$rotationalSymmetry < 100, Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(rotationalSymmetry, na.rm = TRUE), sd = sd(rotationalSymmetry, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("rotationalSymmetry") +labs(title = "rotationalSymmetry")
ggsave("rotationalSymmetry_Genotype_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$rotationalSymmetry != "Inf", Plant4_OE$rotationalSymmetry < 100, Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(rotationalSymmetry, na.rm = TRUE), sd = sd(rotationalSymmetry, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("rotationalSymmetry") +labs(title = "rotationalSymmetry")
ggsave("rotationalSymmetry_Genotype_OE_control_no_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$rotationalSymmetry != "Inf", Plant4_OE$rotationalSymmetry < 100, Plant4_OE$stress == "drought")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(rotationalSymmetry, na.rm = TRUE), sd = sd(rotationalSymmetry, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("rotationalSymmetry") +labs(title = "rotationalSymmetry")
ggsave("rotationalSymmetry_Genotype_OE_drought_errorbar_.png", plot = last_plot(),width = 6, height =5)

Plant4_OE  %>% 
  filter(Plant4_OE$MeasurementDate_das > 18,   Plant4_OE$rotationalSymmetry != "Inf", Plant4_OE$rotationalSymmetry < 100, Plant4_OE$stress == "control")%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(rotationalSymmetry, na.rm = TRUE), sd = sd(rotationalSymmetry, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=Genotype)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#1b9e77','#1b9e77','#d95f02','#d95f02','#7570b3','#7570b3','#e7298a','#e7298a','#66a61e','#66a61e','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("rotationalSymmetry") +labs(title = "rotationalSymmetry")
ggsave("rotationalSymmetry_Genotype_OE_control_errorbar_.png", plot = last_plot(),width = 6, height =5)


Plant4_Tissue  %>% 
  filter(Plant4_Tissue$MeasurementDate_das > 18,   Plant4_Tissue$rotationalSymmetry != "Inf", Plant4_Tissue$rotationalSymmetry < 0.2)%>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(rotationalSymmetry, na.rm = TRUE), sd = sd(rotationalSymmetry, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("rotationalSymmetry") +labs(title = "rotationalSymmetry")
ggsave("rotationalSymmetry_Genotype_Tissue_no_errorbar_.png", plot = last_plot(),width = 16, height =8)

Plant4_Tissue  %>% 
  filter(MeasurementDate_das > 18 )%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantCompactness, na.rm = TRUE), sd = sd(plantCompactness, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantCompactness") +labs(title = "plantCompactness")
ggsave("plantCompactness_Genotype_Tissue_no_errorbar.png", plot = last_plot(),width = 16, height =8)

Plant4_KO  %>% 
  filter(Plant4_KO$MeasurementDate_das > 18 , Plant4_KO$rotationalSymmetry != "Inf", Plant4_KO$rotationalSymmetry < 100) %>%
  group_by(MeasurementDate_das,gene, Genotype,stress) %>%
  summarise(mean = mean(rotationalSymmetry, na.rm = TRUE), sd = sd(rotationalSymmetry, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
  facet_wrap(~stress)+
  scale_linetype_manual(values=c(1,1,2,2))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
  scale_shape_manual(values=c(19,19,19,1))+
  scale_color_manual(values=c('#1b9e77','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("rotationalSymmetry") +labs(title = "rotationalSymmetry")
ggsave("rotationalSymmetry_Genotype_KO_control_no_errorbar_.png", plot = last_plot(),width = 7, height =5)


######################################################################################################
###########################################################################################################
#Statistics per GT and all together
###########################################################################################################

#loop over traits
#loop over days
#Loop over GT
library("writexl")
library("openxlsx")


setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs_normalized_control/812/statistics")
Plant9 <- Plant8
Plant9 <- Plant9 %>% filter(Trait != "averageLeafDiameter",Trait != "compactness",Trait != "imageEdgePercentage"
                            ,Trait != "maxLeafDiameter",Trait != "numberOfLeafs",Trait != "rotationalSymmetry")

Plant9 <- Plant9 %>% filter(Plant9$stress == "drought")
Plant9 <- Plant9 %>% filter(Plant9$Trait != "plantMinimumSizeThreshold")
Plant9 <- Plant9 %>% filter(Plant9$ExperimentID == "812")
#Plant9 <- Plant9 %>% filter(Plant9$Device == "Growscreen Fluoro 4")
uniquetraits <- sort(unique(Plant9$Trait))
compare_template2 <- data.frame(GT  = c("blub"), P = c(1))
compare_template2 <- compare_template2 %>%  rename("P-value" = P) 
compare_template <- compare_template2 %>% filter(compare_template2$GT == "hippo")


for (x in uniquetraits){
  planttrait <- Plant9 %>% filter(Plant9$Trait == x)
  planttrait <- planttrait %>% filter(planttrait$Value > 0)
  savename <- paste("TUKEYTest_Pvalue_", x, "_drought_normalized",".xlsx", sep = "")
  Temp_trait <- as.data.frame(unique(planttrait$GT))
  names(Temp_trait)[names(Temp_trait) == "unique(planttrait$GT)"] <- "GT"
  uniquedays <- sort(unique(planttrait$MeasurementDate_das))
  uniquestress <- sort(unique(planttrait$stress))
    for (y in uniquedays){
    dayname <- paste("day_", y, sep="")  
    planttraitday <- planttrait %>% filter(planttrait$MeasurementDate_das == y)
    #anova
    tryCatch({results.aov <- aov(Value ~ GT, data = planttraitday)}, error=function(e){})
    #do Tukey test
    tryCatch({TUKEY <- TukeyHSD(x=results.aov, conf.level=0.95)}, error=function(e){})
    #get Tukey results into a dataframe. 
    tryCatch({df <- as.data.frame(TUKEY[["GT"]])}, error=function(e){})
    tryCatch({df2 <- cbind(as.data.frame(rownames(df)),df)}, error=function(e){})
    if(length(df2$diff) == 0) {df2<-data.frame("rownames(df)"=character(0),"diff"=numeric(0),"lwr"=numeric(0),"upr"=numeric(0),"p adj"=numeric(0))}
    
    compare <- compare_template
    uniqueGT <- unique(planttraitday$GT)
    uniqueGT <- sort(uniqueGT)
     for (z in uniqueGT){
       comparrison <- paste("WT-",z, sep = "")
       Temp_compare <- as.data.frame(z)
       Temp_compare$GT <- z
       Temp_compare$z <- NULL
       tryCatch({Te <- df2 %>% filter(df2$`rownames(df)` == comparrison) }, error=function(e){})
       if(length(Te$`p adj`) == 0) {Temp_compare$`P-value` <- 7654} else {Temp_compare$`P-value` <- Te$`p adj`}
       compare <- bind_rows(compare, Temp_compare)
     }
    names(compare)[names(compare) == "P-value"] <- dayname
    Temp_trait <- merge(Temp_trait, compare, all = TRUE)
    }
    
  Temp_trait2 <- Temp_trait
  row.names(Temp_trait2) <- Temp_trait2$GT
  Temp_trait2$GT <- NULL
  Temp_trait2 <- as.data.frame(t(as.matrix(Temp_trait2)))
  Temp_trait2 <- Temp_trait2 %>% filter(Temp_trait2$WT > 0.0001)
  openxlsx::write.xlsx(Temp_trait2,savename, row.names = TRUE)
   
}


#For all PLC's grouped together.
Plant9 <- Plant8
sigtraits <- as.data.frame(c("day_0","day_18","day_21","day_23","day_24","day_25","day_28","day_29","day_30","day_31","day_32","day_35","day_36","day_37","day_38","day_42","day_43","day_44","day_45"))
colnames(sigtraits) <- c("days")
sigtraits_OE <- sigtraits
sigtraits_KO <- sigtraits
sigtraits_Tissue1 <- sigtraits
sigtraits_Tissue2 <- sigtraits

Plant9 <- Plant9 %>% filter(Trait != "averageLeafDiameter",Trait != "compactness",Trait != "imageEdgePercentage",Trait != "maxLeafDiameter",Trait != "numberOfLeafs",Trait != "rotationalSymmetry")
Plant9 <- Plant9 %>% filter(Plant9$stress == "drought")
Plant9 <- Plant9 %>% filter(Plant9$Trait != "plantMinimumSizeThreshold")
Plant9 <- Plant9 %>% filter(Plant9$ExperimentID == "812")
#Plant9 <- Plant9 %>% filter(Plant9$Device == "Growscreen Fluoro 4")

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs_normalized_control/812/statistics/grouped")
uniquedays <- sort(unique(Plant9$MeasurementDate_das))
uniquetraits <- sort(unique(Plant9$Trait))

compare_template <- data.frame(gene = c(2),"P-value" = c(3))
colnames(compare_template) <- c("days","P-value")
compare_template <- compare_template %>% filter(compare_template$days == "lemur")

x <- "convexHullPerimeter_mm"
y <- 28
for (x in uniquetraits){
  planttrait <- Plant9 %>% filter(Plant9$Trait == x)
  planttrait <- planttrait %>% filter(planttrait$Value > 0)
  savename <- paste("TUKEYTest_Pvalue_grouped_", x, "_drought_normalized",".xlsx", sep = "")
  Temp_trait <- as.data.frame(unique(planttrait$gene2))
  names(Temp_trait)[names(Temp_trait) == "unique(planttrait$gene2)"] <- "gene2"
  uniquedays <- sort(unique(planttrait$MeasurementDate_das))
  uniquestress <- sort(unique(planttrait$stress))
  for (y in uniquedays){
    dayname <- paste("day_", y, sep="")  
    planttraitday <- planttrait %>% filter(planttrait$MeasurementDate_das == y)
    #anova
    tryCatch({results.aov <- aov(Value ~ gene2, data = planttraitday)}, error=function(e){})
    #do Tukey test
    tryCatch({TUKEY <- TukeyHSD(x=results.aov, conf.level=0.95)}, error=function(e){})
    #get Tukey results into a dataframe. 
    tryCatch({df <- as.data.frame(TUKEY[["gene2"]])}, error=function(e){})
    tryCatch({df2 <- cbind(as.data.frame(rownames(df)),df)}, error=function(e){})
    if(length(df2$diff) == 0) {df2<-data.frame("rownames(df)"=character(0),"diff"=numeric(0),"lwr"=numeric(0),"upr"=numeric(0),"p adj"=numeric(0))}
    #compare_template <- Temp_compare %>% filter(Temp_compare$gene2 == "roomba")
    
    compare <- compare_template
    uniquegene2 <- unique(planttraitday$gene2)
    uniquegene2 <- sort(uniquegene2)
    for (z in uniquegene2){
      comparrison <- paste("WT-",z, sep = "")
      Temp_compare <- as.data.frame(z)
      Temp_compare$gene2 <- z
      Temp_compare$z <- NULL
      tryCatch({Te <- df2 %>% filter(df2$`rownames(df)` == comparrison) }, error=function(e){})
      if(length(Te$`p adj`) == 0) {Temp_compare$`P-value` <- 7654} else {Temp_compare$`P-value` <- Te$`p adj`}
      compare <- bind_rows(compare, Temp_compare)
    }
    names(compare)[names(compare) == "P-value"] <- dayname
    Temp_trait <- merge(Temp_trait, compare, all = TRUE)
  }
  
  Temp_trait2 <- Temp_trait
  row.names(Temp_trait2) <- Temp_trait2$gene2
  Temp_trait2$gene2 <- NULL
  Temp_trait2 <- as.data.frame(t(as.matrix(Temp_trait2)))
  Temp_trait2 <- Temp_trait2 %>% filter(Temp_trait2$WT > 0.0001)
  #openxlsx::write.xlsx(Temp_trait2,savename, row.names = TRUE)
  
  Temp_trait3 <- Temp_trait2
  Temp_trait32 <- tibble::rownames_to_column(Temp_trait3, "days")
  
  Temp_trait4 <- subset(Temp_trait32, select = c(days))
  Temp_trait5 <- subset(Temp_trait32, select = c(days))  
  Temp_trait6 <- subset(Temp_trait32, select = c(days))
  tryCatch({Temp_trait4 <- subset(Temp_trait32, select = c(days, OE))}, error=function(e){})
  tryCatch({Temp_trait5 <- subset(Temp_trait32, select = c(days, Tissue1)) }, error=function(e){})
  tryCatch({Temp_trait52 <- subset(Temp_trait32, select = c(days, Tissue2)) }, error=function(e){})
  tryCatch({Temp_trait6 <- subset(Temp_trait32, select = c(days, KO))}, error=function(e){})
  colnames(Temp_trait4) <- c("days", x)
  colnames(Temp_trait5) <- c("days", x)
  colnames(Temp_trait52) <- c("days", x)
  colnames(Temp_trait6) <- c("days", x)
  sigtraits_OE <- merge(sigtraits_OE, Temp_trait4, by="days", all = T)
  sigtraits_Tissue1 <- merge(sigtraits_Tissue1, Temp_trait5, by="days", all = T)
  sigtraits_Tissue2 <- merge(sigtraits_Tissue2, Temp_trait52, by="days", all = T)
  sigtraits_KO <- merge(sigtraits_KO, Temp_trait6, by="days", all = T)
}
openxlsx::write.xlsx(sigtraits_OE,"TUKEYTest_PvalueTraits_OE_drought_normalized.xlsx", row.names = TRUE)
openxlsx::write.xlsx(sigtraits_Tissue1,"TUKEYTest_PvalueTraits_Tissue1_drought_normalized.xlsx", row.names = TRUE)
openxlsx::write.xlsx(sigtraits_Tissue2,"TUKEYTest_PvalueTraits_Tissue2_drought_normalized.xlsx", row.names = TRUE)
openxlsx::write.xlsx(sigtraits_KO,"TUKEYTest_PvalueTraits_KO_drought_normalized.xlsx", row.names = TRUE)

#or (x in uniquetraits){
#  planttrait <- Plant9 %>% filter(Plant9$Trait == x)
#  planttrait_mean <- mean(planttrait$Value)
#  print(x)
#  print(planttrait_mean)
#}

  


##########################################################################################################
#Statistics per genotype
###########################################################################################################

#loop over traits
#loop over days
#Loop over genetopye
setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs2/statistics/genotype")
Plant9 <- Plant8
Plant9 <- Plant9 %>% filter(Plant9$ExperimentID == "812")
Plant10 <- Plant9 
Plant10$Genotype <- ifelse(grepl("WT",Plant10$Genotype),'WT',Plant10$Genotype)

Plant10 <- Plant10 %>% filter(Trait != "averageLeafDiameter",Trait != "compactness",Trait != "imageEdgePercentage",Trait != "maxLeafDiameter",Trait != "numberOfLeafs",Trait != "rotationalSymmetry")

Plant10 <- Plant10 %>% filter(Plant10$stress == "control")
Plant10 <- Plant10 %>% filter(Plant10$Trait != "plantMinimumSizeThreshold")
#Plant10 <- Plant10 %>% filter(Plant10$Device == "Growscreen Fluoro 4")
uniquetraits <- sort(unique(Plant10$Trait))
for (x in uniquetraits){
  planttrait <- Plant10 %>% filter(Plant10$Trait == x)
  planttrait <- planttrait %>% filter(planttrait$Value > 0)
  savename <- paste("TUKEYTest_Pvalue_", x, "_control",".xlsx", sep = "")
  Temp_trait <- as.data.frame(unique(planttrait$Genotype))
  names(Temp_trait)[names(Temp_trait) == "unique(planttrait$Genotype)"] <- "Genotype"
  uniquedays <- sort(unique(planttrait$MeasurementDate_das))
  uniquestress <- sort(unique(planttrait$stress))
  for (y in uniquedays){
    dayname <- paste("day_", y, sep="")  
    planttraitday <- planttrait %>% filter(planttrait$MeasurementDate_das == y)
    #anova
    tryCatch({results.aov <- aov(Value ~ Genotype, data = planttraitday)}, error=function(e){})
    #do Tukey test
    tryCatch({TUKEY <- TukeyHSD(x=results.aov, conf.level=0.95)}, error=function(e){})
    #get Tukey results into a dataframe. 
    tryCatch({df <- as.data.frame(TUKEY[["Genotype"]])}, error=function(e){})
    tryCatch({df2 <- cbind(as.data.frame(rownames(df)),df)}, error=function(e){})
    if(length(df2$diff) == 0) {df2<-data.frame("rownames(df)"=character(0),"diff"=numeric(0),"lwr"=numeric(0),"upr"=numeric(0),"p adj"=numeric(0))}
    
    compare <- compare_template
    uniqueGenotype <- unique(planttraitday$Genotype)
    uniqueGenotype <- sort(uniqueGenotype)
    for (z in uniqueGenotype){
      comparrison <- paste("WT-",z, sep = "")
      Temp_compare <- as.data.frame(z)
      Temp_compare$Genotype <- z
      Temp_compare$z <- NULL
      tryCatch({Te <- df2 %>% filter(df2$`rownames(df)` == comparrison) }, error=function(e){})
      if(length(Te$`p adj`) == 0) {Temp_compare$`P-value` <- 7654} else {Temp_compare$`P-value` <- Te$`p adj`}
      compare <- bind_rows(compare, Temp_compare)
    }
    names(compare)[names(compare) == "P-value"] <- dayname
    Temp_trait <- merge(Temp_trait, compare, all = TRUE)
  }
  
  Temp_trait2 <- Temp_trait
  row.names(Temp_trait2) <- Temp_trait2$Genotype
  Temp_trait2$Genotype <- NULL
  Temp_trait2 <- as.data.frame(t(as.matrix(Temp_trait2)))
  Temp_trait2 <- Temp_trait2 %>% filter(Temp_trait2$WT > 0.0001)
  openxlsx::write.xlsx(Temp_trait2,savename, row.names = TRUE)
  
}



###########################################################################################################

######
#see if the devices are significant different.
######
Plant9 <- Plant8
sigtraits <- as.data.frame(c("day_0","day_18","day_21","day_23","day_24","day_25","day_28","day_29","day_30","day_31","day_32","day_35","day_36","day_37","day_38","day_42","day_43","day_44","day_45"))
colnames(sigtraits) <- c("days")
sigtraits_all <- sigtraits

#Plant9 <- Plant9 %>% filter(Plant9$stress == "control")
Plant9 <- Plant9 %>% filter(Plant9$Trait != "plantMinimumSizeThreshold")
#Plant9 <- Plant9 %>% filter(Plant9$Device == "Growscreen Fluoro 4")
Plant10 <- Plant9 %>% filter(Plant9$MeasurementDate_das > 1)

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs/statistics/grouped")
uniquedays <- sort(unique(Plant10$MeasurementDate_das))
uniquetraits <- sort(unique(Plant10$Trait))

compare_template <- data.frame(device = c(2),"P-value" = c(3))
colnames(compare_template) <- c("days","P-value")
compare_template <- compare_template %>% filter(compare_template$days == "lemur")


for (x in uniquetraits){
  planttrait <- Plant10 %>% filter(Plant10$Trait == x)
  uniquedays <- sort(unique(planttrait$MeasurementDate_das))
  planttrait <- planttrait %>% filter(planttrait$Value > 0)
  savename <- paste("TUKEYTest_Pvalue_grouped_", x, "_both",".xlsx", sep = "")
  compare <- compare_template
  colnames(compare) <- c("days", x)
  compare$days <- as.character(compare$days)
  uniquedays <- sort(unique(planttrait$MeasurementDate_das))
  uniquestress <- sort(unique(planttrait$stress))
  for (y in uniquedays){
    dayname <- paste("day_", y, sep="")  
    rm(Te)
    planttraitday <- planttrait %>% filter(planttrait$MeasurementDate_das == y)
    #anova
    tryCatch({results.aov <- aov(Value ~ Device, data = planttraitday)}, error=function(e){})
    #do Tukey test
    tryCatch({TUKEY <- TukeyHSD(x=results.aov, conf.level=0.95)}, error=function(e){})
    #get Tukey results into a dataframe. 
    tryCatch({df <- as.data.frame(TUKEY[["Device"]])}, error=function(e){})
    tryCatch({df2 <- cbind(as.data.frame(rownames(df)),df)}, error=function(e){})
    if(length(df2$diff) == 0) {df2<-data.frame("rownames(df)"=character(0),"diff"=numeric(0),"lwr"=numeric(0),"upr"=numeric(0),"p adj"=numeric(0))}
    #compare_template <- Temp_compare %>% filter(Temp_compare$days == "roomba")
    
    
    uniqueDevice <- unique(planttraitday$Device)
    
    Temp_compare <- as.data.frame(y)
    Temp_compare$days <- dayname
    Temp_compare$y <- NULL
    
    if(uniqueDevice[1] == "Growscreen Fluoro 3"){
      tryCatch({Te <- df2 %>% filter(df2$`rownames(df)` == "Growscreen Fluoro 4-Growscreen Fluoro 3") }, error=function(e){})
    } else {tryCatch({Te <- df2 %>% filter(df2$`rownames(df)` == "Growscreen 2D 6-Growscreen 2D 5")}, error=function(e){})}
    if(length(Te$`p adj`) == 0) {Temp_compare$`P-value` <- 7654} else {Temp_compare$`P-value` <- Te$`p adj`}
    colnames(Temp_compare) <- c("days", x)
    
    compare <- bind_rows(compare, Temp_compare)
  }
  sigtraits_all <- merge(sigtraits_all, compare, by="days", all = T)
 }
openxlsx::write.xlsx(sigtraits_all,"Device_TUKEYTest_PvalueTraits_all_both.xlsx", row.names = TRUE)


######
#see if the devices all days togethere
######
Plant9 <- Plant8
sigtraits <- as.data.frame(c("day_0","day_18","day_21","day_23","day_24","day_25","day_28","day_29","day_30","day_31","day_32","day_35","day_36","day_37","day_38","day_42","day_43","day_44","day_45"))
colnames(sigtraits) <- c("days")
sigtraits_all <- sigtraits

Plant9 <- Plant9 %>% filter(Plant9$stress == "control")
Plant9 <- Plant9 %>% filter(Plant9$Trait != "plantMinimumSizeThreshold")
#Plant9 <- Plant9 %>% filter(Plant9$Device == "Growscreen Fluoro 4")
Plant10 <- Plant9 %>% filter(Plant9$MeasurementDate_das > 1)

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs2/statistics/grouped")
uniquedays <- sort(unique(Plant10$MeasurementDate_das))
uniquetraits <- sort(unique(Plant10$Trait))

compare_template <- data.frame(device = c(2),"P-value" = c(3))
colnames(compare_template) <- c("days","P-value")
compare_template <- compare_template %>% filter(compare_template$days == "lemur")

x <- "Fm"
for (x in uniquetraits){
  planttrait <- Plant10 %>% filter(Plant10$Trait == x)
  uniquedays <- sort(unique(planttrait$MeasurementDate_das))
  planttrait <- planttrait %>% filter(planttrait$Value > 0)
  savename <- paste("TUKEYTest_Pvalue_grouped_", x, "_both",".xlsx", sep = "")
  compare <- compare_template
  colnames(compare) <- c("days", x)
  compare$days <- as.character(compare$days)
  uniquestress <- sort(unique(planttrait$stress))
    rm(Te)
    #anova
    tryCatch({results.aov <- aov(Value ~ Device, data = planttrait)}, error=function(e){})
    #do Tukey test
    tryCatch({TUKEY <- TukeyHSD(x=results.aov, conf.level=0.95)}, error=function(e){})
    #get Tukey results into a dataframe. 
    tryCatch({df <- as.data.frame(TUKEY[["Device"]])}, error=function(e){})
    tryCatch({df2 <- cbind(as.data.frame(rownames(df)),df)}, error=function(e){})
    if(length(df2$diff) == 0) {df2<-data.frame("rownames(df)"=character(0),"diff"=numeric(0),"lwr"=numeric(0),"upr"=numeric(0),"p adj"=numeric(0))}
    #compare_template <- Temp_compare %>% filter(Temp_compare$days == "roomba")
    
    
    uniqueDevice <- unique(planttrait$Device)
    
    Temp_compare <- as.data.frame(y)
    Temp_compare$days <- dayname
    Temp_compare$y <- NULL
    
    if(uniqueDevice[1] == "Growscreen Fluoro 3"){
      tryCatch({Te <- df2 %>% filter(df2$`rownames(df)` == "Growscreen Fluoro 4-Growscreen Fluoro 3") }, error=function(e){})
    } else {tryCatch({Te <- df2 %>% filter(df2$`rownames(df)` == "Growscreen 2D 6-Growscreen 2D 5")}, error=function(e){})}
    if(length(Te$`p adj`) == 0) {Temp_compare$`P-value` <- 7654} else {Temp_compare$`P-value` <- Te$`p adj`}
    colnames(Temp_compare) <- c("days", x)
    
    compare <- bind_rows(compare, Temp_compare)
  sigtraits_all <- merge(sigtraits_all, compare, by="days", all = T)
}
openxlsx::write.xlsx(sigtraits_all,"Device_TUKEYTest_PvalueTraits_daystogether_control.xlsx", row.names = TRUE)


###################################################################################################
#Look at Tissue data in detail
###################################################################################################
#####


PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18,projPlantSurfaceArea_mm2 > 0.00001, stress == "drought")%>%
  group_by(MeasurementDate_das,gene,GT, gene2,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  #facet_wrap(~gene2, scales = "free_y")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,2,2,1,1,1,1,1,1,1,1,1,1,1,1,1,2,2))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,1,2,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1,19,1))+
  scale_color_manual(values=c('#a6cee3','#a6cee3','#a6cee3','#1f78b4','#1f78b4','#b2df8a','#b2df8a','#33a02c','#33a02c','#fb9a99','#fb9a99','#e31a1c','#e31a1c','#fdbf6f','#fdbf6f','#ff7f00','#ff7f00','#cab2d6','#cab2d6','#6a3d9a','#6a3d9a','#ffff99','#ffff99','#b15928','#b15928','#e6ab02','#e6ab02','#000000','#000000'))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")

PlantSize3_Tissue  %>% 
  filter(ID == "1434762", MeasurementDate_das > 18,plantPerimeter_mm > 0.00001, stress == "control")%>%
  group_by(MeasurementDate_das,gene,GT, gene2,stress) %>%
  summarise(mean = mean(plantPerimeter_mm, na.rm = TRUE), sd = sd(plantPerimeter_mm, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  geom_errorbar(aes(ymin = mean - se, ymax = mean + se,color=GT)) +
  #facet_wrap(~gene2, scales = "free_y")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")
ggsave("F0_GT_OE_drought_no_errorbar_.png", plot = last_plot(),width = 6, height =5)


#big picture is = 24
#small picture = 18

PlantSize3
PlantSize3_Tissue$ID <- as.character(PlantSize3_Tissue$ID)
PlantSize3_Tissue_test <- PlantSize3_Tissue %>% filter(PlantSize3_Tissue$plantCompactness < 0.25)

PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, stress == "control", plantCompactness > 0.3 )%>%
  ggplot(mapping = aes(x = MeasurementDate_das,y=plantCompactness)) +
  geom_line(aes(color=ID),size = 0.3)+
  facet_wrap(~Genotype)+
   theme_bw() + theme(legend.position =  "none")+
  xlab("DAS") + ylab("PlantSurfaceArea(mm2)") +labs(title = "PlantSurfaceArea")







PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18)%>%
  group_by(MeasurementDate_das,gene,GT, stress) %>%
  summarise(mean = mean(plantAverageGreen, na.rm = TRUE), sd = sd(plantAverageGreen, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  facet_wrap(~stress, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,1,1,1,1,1,1,1,1,1,1,2))+
  scale_color_manual(values=c('#a6cee3','#1f78b4','#b2df8a','#33a02c','#fb9a99','#e31a1c','#fdbf6f','#ff7f00','#cab2d6','#6a3d9a','#ffff99','#b15928','#e6ab02','#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAverageGreen(mm2)") +labs(title = "plantAverageGreen")


PlantSize3_Tissue  %>% 
  filter(MeasurementDate_das > 18, stress == "drought")%>%
  group_by(MeasurementDate_das,gene,GT, gene2,stress) %>%
  summarise(mean = mean(projPlantSurfaceArea_mm2, na.rm = TRUE), sd = sd(projPlantSurfaceArea_mm2, na.rm = TRUE),se = sd / 2^0.5) %>% 
  ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
  geom_line(aes(linetype=GT, color=GT),size = 1)+
  #facet_wrap(~gene2, scales = "free_x")+
  scale_linetype_manual(values=c(1,1,1,2,1,1,1,2,2,2,1,1,1,2))+
  scale_color_manual(values=c("A14" = '#a6cee3',"Cab3" = '#1f78b4',"CER6" = '#b2df8a',"DR5" = '#33a02c',"E28" = '#fb9a99',"E30" = '#e31a1c',"E49" = '#fdbf6f',"LRC1" = '#ff7f00',"LRC3" = '#cab2d6',"ML1-1" = '#6a3d9a',"Q4" = '#ffff99',"S1" = '#b15928',"S2" = '#e6ab02',"WT" = '#000000'))+
  geom_point(aes(shape=GT, color=GT, size=GT))+
  scale_shape_manual(values=c(19,19,19,19,19,19,19,19,19,19,19,19,19,19))+
  scale_size_manual(values=c(2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2,2))+
  theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
  xlab("DAS") + ylab("plantAverageGreen(mm2)") +labs(title = "plantAverageGreen")

#PCA plot of the data to see which trait is most change
 
Plant2$Unit <- NULL
Plant22 <- Plant2 %>% filter(Device == "Growscreen 2D 5" |Device == "Growscreen 2D 6")
Plant3 <- Plant22 %>% spread(Trait, Value)
Plant3$Average_Blue_Channel<- NULL
Plant3$Average_Green_Channel   <- NULL
Plant3$Average_Red_Channel   <- NULL
Plant3$areaByCircumference   <- NULL
Plant3$averageLeafDiameter  <- NULL
Plant3$bMean   <- NULL
Plant3$bStdDev   <- NULL
Plant3$compactness   <- NULL
Plant3$darkyield_stddev   <- NULL
Plant3$excentricity   <- NULL
Plant3$gMean   <- NULL
Plant3$gStdDev   <- NULL
Plant3$insideDiameter   <- NULL
Plant3$length   <- NULL
Plant3$lengthmm   <- NULL
Plant3$maxLeafDiameter   <- NULL
Plant3$midyieldFluorescenceMeasurement   <- NULL
Plant3$minLeafDiameter   <- NULL
Plant3$numberOfLeafs   <- NULL
Plant3$outsideDiameter   <- NULL
Plant3$plantsize   <- NULL
Plant3$rMean   <- NULL
Plant3$rStdDev   <- NULL
Plant3$rotationalSymmetry   <- NULL
Plant3$size    <- NULL
Plant3$sizemm    <- NULL
Plant3$stockiness    <- NULL
Plant3$surfacecoverage    <- NULL
Plant3$width    <- NULL  
Plant3$widthmm    <- NULL 
Plant3$xpos    <- NULL  
Plant3$ypos    <- NULL  
Plant3$average_circle_size    <- NULL  
Plant3$area_by_circumference    <- NULL  
Plant3$number_of_leafs    <- NULL  
Plant3$rotational_symmetry    <- NULL  
Plant3$surface_coverage    <- NULL  
Plant3$plantsize_mm2    <- NULL 
Plant3$imageEdgePercentage    <- NULL 


PlantSize3 <- Plant3
for (val in UniqueRemove) {
  PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ID != val)
}
PlantSize3 <- PlantSize3 %>% filter(PlantSize3$projPlantSurfaceArea_mm2 > 0)
PlantSize3$MeasurementDate <- as.POSIXct(as.numeric(PlantSize3$MeasurementDate), origin = "1970-01-01", tz = "CET")
PlantSize3$time <- format(PlantSize3$MeasurementDate, '%H:%M:%S')


PlantSize3_Tissue <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "Tissue")
PlantSize3_Tissue$plantMinimumSizeThreshold <- NULL
PlantSize3_Tissue2 <- PlantSize3_Tissue %>% filter(Device == "Growscreen 2D 5" |Device == "Growscreen 2D 6") 
PlantSize3_Tissue2.pca <- prcomp(PlantSize3_Tissue2[,c(26,39)], center = TRUE,scale. = TRUE)

######

notnormal_PlantSize3 <- PlantSize3

importanttraitlist <- c("convexHullPerimeter_mm","hue","plantCompactness","plantConvexHullArea_mm2","projPlantSurfaceArea_mm2")
importanttraitlist <- c("plantSurfaceCoverage")
#plantsurfacecoverage

uniqueGT <- PlantSize3 %>% filter(PlantSize3$gene == "Tissue")
uniqueGT <- unique(uniqueGT$GT)

for (trait in importanttraitlist){
  savedirectory <- paste("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs2/812/Tissue_seperate/",trait,sep = "")
  savedirectory_genotype <- paste("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs2/812/Tissue_seperate/",trait,"/genotype",sep = "")
  
  #if(trait == "hue"){PlantSize3 <- PlantSize3 %>% filter(PlantSize3$ExperimentID == 812)}
  for (TGT in uniqueGT){
  notnormal_PlantSize3_GTTissue <- notnormal_PlantSize3 %>% filter(notnormal_PlantSize3$GT == "PLC5"|notnormal_PlantSize3$gene == "WT"| notnormal_PlantSize3$GT == TGT)
  normal_PlantSize3_GTTissue <- PlantSize3 %>% filter(PlantSize3$GT == "PLC5" |PlantSize3$gene == "WT" | PlantSize3$GT == TGT)
  reference <- c("WT", "PLC5", TGT)
  
  notnormal_PlantSize3_GTTissue <- notnormal_PlantSize3_GTTissue[order(factor(notnormal_PlantSize3_GTTissue$GT, levels = reference)),]
  normal_PlantSize3_GTTissue <- normal_PlantSize3_GTTissue[order(factor(normal_PlantSize3_GTTissue$GT, levels = reference)),]
  
  #if(trait == "hue"){notnormal_PlantSize3_GTTissue <- notnormal_PlantSize3_GTTissue %>% filter(notnormal_PlantSize3_GTTissue$ExperimentID == 812)}
  #if(trait == "hue"){normal_PlantSize3_GTTissue <- normal_PlantSize3_GTTissue %>% filter(normal_PlantSize3_GTTissue$ExperimentID == 812)}

  
  setwd(savedirectory)  
  notnormal_PlantSize3_GTTissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,2))+
    scale_color_manual(values=c("A14" = '#a6cee3',"Cab3" = '#1f78b4',"CER6" = '#b2df8a',"DR5" = '#33a02c',"E28" = '#fb9a99',"E30" = '#e31a1c',"E49" = '#fdbf6f',"LRC1" = '#ff7f00',"LRC3" = '#cab2d6',"ML1-1" = '#6a3d9a',"Q4" = '#ffff99',"S1" = '#b15928',"S2" = '#e6ab02', "PLC5"='#e7298a',"WT" = '#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19))+
    scale_color_manual(values=c("A14" = '#a6cee3',"Cab3" = '#1f78b4',"CER6" = '#b2df8a',"DR5" = '#33a02c',"E28" = '#fb9a99',"E30" = '#e31a1c',"E49" = '#fdbf6f',"LRC1" = '#ff7f00',"LRC3" = '#cab2d6',"ML1-1" = '#6a3d9a',"Q4" = '#ffff99',"S1" = '#b15928',"S2" = '#e6ab02', "PLC5"='#e7298a',"WT" = '#000000'))+
    scale_size_manual(values=c(2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, TGT, "Tissue_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  notnormal_PlantSize3_GTTissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,2))+
    scale_color_manual(values=c("A14" = '#a6cee3',"Cab3" = '#1f78b4',"CER6" = '#b2df8a',"DR5" = '#33a02c',"E28" = '#fb9a99',"E30" = '#e31a1c',"E49" = '#fdbf6f',"LRC1" = '#ff7f00',"LRC3" = '#cab2d6',"ML1-1" = '#6a3d9a',"Q4" = '#ffff99',"S1" = '#b15928',"S2" = '#e6ab02', "PLC5"='#e7298a',"WT" = '#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19))+
    scale_color_manual(values=c("A14" = '#a6cee3',"Cab3" = '#1f78b4',"CER6" = '#b2df8a',"DR5" = '#33a02c',"E28" = '#fb9a99',"E30" = '#e31a1c',"E49" = '#fdbf6f',"LRC1" = '#ff7f00',"LRC3" = '#cab2d6',"ML1-1" = '#6a3d9a',"Q4" = '#ffff99',"S1" = '#b15928',"S2" = '#e6ab02', "PLC5"='#e7298a',"WT" = '#000000'))+
    scale_size_manual(values=c(2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, TGT, "Tissue_control_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
   normal_PlantSize3_GTTissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, GT,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=GT, color=GT),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,2))+
    scale_color_manual(values=c("A14" = '#a6cee3',"Cab3" = '#1f78b4',"CER6" = '#b2df8a',"DR5" = '#33a02c',"E28" = '#fb9a99',"E30" = '#e31a1c',"E49" = '#fdbf6f',"LRC1" = '#ff7f00',"LRC3" = '#cab2d6',"ML1-1" = '#6a3d9a',"Q4" = '#ffff99',"S1" = '#b15928',"S2" = '#e6ab02', "PLC5"='#e7298a',"WT" = '#000000'))+
    geom_point(aes(shape=GT, color=GT, size=GT))+
    scale_shape_manual(values=c(19,19,19))+
    scale_color_manual(values=c("A14" = '#a6cee3',"Cab3" = '#1f78b4',"CER6" = '#b2df8a',"DR5" = '#33a02c',"E28" = '#fb9a99',"E30" = '#e31a1c',"E49" = '#fdbf6f',"LRC1" = '#ff7f00',"LRC3" = '#cab2d6',"ML1-1" = '#6a3d9a',"Q4" = '#ffff99',"S1" = '#b15928',"S2" = '#e6ab02', "PLC5"='#e7298a',"WT" = '#000000'))+
    scale_size_manual(values=c(2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, TGT, "_normalized_Tissue_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 6, height =5)
  
  setwd(savedirectory_genotype)
  ####
  if(TGT != "A14"){
  
  notnormal_PlantSize3_GTTissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,2,2))+
    scale_color_manual(values=c("A14:PLC5 2.0.3" = '#a6cee3',"A14:PLC5 2.0.5" = '#a6cee3',"A14:PLC5 2.3.4" = '#a6cee3',
                                "Cab3:PLC5 9.3.0" = '#1f78b4',"Cab3:PLC5 9.4.2" = '#1f78b4',
                                "CER6:PLC5 10.0.4" = '#b2df8a',"CER6:PLC5 10.9.4" = '#b2df8a',
                                "DR5:PLC5 15.2.5" = '#33a02c',"DR5:PLC5 15.0.2" = '#33a02c',
                                "E28: PLC5 3.4.3" = '#fb9a99',"E28: PLC5 3.8.9" = '#fb9a99',
                                "E30:PLC5 4.1.5" = '#e31a1c',"E30:PLC5 4.6.2" = '#e31a1c',
                                "E49:PLC5 14.4.3" = '#fdbf6f',"E49:PLC5 14.8.1" = '#fdbf6f',
                                "LRC1:PLC5 12.1.3" = '#ff7f00',"LRC1:PLC5 12.6.2" = '#ff7f00',
                                "LRC3:PLC5 11.3.3" = '#cab2d6',"LRC3:PLC5 11.6.1" = '#cab2d6',
                                "ML1-1:PLC5 7.4.1" = '#6a3d9a',"ML1-1:PLC5 7.5.5" = '#6a3d9a',
                                "Q4:PLC5 5.1.4" = '#ffff99',"Q4:PLC5 5.6.1" = '#ffff99',
                                "S1:PLC5 6.1.4" = '#b15928',"S1:PLC5 6.2.3" = '#b15928',
                                "S2:PLC5 1.2.3" = '#e6ab02', "S2:PLC5 1.4.4" = '#e6ab02',
                                "PLC5 OE 2"='#e7298a', "PLC5 OE 3"='#e7298a',
                                "WT 70.000" = '#000000',"WT PLC´s" = '#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size = Genotype))+
    scale_shape_manual(values=c(1,19,1,19,1,19))+
    scale_color_manual(values=c("A14:PLC5 2.0.3" = '#a6cee3',"A14:PLC5 2.0.5" = '#a6cee3',"A14:PLC5 2.3.4" = '#a6cee3',
                                "Cab3:PLC5 9.3.0" = '#1f78b4',"Cab3:PLC5 9.4.2" = '#1f78b4',
                                "CER6:PLC5 10.0.4" = '#b2df8a',"CER6:PLC5 10.9.4" = '#b2df8a',
                                "DR5:PLC5 15.2.5" = '#33a02c',"DR5:PLC5 15.0.2" = '#33a02c',
                                "E28: PLC5 3.4.3" = '#fb9a99',"E28: PLC5 3.8.9" = '#fb9a99',
                                "E30:PLC5 4.1.5" = '#e31a1c',"E30:PLC5 4.6.2" = '#e31a1c',
                                "E49:PLC5 14.4.3" = '#fdbf6f',"E49:PLC5 14.8.1" = '#fdbf6f',
                                "LRC1:PLC5 12.1.3" = '#ff7f00',"LRC1:PLC5 12.6.2" = '#ff7f00',
                                "LRC3:PLC5 11.3.3" = '#cab2d6',"LRC3:PLC5 11.6.1" = '#cab2d6',
                                "ML1-1:PLC5 7.4.1" = '#6a3d9a',"ML1-1:PLC5 7.5.5" = '#6a3d9a',
                                "Q4:PLC5 5.1.4" = '#ffff99',"Q4:PLC5 5.6.1" = '#ffff99',
                                "S1:PLC5 6.1.4" = '#b15928',"S1:PLC5 6.2.3" = '#b15928',
                                "S2:PLC5 1.2.3" = '#e6ab02', "S2:PLC5 1.4.4" = '#e6ab02',
                                "PLC5 OE 2"='#e7298a', "PLC5 OE 3"='#e7298a',
                                "WT 70.000" = '#000000',"WT PLC´s" = '#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, TGT, "_genotype_Tissue_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 7.4, height =5)
  
  notnormal_PlantSize3_GTTissue  %>% 
    filter(MeasurementDate_das > 18, stress == "control") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,2,2))+
    scale_color_manual(values=c("A14:PLC5 2.0.3" = '#a6cee3',"A14:PLC5 2.0.5" = '#a6cee3',"A14:PLC5 2.3.4" = '#a6cee3',
                                "Cab3:PLC5 9.3.0" = '#1f78b4',"Cab3:PLC5 9.4.2" = '#1f78b4',
                                "CER6:PLC5 10.0.4" = '#b2df8a',"CER6:PLC5 10.9.4" = '#b2df8a',
                                "DR5:PLC5 15.2.5" = '#33a02c',"DR5:PLC5 15.0.2" = '#33a02c',
                                "E28: PLC5 3.4.3" = '#fb9a99',"E28: PLC5 3.8.9" = '#fb9a99',
                                "E30:PLC5 4.1.5" = '#e31a1c',"E30:PLC5 4.6.2" = '#e31a1c',
                                "E49:PLC5 14.4.3" = '#fdbf6f',"E49:PLC5 14.8.1" = '#fdbf6f',
                                "LRC1:PLC5 12.1.3" = '#ff7f00',"LRC1:PLC5 12.6.2" = '#ff7f00',
                                "LRC3:PLC5 11.3.3" = '#cab2d6',"LRC3:PLC5 11.6.1" = '#cab2d6',
                                "ML1-1:PLC5 7.4.1" = '#6a3d9a',"ML1-1:PLC5 7.5.5" = '#6a3d9a',
                                "Q4:PLC5 5.1.4" = '#ffff99',"Q4:PLC5 5.6.1" = '#ffff99',
                                "S1:PLC5 6.1.4" = '#b15928',"S1:PLC5 6.2.3" = '#b15928',
                                "S2:PLC5 1.2.3" = '#e6ab02', "S2:PLC5 1.4.4" = '#e6ab02',
                                "PLC5 OE 2"='#e7298a', "PLC5 OE 3"='#e7298a',
                                "WT 70.000" = '#000000',"WT PLC´s" = '#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(1,19,1,19,1,19))+
    scale_color_manual(values=c("A14:PLC5 2.0.3" = '#a6cee3',"A14:PLC5 2.0.5" = '#a6cee3',"A14:PLC5 2.3.4" = '#a6cee3',
                                "Cab3:PLC5 9.3.0" = '#1f78b4',"Cab3:PLC5 9.4.2" = '#1f78b4',
                                "CER6:PLC5 10.0.4" = '#b2df8a',"CER6:PLC5 10.9.4" = '#b2df8a',
                                "DR5:PLC5 15.2.5" = '#33a02c',"DR5:PLC5 15.0.2" = '#33a02c',
                                "E28: PLC5 3.4.3" = '#fb9a99',"E28: PLC5 3.8.9" = '#fb9a99',
                                "E30:PLC5 4.1.5" = '#e31a1c',"E30:PLC5 4.6.2" = '#e31a1c',
                                "E49:PLC5 14.4.3" = '#fdbf6f',"E49:PLC5 14.8.1" = '#fdbf6f',
                                "LRC1:PLC5 12.1.3" = '#ff7f00',"LRC1:PLC5 12.6.2" = '#ff7f00',
                                "LRC3:PLC5 11.3.3" = '#cab2d6',"LRC3:PLC5 11.6.1" = '#cab2d6',
                                "ML1-1:PLC5 7.4.1" = '#6a3d9a',"ML1-1:PLC5 7.5.5" = '#6a3d9a',
                                "Q4:PLC5 5.1.4" = '#ffff99',"Q4:PLC5 5.6.1" = '#ffff99',
                                "S1:PLC5 6.1.4" = '#b15928',"S1:PLC5 6.2.3" = '#b15928',
                                "S2:PLC5 1.2.3" = '#e6ab02', "S2:PLC5 1.4.4" = '#e6ab02',
                                "PLC5 OE 2"='#e7298a', "PLC5 OE 3"='#e7298a',
                                "WT 70.000" = '#000000',"WT PLC´s" = '#000000'))+
    scale_size_manual(values=c(2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, TGT, "_genotype_Tissue_control_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 7.4, height =5)
  
  normal_PlantSize3_GTTissue  %>% 
    filter(MeasurementDate_das > 18, stress == "drought") %>%
    group_by(MeasurementDate_das,gene, Genotype,stress) %>%
    summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
    ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
    geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
    geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
    facet_wrap(~stress)+
    scale_linetype_manual(values=c(1,1,1,1,2,2))+
    scale_color_manual(values=c("A14:PLC5 2.0.3" = '#a6cee3',"A14:PLC5 2.0.5" = '#a6cee3',"A14:PLC5 2.3.4" = '#a6cee3',
                                "Cab3:PLC5 9.3.0" = '#1f78b4',"Cab3:PLC5 9.4.2" = '#1f78b4',
                                "CER6:PLC5 10.0.4" = '#b2df8a',"CER6:PLC5 10.9.4" = '#b2df8a',
                                "DR5:PLC5 15.2.5" = '#33a02c',"DR5:PLC5 15.0.2" = '#33a02c',
                                "E28: PLC5 3.4.3" = '#fb9a99',"E28: PLC5 3.8.9" = '#fb9a99',
                                "E30:PLC5 4.1.5" = '#e31a1c',"E30:PLC5 4.6.2" = '#e31a1c',
                                "E49:PLC5 14.4.3" = '#fdbf6f',"E49:PLC5 14.8.1" = '#fdbf6f',
                                "LRC1:PLC5 12.1.3" = '#ff7f00',"LRC1:PLC5 12.6.2" = '#ff7f00',
                                "LRC3:PLC5 11.3.3" = '#cab2d6',"LRC3:PLC5 11.6.1" = '#cab2d6',
                                "ML1-1:PLC5 7.4.1" = '#6a3d9a',"ML1-1:PLC5 7.5.5" = '#6a3d9a',
                                "Q4:PLC5 5.1.4" = '#ffff99',"Q4:PLC5 5.6.1" = '#ffff99',
                                "S1:PLC5 6.1.4" = '#b15928',"S1:PLC5 6.2.3" = '#b15928',
                                "S2:PLC5 1.2.3" = '#e6ab02', "S2:PLC5 1.4.4" = '#e6ab02',
                                "PLC5 OE 2"='#e7298a', "PLC5 OE 3"='#e7298a',
                                "WT 70.000" = '#000000',"WT PLC´s" = '#000000'))+
    geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
    scale_shape_manual(values=c(1,19,1,19,1,19))+
    scale_color_manual(values=c("A14:PLC5 2.0.3" = '#a6cee3',"A14:PLC5 2.0.5" = '#a6cee3',"A14:PLC5 2.3.4" = '#a6cee3',
                                "Cab3:PLC5 9.3.0" = '#1f78b4',"Cab3:PLC5 9.4.2" = '#1f78b4',
                                "CER6:PLC5 10.0.4" = '#b2df8a',"CER6:PLC5 10.9.4" = '#b2df8a',
                                "DR5:PLC5 15.2.5" = '#33a02c',"DR5:PLC5 15.0.2" = '#33a02c',
                                "E28: PLC5 3.4.3" = '#fb9a99',"E28: PLC5 3.8.9" = '#fb9a99',
                                "E30:PLC5 4.1.5" = '#e31a1c',"E30:PLC5 4.6.2" = '#e31a1c',
                                "E49:PLC5 14.4.3" = '#fdbf6f',"E49:PLC5 14.8.1" = '#fdbf6f',
                                "LRC1:PLC5 12.1.3" = '#ff7f00',"LRC1:PLC5 12.6.2" = '#ff7f00',
                                "LRC3:PLC5 11.3.3" = '#cab2d6',"LRC3:PLC5 11.6.1" = '#cab2d6',
                                "ML1-1:PLC5 7.4.1" = '#6a3d9a',"ML1-1:PLC5 7.5.5" = '#6a3d9a',
                                "Q4:PLC5 5.1.4" = '#ffff99',"Q4:PLC5 5.6.1" = '#ffff99',
                                "S1:PLC5 6.1.4" = '#b15928',"S1:PLC5 6.2.3" = '#b15928',
                                "S2:PLC5 1.2.3" = '#e6ab02', "S2:PLC5 1.4.4" = '#e6ab02',
                                "PLC5 OE 2"='#e7298a', "PLC5 OE 3"='#e7298a',
                                "WT 70.000" = '#000000',"WT PLC´s" = '#000000'))+
      scale_size_manual(values=c(2,2,2,2,2,2))+
    theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
    xlab("DAS") + ylab(trait) +labs(title = trait)
  ggsavename <- paste(trait, TGT, "_genotype_normalized_Tissue_drought_no_errorbar.png")
  ggsave(ggsavename, plot = last_plot(),width = 7.4, height =5)
  } else {
    notnormal_PlantSize3_GTTissue  %>% 
      filter(MeasurementDate_das > 18, stress == "drought") %>%
      group_by(MeasurementDate_das,gene, Genotype,stress) %>%
      summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
      ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
      geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
      geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
      facet_wrap(~stress)+
      scale_linetype_manual(values=c(1,1,1,1,1,2,2))+
      scale_color_manual(values=c("A14:PLC5 2.0.3" = '#a6cee3',"A14:PLC5 2.0.5" = '#a6cee3',"A14:PLC5 2.3.4" = '#a6cee3',
                                  "Cab3:PLC5 9.3.0" = '#1f78b4',"Cab3:PLC5 9.4.2" = '#1f78b4',
                                  "CER6:PLC5 10.0.4" = '#b2df8a',"CER6:PLC5 10.9.4" = '#b2df8a',
                                  "DR5:PLC5 15.2.5" = '#33a02c',"DR5:PLC5 15.0.2" = '#33a02c',
                                  "E28: PLC5 3.4.3" = '#fb9a99',"E28: PLC5 3.8.9" = '#fb9a99',
                                  "E30:PLC5 4.1.5" = '#e31a1c',"E30:PLC5 4.6.2" = '#e31a1c',
                                  "E49:PLC5 14.4.3" = '#fdbf6f',"E49:PLC5 14.8.1" = '#fdbf6f',
                                  "LRC1:PLC5 12.1.3" = '#ff7f00',"LRC1:PLC5 12.6.2" = '#ff7f00',
                                  "LRC3:PLC5 11.3.3" = '#cab2d6',"LRC3:PLC5 11.6.1" = '#cab2d6',
                                  "ML1-1:PLC5 7.4.1" = '#6a3d9a',"ML1-1:PLC5 7.5.5" = '#6a3d9a',
                                  "Q4:PLC5 5.1.4" = '#ffff99',"Q4:PLC5 5.6.1" = '#ffff99',
                                  "S1:PLC5 6.1.4" = '#b15928',"S1:PLC5 6.2.3" = '#b15928',
                                  "S2:PLC5 1.2.3" = '#e6ab02', "S2:PLC5 1.4.4" = '#e6ab02',
                                  "PLC5 OE 2"='#e7298a', "PLC5 OE 3"='#e7298a',
                                  "WT 70.000" = '#000000',"WT PLC´s" = '#000000'))+
      geom_point(aes(shape=Genotype, color=Genotype, size = Genotype))+
      scale_shape_manual(values=c(1,9,19,1,19,1,19))+
      scale_color_manual(values=c("A14:PLC5 2.0.3" = '#a6cee3',"A14:PLC5 2.0.5" = '#a6cee3',"A14:PLC5 2.3.4" = '#a6cee3',
                                  "Cab3:PLC5 9.3.0" = '#1f78b4',"Cab3:PLC5 9.4.2" = '#1f78b4',
                                  "CER6:PLC5 10.0.4" = '#b2df8a',"CER6:PLC5 10.9.4" = '#b2df8a',
                                  "DR5:PLC5 15.2.5" = '#33a02c',"DR5:PLC5 15.0.2" = '#33a02c',
                                  "E28: PLC5 3.4.3" = '#fb9a99',"E28: PLC5 3.8.9" = '#fb9a99',
                                  "E30:PLC5 4.1.5" = '#e31a1c',"E30:PLC5 4.6.2" = '#e31a1c',
                                  "E49:PLC5 14.4.3" = '#fdbf6f',"E49:PLC5 14.8.1" = '#fdbf6f',
                                  "LRC1:PLC5 12.1.3" = '#ff7f00',"LRC1:PLC5 12.6.2" = '#ff7f00',
                                  "LRC3:PLC5 11.3.3" = '#cab2d6',"LRC3:PLC5 11.6.1" = '#cab2d6',
                                  "ML1-1:PLC5 7.4.1" = '#6a3d9a',"ML1-1:PLC5 7.5.5" = '#6a3d9a',
                                  "Q4:PLC5 5.1.4" = '#ffff99',"Q4:PLC5 5.6.1" = '#ffff99',
                                  "S1:PLC5 6.1.4" = '#b15928',"S1:PLC5 6.2.3" = '#b15928',
                                  "S2:PLC5 1.2.3" = '#e6ab02', "S2:PLC5 1.4.4" = '#e6ab02',
                                  "PLC5 OE 2"='#e7298a', "PLC5 OE 3"='#e7298a',
                                  "WT 70.000" = '#000000',"WT PLC´s" = '#000000'))+
      scale_size_manual(values=c(2,2,2,2,2,2,2))+
      theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
      xlab("DAS") + ylab(trait) +labs(title = trait)
    ggsavename <- paste(trait, TGT, "_genotype_Tissue_drought_no_errorbar.png")
    ggsave(ggsavename, plot = last_plot(),width = 7.4, height =5)
    
    notnormal_PlantSize3_GTTissue  %>% 
      filter(MeasurementDate_das > 18, stress == "control") %>%
      group_by(MeasurementDate_das,gene, Genotype,stress) %>%
      summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
      ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
      geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
      facet_wrap(~stress)+
      scale_linetype_manual(values=c(1,1,1,1,1,2,2))+
      scale_color_manual(values=c("A14:PLC5 2.0.3" = '#a6cee3',"A14:PLC5 2.0.5" = '#a6cee3',"A14:PLC5 2.3.4" = '#a6cee3',
                                  "Cab3:PLC5 9.3.0" = '#1f78b4',"Cab3:PLC5 9.4.2" = '#1f78b4',
                                  "CER6:PLC5 10.0.4" = '#b2df8a',"CER6:PLC5 10.9.4" = '#b2df8a',
                                  "DR5:PLC5 15.2.5" = '#33a02c',"DR5:PLC5 15.0.2" = '#33a02c',
                                  "E28: PLC5 3.4.3" = '#fb9a99',"E28: PLC5 3.8.9" = '#fb9a99',
                                  "E30:PLC5 4.1.5" = '#e31a1c',"E30:PLC5 4.6.2" = '#e31a1c',
                                  "E49:PLC5 14.4.3" = '#fdbf6f',"E49:PLC5 14.8.1" = '#fdbf6f',
                                  "LRC1:PLC5 12.1.3" = '#ff7f00',"LRC1:PLC5 12.6.2" = '#ff7f00',
                                  "LRC3:PLC5 11.3.3" = '#cab2d6',"LRC3:PLC5 11.6.1" = '#cab2d6',
                                  "ML1-1:PLC5 7.4.1" = '#6a3d9a',"ML1-1:PLC5 7.5.5" = '#6a3d9a',
                                  "Q4:PLC5 5.1.4" = '#ffff99',"Q4:PLC5 5.6.1" = '#ffff99',
                                  "S1:PLC5 6.1.4" = '#b15928',"S1:PLC5 6.2.3" = '#b15928',
                                  "S2:PLC5 1.2.3" = '#e6ab02', "S2:PLC5 1.4.4" = '#e6ab02',
                                  "PLC5 OE 2"='#e7298a', "PLC5 OE 3"='#e7298a',
                                  "WT 70.000" = '#000000',"WT PLC´s" = '#000000'))+
      geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
      scale_shape_manual(values=c(1,9,19,1,19,1,19))+
      scale_color_manual(values=c("A14:PLC5 2.0.3" = '#a6cee3',"A14:PLC5 2.0.5" = '#a6cee3',"A14:PLC5 2.3.4" = '#a6cee3',
                                  "Cab3:PLC5 9.3.0" = '#1f78b4',"Cab3:PLC5 9.4.2" = '#1f78b4',
                                  "CER6:PLC5 10.0.4" = '#b2df8a',"CER6:PLC5 10.9.4" = '#b2df8a',
                                  "DR5:PLC5 15.2.5" = '#33a02c',"DR5:PLC5 15.0.2" = '#33a02c',
                                  "E28: PLC5 3.4.3" = '#fb9a99',"E28: PLC5 3.8.9" = '#fb9a99',
                                  "E30:PLC5 4.1.5" = '#e31a1c',"E30:PLC5 4.6.2" = '#e31a1c',
                                  "E49:PLC5 14.4.3" = '#fdbf6f',"E49:PLC5 14.8.1" = '#fdbf6f',
                                  "LRC1:PLC5 12.1.3" = '#ff7f00',"LRC1:PLC5 12.6.2" = '#ff7f00',
                                  "LRC3:PLC5 11.3.3" = '#cab2d6',"LRC3:PLC5 11.6.1" = '#cab2d6',
                                  "ML1-1:PLC5 7.4.1" = '#6a3d9a',"ML1-1:PLC5 7.5.5" = '#6a3d9a',
                                  "Q4:PLC5 5.1.4" = '#ffff99',"Q4:PLC5 5.6.1" = '#ffff99',
                                  "S1:PLC5 6.1.4" = '#b15928',"S1:PLC5 6.2.3" = '#b15928',
                                  "S2:PLC5 1.2.3" = '#e6ab02', "S2:PLC5 1.4.4" = '#e6ab02',
                                  "PLC5 OE 2"='#e7298a', "PLC5 OE 3"='#e7298a',
                                  "WT 70.000" = '#000000',"WT PLC´s" = '#000000'))+
      scale_size_manual(values=c(2,2,2,2,2,2,2))+
      theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
      xlab("DAS") + ylab(trait) +labs(title = trait)
    ggsavename <- paste(trait, TGT, "_genotype_Tissue_control_no_errorbar.png")
    ggsave(ggsavename, plot = last_plot(),width = 7.4, height =5)
    
    normal_PlantSize3_GTTissue  %>% 
      filter(MeasurementDate_das > 18, stress == "drought") %>%
      group_by(MeasurementDate_das,gene, Genotype,stress) %>%
      summarise(mean = mean(get(trait), na.rm = TRUE), sd = sd(get(trait), na.rm = TRUE),se = sd / 2^0.5) %>%
      ggplot(mapping = aes(x = MeasurementDate_das,y=mean)) +
      geom_rect(aes(xmin = 25, xmax = 38, ymin = -Inf, ymax = Inf),fill = "light grey", alpha = 0.03)+
      geom_line(aes(linetype=Genotype, color=Genotype),size = 1)+
      facet_wrap(~stress)+
      scale_linetype_manual(values=c(1,1,1,1,1,2,2))+
      scale_color_manual(values=c("A14:PLC5 2.0.3" = '#a6cee3',"A14:PLC5 2.0.5" = '#a6cee3',"A14:PLC5 2.3.4" = '#a6cee3',
                                  "Cab3:PLC5 9.3.0" = '#1f78b4',"Cab3:PLC5 9.4.2" = '#1f78b4',
                                  "CER6:PLC5 10.0.4" = '#b2df8a',"CER6:PLC5 10.9.4" = '#b2df8a',
                                  "DR5:PLC5 15.2.5" = '#33a02c',"DR5:PLC5 15.0.2" = '#33a02c',
                                  "E28: PLC5 3.4.3" = '#fb9a99',"E28: PLC5 3.8.9" = '#fb9a99',
                                  "E30:PLC5 4.1.5" = '#e31a1c',"E30:PLC5 4.6.2" = '#e31a1c',
                                  "E49:PLC5 14.4.3" = '#fdbf6f',"E49:PLC5 14.8.1" = '#fdbf6f',
                                  "LRC1:PLC5 12.1.3" = '#ff7f00',"LRC1:PLC5 12.6.2" = '#ff7f00',
                                  "LRC3:PLC5 11.3.3" = '#cab2d6',"LRC3:PLC5 11.6.1" = '#cab2d6',
                                  "ML1-1:PLC5 7.4.1" = '#6a3d9a',"ML1-1:PLC5 7.5.5" = '#6a3d9a',
                                  "Q4:PLC5 5.1.4" = '#ffff99',"Q4:PLC5 5.6.1" = '#ffff99',
                                  "S1:PLC5 6.1.4" = '#b15928',"S1:PLC5 6.2.3" = '#b15928',
                                  "S2:PLC5 1.2.3" = '#e6ab02', "S2:PLC5 1.4.4" = '#e6ab02',
                                  "PLC5 OE 2"='#e7298a', "PLC5 OE 3"='#e7298a',
                                  "WT 70.000" = '#000000',"WT PLC´s" = '#000000'))+
      geom_point(aes(shape=Genotype, color=Genotype, size=Genotype))+
      scale_shape_manual(values=c(1,2,19,1,19,1,19))+
      scale_color_manual(values=c("A14:PLC5 2.0.3" = '#a6cee3',"A14:PLC5 2.0.5" = '#a6cee3',"A14:PLC5 2.3.4" = '#a6cee3',
                                  "Cab3:PLC5 9.3.0" = '#1f78b4',"Cab3:PLC5 9.4.2" = '#1f78b4',
                                  "CER6:PLC5 10.0.4" = '#b2df8a',"CER6:PLC5 10.9.4" = '#b2df8a',
                                  "DR5:PLC5 15.2.5" = '#33a02c',"DR5:PLC5 15.0.2" = '#33a02c',
                                  "E28: PLC5 3.4.3" = '#fb9a99',"E28: PLC5 3.8.9" = '#fb9a99',
                                  "E30:PLC5 4.1.5" = '#e31a1c',"E30:PLC5 4.6.2" = '#e31a1c',
                                  "E49:PLC5 14.4.3" = '#fdbf6f',"E49:PLC5 14.8.1" = '#fdbf6f',
                                  "LRC1:PLC5 12.1.3" = '#ff7f00',"LRC1:PLC5 12.6.2" = '#ff7f00',
                                  "LRC3:PLC5 11.3.3" = '#cab2d6',"LRC3:PLC5 11.6.1" = '#cab2d6',
                                  "ML1-1:PLC5 7.4.1" = '#6a3d9a',"ML1-1:PLC5 7.5.5" = '#6a3d9a',
                                  "Q4:PLC5 5.1.4" = '#ffff99',"Q4:PLC5 5.6.1" = '#ffff99',
                                  "S1:PLC5 6.1.4" = '#b15928',"S1:PLC5 6.2.3" = '#b15928',
                                  "S2:PLC5 1.2.3" = '#e6ab02', "S2:PLC5 1.4.4" = '#e6ab02',
                                  "PLC5 OE 2"='#e7298a', "PLC5 OE 3"='#e7298a',
                                  "WT 70.000" = '#000000',"WT PLC´s" = '#000000'))+
      scale_size_manual(values=c(2,2,2,2,2,2,2))+
      theme_bw() + theme(legend.title = element_blank(),text = element_text(size = 18))+
      xlab("DAS") + ylab(trait) +labs(title = trait)
    ggsavename <- paste(trait, TGT, "_genotype_normalized_Tissue_drought_no_errorbar.png")
    ggsave(ggsavename, plot = last_plot(),width = 7.4, height =5)
    }
  }
}

}}))

############################################################################################
#PCA plots
############################################################################################

setwd("D:/phd doc/surfdrive/Documents/phenotyping_platform/compiled_data/graphs2/812/PCAplot")
#Need normalized data
#normalize per day


##################
PlantSize3_pr <- PlantSize3 %>% filter(GT != "Col-0")
PlantSize3_pr <- PlantSize3_pr %>% filter(stress == "control")
table(PlantSize3_pr$MeasurementDate_das)
#PlantSize3_pr <- PlantSize3_pr %>% filter(MeasurementDate_das == "30" | MeasurementDate_das == "31"|MeasurementDate_das == "32"|MeasurementDate_das == "33"|MeasurementDate_das == "34"|MeasurementDate_das == "35"|MeasurementDate_das == "36"|MeasurementDate_das == "37"|MeasurementDate_das == "38")
PlantSize3_pr$imageEdgePercentage <- NULL
PlantSize3_pr$x.Position <- NULL
PlantSize3_pr$y.Position <- NULL
PlantSize3_pr$SeedGroupIDs <- NULL
PlantSize3_pr$convexHullPerimeter_pixels <- NULL
PlantSize3_pr$plantConvexHullArea_pixels2 <- NULL
PlantSize3_pr$plantPerimeter_pixels <- NULL
PlantSize3_pr$projPlantSurfaceArea_pixels2 <- NULL
PlantSize3_pr$plantAverageBlue <- NULL
PlantSize3_pr$plantAverageGreen <- NULL
PlantSize3_pr$plantAverageRed <- NULL
PlantSize3_pr$plantSurfaceCoverage <- NULL
PlantSize3_pr$time <- NULL

PlantSize3_pr <- PlantSize3_pr %>%  rename(
  Compactness = plantCompactness,   
  Stockiness = plantStockiness,    
  ConvexArea = plantConvexHullArea_mm2,
  PlantSurfaceArea= projPlantSurfaceArea_mm2,
  Perimiter = plantPerimeter_mm,
  ConvexPerimiter= convexHullPerimeter_mm,
  AreaByCircumferance = plantAreaByCircumference
  )


PlantSize3_pr <- PlantSize3_pr %>% filter(ID.Measurement != 15063)
PlantSize3_pr <- PlantSize3_pr %>% filter(ID.Measurement != 16502)
PlantSize3_pr2 <- PlantSize3_pr

#PlantSize3_pr <- PlantSize3_pr %>% filter(GT == "PLC2"|GT == "PLC3"|GT == "PLC4"|GT == "PLC5"|GT == "PLC7"|GT == "PLC9"|GT == "WT")

PlantSize3_pr_PCA  <- PCA(PlantSize3_pr[c(22:31)], scale.unit = TRUE, ncp= 5)
view(PCA_Psize3_df)
PCA_Psize3_df <- data.frame(PlantSize3_pr_PCA$ind$coord[,1:2], GT = PlantSize3_pr$GT)
PCA_Psize3_df <- PCA_Psize3_df %>%
  group_by(GT) %>%
  summarize(PC1=mean(Dim.1), PC2=mean(Dim.2))
PCA_Psize3_df_tissue <- PCA_Psize3_df %>% filter(GT != "PLC2",GT != "PLC3",GT != "PLC4",GT != "PLC7",GT != "PLC9",GT != "Col-0",GT != "PLC5-1 KO",GT != "PLC5/7 KO")
PCA_Psize3_df_OE <- PCA_Psize3_df %>% filter(GT == "PLC2"|GT == "PLC3"|GT == "PLC4"|GT == "PLC5"|GT == "PLC7"|GT == "PLC9"|GT == "WT")
PCA_Psize3_df_KO <- PCA_Psize3_df %>% filter(GT == "PLC5-1 KO"|GT == "PLC5/7 KO"|GT == "WT")

PCA_Psize3_df_tissue <- PCA_Psize3_df %>% filter(Genotype != "PLC2 OE 4.1",Genotype != "PLC2 OE 8.1",Genotype != "PLC3 OE 9",Genotype != "PLC3 OE 16",
                                                 Genotype != "PLC4 OE 2",Genotype != "PLC4 OE 4",Genotype != "PLC7 OE 9",Genotype != "PLC7 OE 17",
                                                 Genotype != "PLC9 OE 18.4",Genotype != "PLC9 OE 23.6",Genotype != "Col-0",
                                                 Genotype != "PLC5-1 KO",Genotype != "PLC5/7 KO")
PCA_Psize3_df_OE <- PCA_Psize3_df %>% filter(Genotype == "PLC2 OE 4.1"|Genotype == "PLC2 OE 8.1"|Genotype == "PLC3 OE 9"|Genotype == "PLC3 OE 16"|
                                             Genotype == "PLC4 OE 2"|Genotype == "PLC4 OE 4"|Genotype == "PLC7 OE 9"|Genotype == "PLC7 OE 17"|
                                             Genotype == "PLC9 OE 18.4"|Genotype == "PLC9 OE 23.6"|Genotype == "WT 70.000"|Genotype == "WT PLC´s")
PCA_Psize3_df_KO <- PCA_Psize3_df %>% filter(Genotype == "PLC5-1 KO"|Genotype == "PLC5/7 KO"|Genotype == "WT 70.000"|Genotype == "WT PLC´s")



fviz_pca_var(PlantSize3_pr_PCA, geom.ind = "point", pointshape = 21, 
             pointsize = 0, 
             fill.ind = PlantSize3_pr2$GT, 
             col.ind = "black", 
             palette = ColorTissue, 
             addEllipses = FALSE,
             label = "var",
             col.var = "black",
             repel = TRUE,
             legend.title = "GenotypeDASSTRESS") +
  geom_point(data=PCA_Psize3_df_tissue, aes(x=PC1, y=PC2, color=GT), size=5)+
  xlim(-2.5,2)+  ylim(-1.5,1.5)+
  ggtitle("PCA plot - control stress all days normalized") +
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     legend.title = element_blank(),text = element_text(size = 18))
ggsave("PCAplot_GT_Tissue_control_allday_day_normalized.png", plot = last_plot(),width = 12, height =8)

###### hierzo
fviz_pca_var(PlantSize3_pr_PCA, geom.ind = "point", pointshape = 28, 
             pointsize = 4, 
             fill.ind = PlantSize3_pr2$GT, 
             col.ind = "black", 
             palette = ColorOE, 
             addEllipses = FALSE,
             label = "var",
             col.var = "black",
             repel = TRUE,
             legend.title = "GTDASSTRESS") +
  geom_point(data=PCA_Psize3_df_OE, aes(x=PC1, y=PC2, color=GT), size=7)+
  ggtitle("PCA plot - control stress all days normalized") +
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     legend.title = element_blank(),text = element_text(size = 17))
 ggsave("PCAplot_GT_OE_control_allday_day_normalized.png", plot = last_plot(),width = 8.5, height =5)

fviz_pca_var(PlantSize3_pr_PCA, geom.ind = "point", pointshape = 21, 
             pointsize = 0, 
             fill.ind = PlantSize3_pr2$GT, 
             col.ind = "black", 
             palette = ColorKO, 
             addEllipses = FALSE,
             label = "var",
             col.var = "black",
             repel = TRUE,
             legend.title = "GTDASSTRESS") +
  geom_point(data=PCA_Psize3_df_KO, aes(x=PC1, y=PC2, color=GT), size=5)+
  xlim(-2.5,2)+  ylim(-1.5,1.5)+
  ggtitle("PCA plot - control stress all days normalized") +
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     legend.title = element_blank(),text = element_text(size = 18))
ggsave("PCAplot_GT_KO_control_allday_day_normalized.png", plot = last_plot(),width = 8.5, height =5)

#fviz_pca_var(PlantSize3_pr_PCA, geom.ind = "point", pointshape = 21, 
             pointsize = 0, 
             fill.ind = PlantSize3_pr2$GT, 
             col.ind = "black", 
             addEllipses = FALSE,
             label = "var",
             col.var = "black",
             repel = TRUE,
             legend.title = "GTDASSTRESS") +
  geom_point(data=PCA_Psize3_df, aes(x=PC1, y=PC2, color=GT), size=5)+
  xlim(-2.5,2)+  ylim(-1.5,1.5)+
  ggtitle("PCA plot - drought stress drought days normalized") +
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     legend.title = element_blank(),text = element_text(size = 18))
#ggsave("PCAplot_drought_drought_droughtday_day_normalized.png", plot = last_plot(),width = 8.5, height =5)



Plant4_pr <- Plant4 %>% filter(GT != "Col-0")
Plant4_pr <- Plant4_pr %>% filter(stress == "control")
table(Plant4_pr$MeasurementDate_das)
#Plant4_pr <- Plant4_pr %>% filter(MeasurementDate_das == "30" | MeasurementDate_das == "31"||MeasurementDate_das == "33"|MeasurementDate_das == "34"|MeasurementDate_das == "35"|MeasurementDate_das == "36"|MeasurementDate_das == "37"|MeasurementDate_das == "38")
Plant4_pr$imageEdgePercentage <- NULL
Plant4_pr$x.Position <- NULL
Plant4_pr$y.Position <- NULL
Plant4_pr$SeedGroupIDs <- NULL

Plant4_pr$averageLeafDiameter <- NULL
Plant4_pr$numberOfLeafs <- NULL
Plant4_pr$minLeafDiameter <- NULL
Plant4_pr$plantsize <- NULL
Plant4_pr$maxLeafDiameter <- NULL
Plant4_pr <- Plant4_pr %>% drop_na(rotationalSymmetry)
Plant4_pr <- Plant4_pr %>% drop_na(compactness)
Plant4_pr <- Plant4_pr %>% drop_na(surfaceCoverage)
Plant4_pr <- Plant4_pr %>% drop_na(Fv_Fm)
Plant4_pr <- Plant4_pr %>% drop_na(Fm)
Plant4_pr <- Plant4_pr %>% drop_na(plantsize_mm2)
Plant4_pr <- Plant4_pr %>% drop_na(insideDiameter)
Plant4_pr <- Plant4_pr %>% drop_na(outsideDiameter)
Plant4_pr <- Plant4_pr %>% drop_na(F0)
Plant4_pr <- Plant4_pr %>% drop_na(darkyield_stddev)
Plant4_pr <- Plant4_pr %>% drop_na(excentricity)
Plant4_pr <- Plant4_pr %>% drop_na(midyieldFluorescenceMeasurement)
Plant4_pr <- Plant4_pr %>% drop_na(stockiness)

Plant4_pr <- Plant4_pr %>%  rename(
  Compactness = plantCompactness,   
  Stockiness = plantStockiness,    
  ConvexArea = plantConvexHullArea_mm2,
  SurfaceCoverage = plantSurfaceCoverage,
  PlantSurfaceArea= projPlantSurfaceArea_mm2,
  Perimiter = plantPerimeter_mm,
  ConvexPerimiter= convexHullPerimeter_mm,
  AreaByCircumferance = plantAreaByCircumference
)

Plant4_pr$compactness <- NULL
Plant4_pr$stockiness <- NULL
Plant4_pr$plantsize_mm2 <- NULL
Plant4_pr$areaByCircumference <- NULL
Plant4_pr$surfaceCoverage <- NULL
Plant4_pr$time <- NULL

Plant4_pr <- Plant4_pr %>% filter(ID.Measurement != 15063)
Plant4_pr <- Plant4_pr %>% filter(ID.Measurement != 16502)
Plant4_pr2 <- Plant4_pr

Plant4_pr_PCA  <- PCA(Plant4_pr[c(22:30)], scale.unit = TRUE, ncp= 5)

PCA_Psize3_df <- data.frame(Plant4_pr_PCA$ind$coord[,1:2], GT = Plant4_pr2$GT)
PCA_Psize3_df <- PCA_Psize3_df %>%
  group_by(GT) %>%
  summarize(PC1=mean(Dim.1), PC2=mean(Dim.2))
PCA_Psize3_df_tissue <- PCA_Psize3_df %>% filter(GT != "PLC2",GT != "PLC3",GT != "PLC4",GT != "PLC7",GT != "PLC9",GT != "Col-0",GT != "PLC5-1 KO",GT != "PLC5/7 KO")
PCA_Psize3_df_OE <- PCA_Psize3_df %>% filter(GT == "PLC2"|GT == "PLC3"|GT == "PLC4"|GT == "PLC5"|GT == "PLC7"|GT == "PLC9"|GT == "WT")
PCA_Psize3_df_KO <- PCA_Psize3_df %>% filter(GT == "PLC5-1 KO"|GT == "PLC5/7 KO"|GT == "WT")

fviz_pca_var(Plant4_pr_PCA, geom.ind = "point", pointshape = 21, 
             pointsize = 0, 
             fill.ind = Plant4_pr2$GT, 
             col.ind = "black", 
             palette = ColorTissue, 
             addEllipses = FALSE,
             label = "var",
             col.var = "black",
             repel = TRUE,
             legend.title = "GTDASSTRESS") +
  geom_point(data=PCA_Psize3_df_tissue, aes(x=PC1, y=PC2, color=GT), size=5)+
  xlim(-2.5,2)+  ylim(-1.5,1.5)+
  ggtitle("PCA plot - control stress all days normalized") +
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     legend.title = element_blank(),text = element_text(size = 18))
ggsave("PCAplot_GT_Fluro4_Tissue_contorl_allday_day.png", plot = last_plot(),width = 8.5, height =5)


fviz_pca_var(Plant4_pr_PCA, geom.ind = "point", pointshape = 21, 
             pointsize = 0, 
             fill.ind = Plant4_pr2$GT, 
             col.ind = "black", 
             palette = ColorOE, 
             addEllipses = FALSE,
             label = "var",
             col.var = "black",
             repel = TRUE,
             legend.title = "GTDASSTRESS") +
  geom_point(data=PCA_Psize3_df_OE, aes(x=PC1, y=PC2, color=GT), size=5)+
  xlim(-2.5,2)+  ylim(-1.5,1.5)+
  ggtitle("PCA plot - control stress alldays normalized") +
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     legend.title = element_blank(),text = element_text(size = 18))
ggsave("PCAplot_GT_Fluro4_OE_control_allday_day.png", plot = last_plot(),width = 8.5, height =5)

fviz_pca_var(Plant4_pr_PCA, geom.ind = "point", pointshape = 21, 
             pointsize = 0, 
             fill.ind = Plant4_pr2$GT, 
             col.ind = "black", 
             palette = ColorKO, 
             addEllipses = FALSE,
             label = "var",
             col.var = "black",
             repel = TRUE,
             legend.title = "GTDASSTRESS") +
  geom_point(data=PCA_Psize3_df_KO, aes(x=PC1, y=PC2, color=GT), size=5)+
  xlim(-2.5,2)+  ylim(-1.5,1.5)+
  ggtitle("PCA plot - control stress alldays normalized") +
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     legend.title = element_blank(),text = element_text(size = 18))
ggsave("PCAplot_GT_Fluro4_KO_control_allday_day.png", plot = last_plot(),width = 8.5, height =5)

#fviz_pca_var(Plant4_pr_PCA, geom.ind = "point", pointshape = 21, 
             pointsize = 0, 
             fill.ind = Plant4_pr2$GT, 
             col.ind = "black", 
             addEllipses = FALSE,
             label = "var",
             col.var = "black",
             repel = TRUE,
             legend.title = "GTDASSTRESS") +
  geom_point(data=PCA_Psize3_df, aes(x=PC1, y=PC2, color=GT), size=5)+
  xlim(-2.5,2)+  ylim(-1.5,1.5)+
  ggtitle("PCA plot - drought stress drought days normalized") +
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     legend.title = element_blank(),text = element_text(size = 18))
ggsave("PCAplot_drought_drought_droughtday_day_normalized.png", plot = last_plot(),width = 8.5, height =5)










######
#old PCA
#####
table(PlantSize3_pr$MeasurementDate_das)

#only PLC OE included
PlantSize3_OE_pr <- PlantSize3_OE
PlantSize3_OE_pr <- PlantSize3_OE_pr %>% filter(stress == "drought")
table(PlantSize3_OE_pr$MeasurementDate_das)
#PlantSize3_OE_pr <- PlantSize3_OE_pr %>% filter(MeasurementDate_das == 25)
PlantSize3_OE_pr$imageEdgePercentage <- NULL
PlantSize3_OE_pr$x.Position <- NULL
PlantSize3_OE_pr$y.Position <- NULL
PlantSize3_OE_pr$SeedGroupIDs <- NULL

PlantSize3_OE_pr <- PlantSize3_OE_pr %>% filter(ID.Measurement != 15063)
PlantSize3_OE_pr <- PlantSize3_OE_pr %>% filter(ID.Measurement != 16502)
PlantSize3_OE_pr2 <- PlantSize3_OE_pr
PlantSize3_OE_pr$convexHullPerimeter_pixels <- NULL
PlantSize3_OE_pr$plantConvexHullArea_pixels2 <- NULL
PlantSize3_OE_pr$plantPerimeter_pixels <- NULL
PlantSize3_OE_pr$projPlantSurfaceArea_pixels2 <- NULL


PlantSize3_OE_pr <- prcomp(PlantSize3_OE_pr[c(22:35)], center = TRUE, scale= TRUE)
#summary(PlantSize3_OE_pr)
#PlantSize3_OE_pr$x

plot(PlantSize3_OE_pr$x[,1],PlantSize3_OE_pr$x[,2], xlab="PC1 (54.9%)", ylab = "PC2 (18.7%)", main = "PC1 / PC2 - plot")

fviz_pca_biplot(PlantSize3_OE_pr, geom.ind = "point", pointshape = 21, 
                pointsize = 0, 
                fill.ind = PlantSize3_OE_pr2$GT, 
                col.ind = "black", 
                palette = "jco", 
                addEllipses = TRUE,
                label = "var",
                col.var = "black",
                repel = TRUE,
                mean.point.size = 3.5,
                legend.title = "GTDASSTRESS") +
  ggtitle("2D PCA-plot from 30 feature dataset") +
  theme(plot.title = element_text(hjust = 0.5))
fviz_pca_var(PlantSize3_OE_pr)
fviz_pca_var(PlantSize3_OE_pr, alpha.var="contrib") +
  theme_minimal()
fviz_pca_biplot(res.pca, label="var", habillage=iris$Species,
                addEllipses=TRUE, ellipse.level=0.95)

#With all data but only filtered data shown:
PlantSize3_pr <- PlantSize3
PlantSize3_pr <- PlantSize3_pr %>% filter(stress == "drought")
table(PlantSize3_pr$MeasurementDate_das)
PlantSize3_pr <- PlantSize3_pr %>% filter(MeasurementDate_das == 25)
PlantSize3_pr$imageEdgePercentage <- NULL
PlantSize3_pr$x.Position <- NULL
PlantSize3_pr$y.Position <- NULL
PlantSize3_pr$SeedGroupIDs <- NULL

PlantSize3_pr <- PlantSize3_pr %>% filter(ID.Measurement != 15063)
PlantSize3_pr <- PlantSize3_pr %>% filter(ID.Measurement != 16502)
PlantSize3_pr2 <- PlantSize3_pr
PlantSize3_pr$convexHullPerimeter_pixels <- NULL
PlantSize3_pr$plantConvexHullArea_pixels2 <- NULL
PlantSize3_pr$plantPerimeter_pixels <- NULL
PlantSize3_pr$projPlantSurfaceArea_pixels2 <- NULL


PlantSize3_pr <- prcomp(PlantSize3_pr[c(22:35)], center = TRUE, scale= TRUE)
#summary(PlantSize3_pr)
#PlantSize3_pr$x

plot(PlantSize3_pr$x[,1],PlantSize3_pr$x[,2], xlab="PC1 (54.9%)", ylab = "PC2 (18.7%)", main = "PC1 / PC2 - plot")
library("factoextra")

#PlantSize3 <- Filter(function(x)!all(is.na(x)), PlantSize3)
#PlantSize3_OE <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "OE")
#PlantSize3_Tissue <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "Tissue")
#PlantSize3_KO <- PlantSize3 %>% filter(PlantSize3$gene == "WT" | PlantSize3$gene == "KO")

fviz_pca_biplot(PlantSize3_pr, geom.ind = "point", pointshape = 21, 
                pointsize = 0, 
                fill.ind = PlantSize3_pr2$GT, 
                col.ind = "black", 
                palette = "jco", 
                addEllipses = TRUE,
                label = "var",
                col.var = "black",
                repel = TRUE,
                mean.point.size = 4,
                legend.title = "GTDASSTRESS") +
  ggtitle("2D PCA-plot from 30 feature dataset") +
  theme(plot.title = element_text(hjust = 0.5))


fviz_pca_var(PlantSize3_OE_pr)
fviz_pca_var(PlantSize3_OE_pr, alpha.var="contrib") +
  theme_minimal()
fviz_pca_biplot(res.pca, label="var", habillage=iris$Species,
                addEllipses=TRUE, ellipse.level=0.95)


#only tissue.
#only PLC OE included
PlantSize3_Tissue_pr <- PlantSize3_Tissue
PlantSize3_Tissue_pr <- PlantSize3_Tissue_pr %>% filter(stress == "drought")
table(PlantSize3_Tissue_pr$MeasurementDate_das)
#PlantSize3_Tissue_pr <- PlantSize3_Tissue_pr %>% filter(MeasurementDate_das == 25)
PlantSize3_Tissue_pr$imageEdgePercentage <- NULL
PlantSize3_Tissue_pr$x.Position <- NULL
PlantSize3_Tissue_pr$y.Position <- NULL
PlantSize3_Tissue_pr$SeedGroupIDs <- NULL

PlantSize3_Tissue_pr <- PlantSize3_Tissue_pr %>% filter(ID.Measurement != 15063)
PlantSize3_Tissue_pr <- PlantSize3_Tissue_pr %>% filter(ID.Measurement != 16502)
PlantSize3_Tissue_pr2 <- PlantSize3_Tissue_pr
PlantSize3_Tissue_pr$convexHullPerimeter_pixels <- NULL
PlantSize3_Tissue_pr$plantConvexHullArea_pixels2 <- NULL
PlantSize3_Tissue_pr$plantPerimeter_pixels <- NULL
PlantSize3_Tissue_pr$projPlantSurfaceArea_pixels2 <- NULL


PlantSize3_Tissue_pr <- prcomp(PlantSize3_Tissue_pr[c(22:35)], center = TRUE, scale= TRUE)
PlantSize3_Tissue_pr_PCA  <- PCA(PlantSize3_Tissue_pr[c(22:35)], scale.unit = TRUE, ncp= 5)
summary(PlantSize3_Tissue_pr)

PlantSize3_Tissue_pr$x

plot(PlantSize3_Tissue_pr$x[,1],PlantSize3_Tissue_pr$x[,2], xlab="PC1 (54.9%)", ylab = "PC2 (18.7%)", main = "PC1 / PC2 - plot")
library("factoextra")
fviz_pca_biplot(PlantSize3_Tissue_pr_PCA, geom.ind = "point", pointshape = 21, 
                pointsize = 0, 
                fill.ind = PlantSize3_Tissue_pr2$GT, 
                col.ind = "black", 
                palette = "Paired", 
                addEllipses = TRUE,
                label = "var",
                col.var = "black",
                repel = TRUE,
                mean.point.size = 4,
                legend.title = "GTDASSTRESS") +
  xlim(-15, 10)+
  ylim(-7,8)+
  ggtitle("2D PCA-plot from 30 feature dataset") +
  theme(plot.title = element_text(hjust = 0.5))
fviz_pca_var(PlantSize3_OE_pr)


fviz_pca_var(PlantSize3_OE_pr, alpha.var="contrib") +
  theme_minimal()
fviz_pca_biplot(res.pca, label="var", habillage=iris$Species,
                addEllipses=TRUE, ellipse.level=0.95)

###

PlantSize3_Tissue_pr_PCA  <- PCA(PlantSize3_Tissue_pr[c(22:35)], scale.unit = TRUE, ncp= 5)

df <- data.frame(PlantSize3_Tissue_pr_PCA$ind$coord[,1:2], GT = PlantSize3_Tissue_pr2$GT)
df <- df %>%
  group_by(GT) %>%
  summarize(PC1=mean(Dim.1), PC2=mean(Dim.2))

fviz_pca_ind(PlantSize3_Tissue_pr_PCA, geom.ind=c("point"), point.size=0.000001, pointshape=16,
             legend.title="GT", addlabel=TRUE) +
  geom_point(data=df, aes(x=PC1, y=PC2, color=GT), size=5)

fviz_pca_biplot(PlantSize3_Tissue_pr_PCA, geom.ind = "point", pointshape = 21, 
                pointsize = 0, 
                fill.ind = PlantSize3_Tissue_pr2$GT, 
                col.ind = "black", 
                palette = "Paired", 
                addEllipses = TRUE,
                label = "var",
                col.var = "black",
                repel = TRUE,
                legend.title = "GTDASSTRESS") +
  geom_point(data=df, aes(x=PC1, y=PC2, color=GT), size=5)+
  xlim(-5,5)+
  ylim(-5,5)+
  ggtitle("2D PCA-plot from 30 feature dataset") +
  theme(plot.title = element_text(hjust = 0.5))


fviz_pca_var(PlantSize3_Tissue_pr_PCA, geom.ind = "point", pointshape = 21, 
             pointsize = 0, 
             fill.ind = PlantSize3_Tissue_pr2$GT, 
             col.ind = "black", 
             palette = ColorTissue, 
             addEllipses = FALSE,
             label = "var",
             col.var = "black",
             repel = TRUE,
             legend.title = "GTDASSTRESS") +
  geom_point(data=df, aes(x=PC1, y=PC2, color=GT), size=5)+
  xlim(-1,1)+
  ylim(-1,1)+
  ggtitle("2D PCA-plot from 30 feature dataset") +
  theme_bw() + theme(panel.border = element_blank(), panel.grid.major = element_blank(),
                     panel.grid.minor = element_blank(), axis.line = element_line(colour = "black"),
                     legend.title = element_blank(),text = element_text(size = 18))


geom_point(data=df, aes(x=Dim1, y=Dim2, color=GT), size=5)+
  
  
  geom_point(data=df, aes(x=Dim1, y=Dim2, color=Species), size=5)





PlantSize3 %>% filter(PlantSize3$stress == "control") %>% table(PlantSize3$MeasurementDate_das)
indx <- apply(PlantSize3_OE_pr, 2, function(x) any(is.na(x) | is.infinite(x)))
colnames[indx]
indx
colnames(PlantSize3_OE_pr)
sapply(PlantSize3_OE_pr, class)
head(PlantSize3_OE_pr[c(22:39)])

screeplot(PlantSize3_OE_pr, type = "l", npcs = 15, main = "Screeplot of the first 10 PCs")
abline(h = 1, col="red", lty=5)
legend("topright", legend=c("Eigenvalue = 1"),
       col=c("red"), lty=5, cex=0.6)

cumpro <- cumsum(PlantSize3_OE_pr$sdev^2 / sum(PlantSize3_OE_pr$sdev^2))
plot(cumpro[0:15], xlab = "PC #", ylab = "Amount of explained variance", main = "Cumulative variance plot")
abline(v = 6, col="blue", lty=5)
abline(h = 0.88759, col="blue", lty=5)
legend("topleft", legend=c("Cut-off @ PC6"),
       col=c("blue"), lty=5, cex=0.6)

############################################################################################
#Which variables explain the differnce
############################################################################################


